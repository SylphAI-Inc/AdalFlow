
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>datasets.hotpot_qa &#8212; AdalFlow: The Library to Build and Auto-Optimize LLM Task Pipelines</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=af51538a" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/rtd_sphinx_search.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../../_static/js/rtd_search_config.js"></script>
    <script src="../../_static/js/rtd_sphinx_search.min.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_modules/datasets/hotpot_qa';</script>
    <link rel="icon" href="../../_static/LightRAG-logo-circle.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/adalflow-logo.png" class="logo__image only-light" alt="AdalFlow: The Library to Build and Auto-Optimize LLM Task Pipelines - Home"/>
    <script>document.write(`<img src="../../_static/adalflow-logo.png" class="logo__image only-dark" alt="AdalFlow: The Library to Build and Auto-Optimize LLM Task Pipelines - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../get_started/index.html">
    Get Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../integrations/index.html">
    Integrations
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../tutorials/index.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../use_cases/index.html">
    Use Cases
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../contributor/index.html">
    Contributor Guide
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../apis/index.html">
    API Reference
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/SylphAI-Inc/AdalFlow" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://discord.gg/ezzszrRZvT" title="Discord" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-discord fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Discord</span></a>
        </li>
</ul></div>
      
        <div class="navbar-item">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../get_started/index.html">
    Get Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../integrations/index.html">
    Integrations
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../tutorials/index.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../use_cases/index.html">
    Use Cases
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../contributor/index.html">
    Contributor Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../apis/index.html">
    API Reference
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/SylphAI-Inc/AdalFlow" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://discord.gg/ezzszrRZvT" title="Discord" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-discord fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Discord</span></a>
        </li>
</ul></div>
        
          <div class="navbar-item">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Module code</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">datasets.hotpot_qa</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <h1>Source code for datasets.hotpot_qa</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Literal</span><span class="p">,</span> <span class="n">List</span>

<span class="kn">from</span> <span class="nn">adalflow.utils.lazy_import</span> <span class="kn">import</span> <span class="n">safe_import</span><span class="p">,</span> <span class="n">OptionalPackages</span>


<span class="kn">from</span> <span class="nn">adalflow.utils.data</span> <span class="kn">import</span> <span class="n">Dataset</span>
<span class="kn">from</span> <span class="nn">adalflow.utils.file_io</span> <span class="kn">import</span> <span class="n">save_csv</span><span class="p">,</span> <span class="n">save_json</span><span class="p">,</span> <span class="n">load_json</span>
<span class="kn">from</span> <span class="nn">adalflow.datasets.utils</span> <span class="kn">import</span> <span class="n">prepare_dataset_path</span>
<span class="kn">from</span> <span class="nn">adalflow.core.base_data_class</span> <span class="kn">import</span> <span class="n">DataClass</span>
<span class="kn">from</span> <span class="nn">adalflow.datasets.types</span> <span class="kn">import</span> <span class="n">HotPotQAData</span>


<div class="viewcode-block" id="HotPotQA">
<a class="viewcode-back" href="../../apis/datasets/index.html#datasets.hotpot_qa.HotPotQA">[docs]</a>
<span class="k">class</span> <span class="nc">HotPotQA</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">only_hard_examples</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">root</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">split</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="s2">&quot;val&quot;</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;train&quot;</span><span class="p">,</span>
        <span class="n">keep_details</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="s2">&quot;dev_titles&quot;</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;dev_titles&quot;</span><span class="p">,</span>
        <span class="n">size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        official_train: 15661</span>
<span class="sd">        sampled_trainset: 11745</span>
<span class="sd">        sampled_valset: 3916</span>
<span class="sd">        test: 7405</span>

<span class="sd">        All answers are a phrase in the supporting context where we can choose supporting facts from the context.</span>

<span class="sd">        You can specify the size of the dataset to load by setting the size parameter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">split</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="s2">&quot;val&quot;</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Split must be one of &#39;train&#39;, &#39;val&#39;, &#39;test&#39;&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">keep_details</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="s2">&quot;dev_titles&quot;</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Keep details must be one of &#39;all&#39;, &#39;dev_titles&#39;, &#39;none&#39;&quot;</span><span class="p">)</span>

        <span class="c1"># if root is None:</span>
        <span class="c1">#     root = get_adalflow_default_root_path()</span>
        <span class="c1">#     print(f&quot;Saving dataset to {root}&quot;)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">root</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">task_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;hotpot_qa_</span><span class="si">{</span><span class="n">keep_details</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">data_path</span> <span class="o">=</span> <span class="n">prepare_dataset_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_name</span><span class="p">)</span>
        <span class="c1"># download and save</span>
        <span class="n">split_csv_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">split</span><span class="si">}</span><span class="s2">.json&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;split_csv_path: </span><span class="si">{</span><span class="n">split_csv_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_or_download_dataset</span><span class="p">(</span>
            <span class="n">split_csv_path</span><span class="p">,</span> <span class="n">split</span><span class="p">,</span> <span class="n">only_hard_examples</span><span class="p">,</span> <span class="n">keep_details</span>
        <span class="p">)</span>

        <span class="c1"># load from csv</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># created_data_class = DynamicDataClassFactory.from_dict(</span>
        <span class="c1">#  &quot;HotPotQAData&quot;, {&quot;id&quot;: &quot;str&quot;, &quot;question&quot;: &quot;str&quot;, &quot;answer&quot;: &quot;str&quot;}</span>

        <span class="c1"># with open(split_csv_path, newline=&quot;&quot;) as csvfile:</span>
        <span class="c1">#     reader = csv.DictReader(csvfile)</span>
        <span class="c1">#     for i, row in enumerate(reader):</span>
        <span class="c1">#         if size is not None and i &gt;= size:</span>
        <span class="c1">#             break</span>
        <span class="c1">#         self.data.append(HotPotQAData.from_dict(row))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">load_json</span><span class="p">(</span><span class="n">split_csv_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># use random seed to make sure the same data is loaded</span>
            <span class="c1"># random.Random(0).shuffle(self.data)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[:</span><span class="n">size</span><span class="p">]</span>
        <span class="c1"># convert to dataclass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">HotPotQAData</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_check_or_download_dataset</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">split</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;train&quot;</span><span class="p">,</span>
        <span class="n">only_hard_examples</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">keep_details</span><span class="o">=</span><span class="s2">&quot;dev_titles&quot;</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;It will download data from huggingface datasets and split it and save it into three csv files.</span>
<span class="sd">        Args:</span>
<span class="sd">            data_path (str): The path to save the data. In particular with split name appended.</span>
<span class="sd">            split (str): The dataset split, supports ``&quot;train&quot;`` (default), ``&quot;val&quot;`` and ``&quot;test&quot;``. Decides which split to return.</span>
<span class="sd">            only_hard_examples (bool): If True, only hard examples will be downloaded.</span>
<span class="sd">            keep_details (str): If &quot;all&quot;, all details will be kept. If &quot;dev_titles&quot;, only dev titles will be kept.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">data_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;data_path must be specified&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">data_path</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="n">safe_import</span><span class="p">(</span>
            <span class="n">OptionalPackages</span><span class="o">.</span><span class="n">DATASETS</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">OptionalPackages</span><span class="o">.</span><span class="n">DATASETS</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>

        <span class="k">assert</span> <span class="n">only_hard_examples</span><span class="p">,</span> <span class="p">(</span>
            <span class="s2">&quot;Care must be taken when adding support for easy examples.&quot;</span>
            <span class="s2">&quot;Dev must be all hard to match official dev, but training can be flexible.&quot;</span>
        <span class="p">)</span>

        <span class="n">hf_official_train</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span>
            <span class="s2">&quot;hotpot_qa&quot;</span><span class="p">,</span> <span class="s2">&quot;fullwiki&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="n">trust_remote_code</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="n">hf_official_dev</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span>
            <span class="s2">&quot;hotpot_qa&quot;</span><span class="p">,</span> <span class="s2">&quot;fullwiki&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;validation&quot;</span><span class="p">,</span> <span class="n">trust_remote_code</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="n">data_path_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">data_path</span><span class="p">)</span>
        <span class="c1"># save all the original data</span>
        <span class="n">all_original_keys</span> <span class="o">=</span> <span class="n">hf_official_train</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">split</span><span class="p">,</span> <span class="n">examples</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;hf_official_train&quot;</span><span class="p">,</span> <span class="s2">&quot;hf_official_dev&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="n">hf_official_train</span><span class="p">,</span> <span class="n">hf_official_dev</span><span class="p">],</span>
        <span class="p">):</span>
            <span class="n">target_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">split</span><span class="si">}</span><span class="s2">.csv&quot;</span><span class="p">)</span>
            <span class="n">save_csv</span><span class="p">(</span><span class="n">examples</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">target_path</span><span class="p">,</span> <span class="n">fieldnames</span><span class="o">=</span><span class="n">all_original_keys</span><span class="p">)</span>
            <span class="c1"># for example in examples:</span>
            <span class="c1">#     # is answer in the context</span>
            <span class="c1">#     print(f&quot;example: {example}&quot;)</span>
            <span class="c1">#     context = str(json.dumps(example[&quot;context&quot;]))</span>
            <span class="c1">#     if example[&quot;answer&quot;] in context:</span>
            <span class="c1">#         print(f&quot;answer in context&quot;)</span>
            <span class="c1">#     else:</span>
            <span class="c1">#         print(f&quot;answer not in context&quot;)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;saved </span><span class="si">{</span><span class="n">split</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">target_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;question&quot;</span><span class="p">,</span> <span class="s2">&quot;answer&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">keep_details</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
            <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;id&quot;</span><span class="p">,</span>
                <span class="s2">&quot;question&quot;</span><span class="p">,</span>
                <span class="s2">&quot;answer&quot;</span><span class="p">,</span>
                <span class="s2">&quot;type&quot;</span><span class="p">,</span>
                <span class="s2">&quot;supporting_facts&quot;</span><span class="p">,</span>
                <span class="s2">&quot;context&quot;</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="k">elif</span> <span class="n">keep_details</span> <span class="o">==</span> <span class="s2">&quot;dev_titles&quot;</span><span class="p">:</span>
            <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;question&quot;</span><span class="p">,</span> <span class="s2">&quot;answer&quot;</span><span class="p">,</span> <span class="s2">&quot;supporting_facts&quot;</span><span class="p">,</span> <span class="s2">&quot;context&quot;</span><span class="p">]</span>

        <span class="n">official_train</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># 15661</span>
        <span class="k">for</span> <span class="n">raw_example</span> <span class="ow">in</span> <span class="n">hf_official_train</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">raw_example</span><span class="p">[</span><span class="s2">&quot;level&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;hard&quot;</span><span class="p">:</span>
                <span class="n">example</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">raw_example</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">}</span>

                <span class="k">if</span> <span class="s2">&quot;supporting_facts&quot;</span> <span class="ow">in</span> <span class="n">example</span><span class="p">:</span>
                    <span class="n">example</span><span class="p">[</span><span class="s2">&quot;gold_titles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">example</span><span class="p">[</span><span class="s2">&quot;supporting_facts&quot;</span><span class="p">][</span><span class="s2">&quot;title&quot;</span><span class="p">])</span>
                    <span class="c1"># del example[&quot;supporting_facts&quot;]</span>

                <span class="n">official_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">example</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;official_train: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">official_train</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">rng</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">Random</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">rng</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">official_train</span><span class="p">)</span>

        <span class="n">sampled_trainset</span> <span class="o">=</span> <span class="n">official_train</span><span class="p">[:</span> <span class="nb">len</span><span class="p">(</span><span class="n">official_train</span><span class="p">)</span> <span class="o">*</span> <span class="mi">70</span> <span class="o">//</span> <span class="mi">100</span><span class="p">]</span>  <span class="c1"># 11745</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sampled_trainset: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">sampled_trainset</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">sampled_valset</span> <span class="o">=</span> <span class="n">official_train</span><span class="p">[</span>  <span class="c1"># 3916</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">official_train</span><span class="p">)</span> <span class="o">*</span> <span class="mi">70</span> <span class="o">//</span> <span class="mi">100</span> <span class="p">:</span>
        <span class="p">]</span>  <span class="c1"># this is not the official dev set</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sampled_valset: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">sampled_valset</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># for example in self._train:</span>
        <span class="c1">#     if keep_details == &quot;dev_titles&quot;:</span>
        <span class="c1">#         del example[&quot;gold_titles&quot;]</span>

        <span class="n">test</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># 7405</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;raw_example: </span><span class="si">{</span><span class="n">hf_official_dev</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">raw_example</span> <span class="ow">in</span> <span class="n">hf_official_dev</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">raw_example</span><span class="p">[</span><span class="s2">&quot;level&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;hard&quot;</span>
            <span class="n">example</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">k</span><span class="p">:</span> <span class="n">raw_example</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;question&quot;</span><span class="p">,</span> <span class="s2">&quot;answer&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;supporting_facts&quot;</span><span class="p">]</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="s2">&quot;supporting_facts&quot;</span> <span class="ow">in</span> <span class="n">example</span><span class="p">:</span>
                <span class="n">example</span><span class="p">[</span><span class="s2">&quot;gold_titles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">example</span><span class="p">[</span><span class="s2">&quot;supporting_facts&quot;</span><span class="p">][</span><span class="s2">&quot;title&quot;</span><span class="p">])</span>

                <span class="c1"># del example[&quot;supporting_facts&quot;]</span>
            <span class="n">test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">example</span><span class="p">)</span>

        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;question&quot;</span><span class="p">,</span> <span class="s2">&quot;answer&quot;</span><span class="p">,</span> <span class="s2">&quot;gold_titles&quot;</span><span class="p">,</span> <span class="s2">&quot;context&quot;</span><span class="p">]</span>

        <span class="c1"># split test into val and test</span>
        <span class="c1"># random shuff the test</span>
        <span class="n">rng</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
        <span class="n">test_split</span> <span class="o">=</span> <span class="n">test</span><span class="p">[:</span> <span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">)</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">//</span> <span class="mi">100</span><span class="p">]</span>  <span class="c1"># 3702</span>
        <span class="n">val_split</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">)</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">//</span> <span class="mi">100</span> <span class="p">:]</span>  <span class="c1"># 3703</span>

        <span class="c1"># save to csv</span>
        <span class="k">for</span> <span class="n">split</span><span class="p">,</span> <span class="n">examples</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="s2">&quot;val&quot;</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="n">sampled_trainset</span><span class="p">,</span> <span class="n">val_split</span><span class="p">,</span> <span class="n">test_split</span><span class="p">],</span>
        <span class="p">):</span>
            <span class="c1"># target_path = prepare_dataset_path(self.root, task_name, split)</span>
            <span class="n">target_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">split</span><span class="si">}</span><span class="s2">.json&quot;</span><span class="p">)</span>
            <span class="c1"># filter the examples with only the keys</span>
            <span class="n">save_examples</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">HotPotQAData</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">example</span> <span class="ow">in</span> <span class="n">examples</span><span class="p">:</span>
                <span class="n">save_example</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">example</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">example</span><span class="p">}</span>
                <span class="n">save_example</span> <span class="o">=</span> <span class="n">HotPotQAData</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">save_example</span><span class="p">)</span>
                <span class="n">save_examples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">save_example</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
            <span class="n">save_json</span><span class="p">(</span><span class="n">save_examples</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">target_path</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">split</span> <span class="o">==</span> <span class="s2">&quot;train&quot;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;train example: </span><span class="si">{</span><span class="n">examples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;saved </span><span class="si">{</span><span class="n">split</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">target_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">split</span> <span class="o">==</span> <span class="s2">&quot;train&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">sampled_trainset</span>
        <span class="k">elif</span> <span class="n">split</span> <span class="o">==</span> <span class="s2">&quot;val&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">sampled_valset</span>
        <span class="k">elif</span> <span class="n">split</span> <span class="o">==</span> <span class="s2">&quot;test&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">test</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Split must be one of &#39;train&#39;, &#39;val&#39;, &#39;test&#39;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataClass</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span></div>



<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">HotPotQA</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">type</span><span class="p">(</span><span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">))</span>
    <span class="n">valdataset</span> <span class="o">=</span> <span class="n">HotPotQA</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="s2">&quot;val&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">valdataset</span><span class="p">))</span>
    <span class="n">testdataset</span> <span class="o">=</span> <span class="n">HotPotQA</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">testdataset</span><span class="p">))</span>

    <span class="c1"># example = {</span>
    <span class="c1">#     &quot;id&quot;: &quot;5a8b57f25542995d1e6f1371&quot;,</span>
    <span class="c1">#     &quot;question&quot;: &quot;Were Scott Derrickson and Ed Wood of the same nationality?&quot;,</span>
    <span class="c1">#     &quot;answer&quot;: &quot;yes&quot;,</span>
    <span class="c1">#     &quot;type&quot;: &quot;comparison&quot;,</span>
    <span class="c1">#     &quot;level&quot;: &quot;hard&quot;,</span>
    <span class="c1">#     &quot;supporting_facts&quot;: {</span>
    <span class="c1">#         &quot;title&quot;: [&quot;Scott Derrickson&quot;, &quot;Ed Wood&quot;],</span>
    <span class="c1">#         &quot;sent_id&quot;: [0, 0],</span>
    <span class="c1">#     },</span>
    <span class="c1">#     &quot;context&quot;: {</span>
    <span class="c1">#         &quot;title&quot;: [</span>
    <span class="c1">#             &quot;Adam Collis&quot;,</span>
    <span class="c1">#             &quot;Ed Wood (film)&quot;,</span>
    <span class="c1">#             &quot;Tyler Bates&quot;,</span>
    <span class="c1">#             &quot;Doctor Strange (2016 film)&quot;,</span>
    <span class="c1">#             &quot;Hellraiser: Inferno&quot;,</span>
    <span class="c1">#             &quot;Sinister (film)&quot;,</span>
    <span class="c1">#             &quot;Deliver Us from Evil (2014 film)&quot;,</span>
    <span class="c1">#             &quot;Woodson, Arkansas&quot;,</span>
    <span class="c1">#             &quot;Conrad Brooks&quot;,</span>
    <span class="c1">#             &quot;The Exorcism of Emily Rose&quot;,</span>
    <span class="c1">#         ],</span>
    <span class="c1">#         &quot;sentences&quot;: [</span>
    <span class="c1">#             [</span>
    <span class="c1">#                 &quot;Adam Collis is an American filmmaker and actor.&quot;,</span>
    <span class="c1">#                 &quot; He attended the Duke University from 1986 to 1990 and the University of California, Los Angeles from 2007 to 2010.&quot;,</span>
    <span class="c1">#                 &quot; He also studied cinema at the University of Southern California from 1991 to 1997.&quot;,</span>
    <span class="c1">#                 &#39; Collis first work was the assistant director for the Scott Derrickson\&#39;s short &quot;Love in the Ruins&quot; (1995).&#39;,</span>
    <span class="c1">#                 &#39; In 1998, he played &quot;Crankshaft&quot; in Eric Koyanagi\&#39;s &quot;Hundred Percent&quot;.&#39;,</span>
    <span class="c1">#             ],</span>
    <span class="c1">#             [</span>
    <span class="c1">#                 &quot;Ed Wood is a 1994 American biographical period comedy-drama film directed and produced by Tim Burton, and starring Johnny Depp as cult filmmaker Ed Wood.&quot;,</span>
    <span class="c1">#                 &quot; The film concerns the period in Wood&#39;s life when he made his best-known films as well as his relationship with actor Bela Lugosi, played by Martin Landau.&quot;,</span>
    <span class="c1">#                 &quot; Sarah Jessica Parker, Patricia Arquette, Jeffrey Jones, Lisa Marie, and Bill Murray are among the supporting cast.&quot;,</span>
    <span class="c1">#             ],</span>
    <span class="c1">#             [</span>
    <span class="c1">#                 &quot;Tyler Bates (born June 5, 1965) is an American musician, music producer, and composer for films, television, and video games.&quot;,</span>
    <span class="c1">#                 &#39; Much of his work is in the action and horror film genres, with films like &quot;Dawn of the Dead, 300, Sucker Punch,&quot; and &quot;John Wick.&quot;&#39;,</span>
    <span class="c1">#                 &quot; He has collaborated with directors like Zack Snyder, Rob Zombie, Neil Marshall, William Friedkin, Scott Derrickson, and James Gunn.&quot;,</span>
    <span class="c1">#                 &#39; With Gunn, he has scored every one of the director\&#39;s films; including &quot;Guardians of the Galaxy&quot;, which became one of the highest grossing domestic movies of 2014, and its 2017 sequel.&#39;,</span>
    <span class="c1">#                 &#39; In addition, he is also the lead guitarist of the American rock band Marilyn Manson, and produced its albums &quot;The Pale Emperor&quot; and &quot;Heaven Upside Down&quot;.&#39;,</span>
    <span class="c1">#             ],</span>
    <span class="c1">#             [</span>
    <span class="c1">#                 &quot;Doctor Strange is a 2016 American superhero film based on the Marvel Comics character of the same name, produced by Marvel Studios and distributed by Walt Disney Studios Motion Pictures.&quot;,</span>
    <span class="c1">#                 &quot; It is the fourteenth film of the Marvel Cinematic Universe (MCU).&quot;,</span>
    <span class="c1">#                 &quot; The film was directed by Scott Derrickson, who wrote it with Jon Spaihts and C. Robert Cargill, and stars Benedict Cumberbatch as Stephen Strange, along with Chiwetel Ejiofor, Rachel McAdams, Benedict Wong, Michael Stuhlbarg, Benjamin Bratt, Scott Adkins, Mads Mikkelsen, and Tilda Swinton.&quot;,</span>
    <span class="c1">#                 &#39; In &quot;Doctor Strange&quot;, surgeon Strange learns the mystic arts after a career-ending car accident.&#39;,</span>
    <span class="c1">#             ],</span>
    <span class="c1">#             [</span>
    <span class="c1">#                 &quot;Hellraiser: Inferno (also known as Hellraiser V: Inferno) is a 2000 American horror film.&quot;,</span>
    <span class="c1">#                 &#39; It is the fifth installment in the &quot;Hellraiser&quot; series and the first &quot;Hellraiser&quot; film to go straight-to-DVD.&#39;,</span>
    <span class="c1">#                 &quot; It was directed by Scott Derrickson and released on October 3, 2000.&quot;,</span>
    <span class="c1">#                 &quot; The film concerns a corrupt detective who discovers Lemarchand&#39;s box at a crime scene.&quot;,</span>
    <span class="c1">#                 &quot; The film&#39;s reviews were mixed.&quot;,</span>
    <span class="c1">#             ],</span>
    <span class="c1">#             [</span>
    <span class="c1">#                 &quot;Sinister is a 2012 supernatural horror film directed by Scott Derrickson and written by Derrickson and C. Robert Cargill.&quot;,</span>
    <span class="c1">#                 &quot; It stars Ethan Hawke as fictional true-crime writer Ellison Oswalt who discovers a box of home movies in his attic that puts his family in danger.&quot;,</span>
    <span class="c1">#             ],</span>
    <span class="c1">#             [</span>
    <span class="c1">#                 &quot;Deliver Us from Evil is a 2014 American supernatural horror film directed by Scott Derrickson and produced by Jerry Bruckheimer.&quot;,</span>
    <span class="c1">#                 &#39; The film is officially based on a 2001 non-fiction book entitled &quot;Beware the Night&quot; by Ralph Sarchie and Lisa Collier Cool, and its marketing campaign highlighted that it was &quot;inspired by actual accounts&quot;.&#39;,</span>
    <span class="c1">#                 &quot; The film stars Eric Bana, dgar Ramrez, Sean Harris, Olivia Munn, and Joel McHale in the main roles and was released on July 2, 2014.&quot;,</span>
    <span class="c1">#             ],</span>
    <span class="c1">#             [</span>
    <span class="c1">#                 &quot;Woodson is a census-designated place (CDP) in Pulaski County, Arkansas, in the United States.&quot;,</span>
    <span class="c1">#                 &quot; Its population was 403 at the 2010 census.&quot;,</span>
    <span class="c1">#                 &quot; It is part of the Little RockNorth Little RockConway Metropolitan Statistical Area.&quot;,</span>
    <span class="c1">#                 &quot; Woodson and its accompanying Woodson Lake and Wood Hollow are the namesake for Ed Wood Sr., a prominent plantation owner, trader, and businessman at the turn of the 20th century.&quot;,</span>
    <span class="c1">#                 &quot; Woodson is adjacent to the Wood Plantation, the largest of the plantations own by Ed Wood Sr.&quot;,</span>
    <span class="c1">#             ],</span>
    <span class="c1">#             [</span>
    <span class="c1">#                 &quot;Conrad Brooks (born Conrad Biedrzycki on January 3, 1931 in Baltimore, Maryland) is an American actor.&quot;,</span>
    <span class="c1">#                 &quot; He moved to Hollywood, California in 1948 to pursue a career in acting.&quot;,</span>
    <span class="c1">#                 &#39; He got his start in movies appearing in Ed Wood films such as &quot;Plan 9 from Outer Space&quot;, &quot;Glen or Glenda&quot;, and &quot;Jail Bait.&quot;&#39;,</span>
    <span class="c1">#                 &quot; He took a break from acting during the 1960s and 1970s but due to the ongoing interest in the films of Ed Wood, he reemerged in the 1980s and has become a prolific actor.&quot;,</span>
    <span class="c1">#                 &quot; He also has since gone on to write, produce and direct several films.&quot;,</span>
    <span class="c1">#             ],</span>
    <span class="c1">#             [</span>
    <span class="c1">#                 &quot;The Exorcism of Emily Rose is a 2005 American legal drama horror film directed by Scott Derrickson and starring Laura Linney and Tom Wilkinson.&quot;,</span>
    <span class="c1">#                 &quot; The film is loosely based on the story of Anneliese Michel and follows a self-proclaimed agnostic who acts as defense counsel (Linney) representing a parish priest (Wilkinson), accused by the state of negligent homicide after he performed an exorcism.&quot;,</span>
    <span class="c1">#             ],</span>
    <span class="c1">#         ],</span>
    <span class="c1">#     },</span>
    <span class="c1"># }</span>

    <span class="c1"># # save to csv</span>
    <span class="c1"># keys = [&quot;id&quot;, &quot;question&quot;, &quot;answer&quot;, &quot;gold_titles&quot;, &quot;context&quot;]</span>
    <span class="c1"># example[&quot;gold_titles&quot;] = set(example[&quot;supporting_facts&quot;][&quot;title&quot;])</span>

    <span class="c1"># # test, save to hotpotQA</span>

    <span class="c1"># data = HotPotQAData.from_dict({k: example[k] for k in keys})</span>
    <span class="c1"># print(f&quot;data: {data}&quot;)</span>

    <span class="c1"># # save to json</span>
    <span class="c1"># save_json([data.to_dict()], f=&quot;test.json&quot;)</span>

    <span class="c1"># # load from json</span>
    <span class="c1"># loaded_data = load_json(&quot;test.json&quot;)</span>
    <span class="c1"># # convert to dataclass</span>
    <span class="c1"># data = HotPotQAData.from_dict(loaded_data[0])</span>
    <span class="c1"># print(f&quot;data: {data}&quot;)</span>
</pre></div>

                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
       Copyright 2024, SylphAI, Inc.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>