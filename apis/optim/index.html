<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="parameter" href="optim.parameter.html" /><link rel="prev" title="g_eval" href="../eval/eval.g_eval.html" />

    <link rel="shortcut icon" href="../../_static/LightRAG-logo-circle.png"/><!-- Generated with Sphinx 7.4.7 and Furo 2024.08.06 -->
        <title>Optimization - Build and Optimize LM Workflows</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=f0068426" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/rtd_sphinx_search.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: #FF6F00;
  --color-brand-content: #1E2A38;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #FF8F00;
  --color-brand-content: #CFD8DC;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #FF8F00;
  --color-brand-content: #CFD8DC;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Build and Optimize LM Workflows</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../_static/images/AdalFlow.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../_static/images/AdalFlow_black_bg.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Build and Optimize LM Workflows</span>
  
</a><div class="sidebar-github-section">
    <a href="https://github.com/SylphAI-Inc/AdalFlow" class="sidebar-github-link">
        <i class="fa-brands fa-github"></i>
        <span class="github-text">GitHub</span>
    </a>
</div><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Getting Started</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../new_tutorials/index.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../new_tutorials/core_concepts.html">Core Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../new_tutorials/generator.html">Generator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../new_tutorials/embedder.html">Embedder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/retriever.html">retriever</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../new_tutorials/tool.html">Tool Use</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../new_tutorials/agents_runner.html">Agent Runner</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../new_tutorials/streaming.html">Streaming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../new_tutorials/tracing.html">Tracing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../new_tutorials/human_in_the_loop.html">Human in the Loop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../new_tutorials/prompt.html">Prompt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../new_tutorials/parser.html">Parser and Structured Output</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../integrations/index.html">Integrations</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Integrations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../integrations/integrations.html">All Providers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../integrations/anthropic.html">Anthropic Integration</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../use_cases/index.html">Use Cases</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Use Cases</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../use_cases/question_answering.html">Question Answering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../use_cases/qa_computation_graph.html">Q&amp;A Computation Graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../use_cases/qa_text_grad_trace_graph.html">Q&amp;A Text Grad Trace Graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../use_cases/qa_demo_trace_graph.html">Q&amp;A Few Shot Demo Trace Graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../use_cases/classification.html">Classification Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../use_cases/rag_opt.html">RAG optimization</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../contributor/index.html">Contributor Guide</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Contributor Guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../contributor/contribution.html">Contributing Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributor/contribute_to_code.html">Development Essentials</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tutorials/index.html">Developer Notes</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Developer Notes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/lightrag_design_philosophy.html">Design Philosophy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/class_hierarchy.html">Class Hierarchy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/trace_graph.html">AdalFlow Trace Graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/component.html">Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/base_data_class.html">DataClass</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/prompt.html">Prompt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/model_client.html">ModelClient</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/generator.html">Generator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/generator.html#basic-generator-tutorial">Basic Generator Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/output_parsers.html">Parser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/embedder.html">Embedder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/retriever.html">Retriever</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/text_splitter.html">Text Splitter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/db.html">Data (Database/Pipeline)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/rag_playbook.html">RAG Playbook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/rag_with_memory.html">RAG with Memory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/tool_helper.html">Function calls</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/agent.html">ReAct Agent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../new_tutorials/agents_runner.html">Agents and Runner</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../new_tutorials/streaming.html">Streaming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../new_tutorials/tracing.html">Tracing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../new_tutorials/human_in_the_loop.html">Human in the Loop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/evaluation.html">LLM Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/datasets.html">Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/logging.html">Logger Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/logging.html#design">Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/logging.html#use-logger-in-projects">Use Logger in Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/logging_tracing.html">Tracing</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../design/index.html">Blog</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Blog</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../design/ComponentTool.html">Use Class method as a better function tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../design/FunctionTool.html">Designing of AdalFlow FunctionTool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../design/agent-streaming.html">Agent Streaming Architecture in OpenAI Agents SDK</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">API Reference</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../core/index.html">Core</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Core</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../core/core.base_data_class.html">base_data_class</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/core.component.html">component</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/core.container.html">container</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/core.default_prompt_template.html">default_prompt_template</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/core.embedder.html">embedder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/core.generator.html">generator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/core.model_client.html">model_client</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/core.prompt_builder.html">prompt_builder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/core.retriever.html">retriever</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/core.string_parser.html">string_parser</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/core.func_tool.html">func_tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/core.mcp_tool.html">mcp_tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/core.tool_manager.html">tool_manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/core.types.html">types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/core.db.html">db</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/core.functional.html">functional</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/core.tokenizer.html">tokenizer</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../components/index.html">Components</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Components</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../components/components.model_client.html">model_client</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of model_client</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../components/components.model_client.anthropic_client.html">anthropic_client</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/components.model_client.azureai_client.html">azureai_client</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/components.model_client.bedrock_client.html">bedrock_client</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/components.model_client.chat_completion_to_response_converter.html">chat_completion_to_response_converter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/components.model_client.cohere_client.html">cohere_client</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/components.model_client.deepseek_client.html">deepseek_client</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/components.model_client.fireworks_client.html">fireworks_client</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/components.model_client.google_client.html">google_client</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/components.model_client.groq_client.html">groq_client</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/components.model_client.mistral_client.html">mistral_client</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/components.model_client.ollama_client.html">ollama_client</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/components.model_client.openai_client.html">openai_client</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/components.model_client.sambanova_client.html">sambanova_client</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/components.model_client.together_client.html">together_client</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/components.model_client.transformers_client.html">transformers_client</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/components.model_client.utils.html">utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/components.model_client.xai_client.html">xai_client</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../components/components.retriever.html">retriever</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of retriever</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../components/components.retriever.bm25_retriever.html">bm25_retriever</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/components.retriever.faiss_retriever.html">faiss_retriever</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/components.retriever.lancedb_retriver.html">lancedb_retriver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/components.retriever.llm_retriever.html">llm_retriever</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/components.retriever.postgres_retriever.html">postgres_retriever</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/components.retriever.qdrant_retriever.html">qdrant_retriever</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/components.retriever.reranker_retriever.html">reranker_retriever</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../components/components.output_parsers.html">output_parsers</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of output_parsers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../components/components.output_parsers.dataclass_parser.html">dataclass_parser</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/components.output_parsers.outputs.html">outputs</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../components/components.agent.html">agent</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of agent</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../components/components.agent.agent.html">agent</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/components.agent.prompts.html">prompts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/components.agent.react.html">react</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/components.agent.runner.html">runner</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../components/components.data_process.html">data_process</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of data_process</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../components/components.data_process.data_components.html">data_components</a></li>
<li class="toctree-l4"><a class="reference internal" href="../components/components.data_process.text_splitter.html">text_splitter</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../components/components.memory.html">memory</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of memory</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../components/components.memory.memory.html">memory</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../datasets/index.html">Datasets</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of Datasets</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../datasets/datasets.big_bench_hard.html">big_bench_hard</a></li>
<li class="toctree-l3"><a class="reference internal" href="../datasets/datasets.trec.html">trec</a></li>
<li class="toctree-l3"><a class="reference internal" href="../datasets/datasets.hotpot_qa.html">hotpot_qa</a></li>
<li class="toctree-l3"><a class="reference internal" href="../datasets/datasets.types.html">types</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../eval/index.html">Evaluation</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of Evaluation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../eval/eval.base.html">base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../eval/eval.answer_match_acc.html">answer_match_acc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../eval/eval.retriever_recall.html">retriever_recall</a></li>
<li class="toctree-l3"><a class="reference internal" href="../eval/eval.llm_as_judge.html">llm_as_judge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../eval/eval.g_eval.html">g_eval</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children current-page"><a class="current reference internal" href="#">Optimization</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of Optimization</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="optim.parameter.html">parameter</a></li>
<li class="toctree-l3"><a class="reference internal" href="optim.optimizer.html">optimizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="optim.grad_component.html">grad_component</a></li>
<li class="toctree-l3"><a class="reference internal" href="optim.loss_component.html">loss_component</a></li>
<li class="toctree-l3"><a class="reference internal" href="optim.types.html">types</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="optim.few_shot.html">few_shot</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of few_shot</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="optim.few_shot.bootstrap_optimizer.html">bootstrap_optimizer</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="optim.text_grad.html">text_grad</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of text_grad</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="optim.text_grad.backend_engine_prompt.html">backend_engine_prompt</a></li>
<li class="toctree-l4"><a class="reference internal" href="optim.text_grad.llm_text_loss.html">llm_text_loss</a></li>
<li class="toctree-l4"><a class="reference internal" href="optim.text_grad.ops.html">ops</a></li>
<li class="toctree-l4"><a class="reference internal" href="optim.text_grad.text_loss_with_eval_fn.html">text_loss_with_eval_fn</a></li>
<li class="toctree-l4"><a class="reference internal" href="optim.text_grad.tgd_optimizer.html">tgd_optimizer</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="optim.trainer.html">trainer</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of trainer</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="optim.trainer.adal.html">adal</a></li>
<li class="toctree-l4"><a class="reference internal" href="optim.trainer.trainer.html">trainer</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../tracing/index.html">Tracing</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of Tracing</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../tracing/tracing.callback_manager.html">callback_manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tracing/tracing.create.html">create</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tracing/tracing.decorators.html">decorators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tracing/tracing.generator_call_logger.html">generator_call_logger</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tracing/tracing.generator_state_logger.html">generator_state_logger</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tracing/tracing.mlflow_integration.html">mlflow_integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tracing/tracing.processor_interface.html">processor_interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tracing/tracing.scope.html">scope</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tracing/tracing.setup.html">setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tracing/tracing.span_data.html">span_data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tracing/tracing.spans.html">spans</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tracing/tracing.traces.html">traces</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tracing/tracing.util.html">util</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../utils/index.html">Utils</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of Utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../utils/utils.data.html">data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/utils.setup_env.html">setup_env</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/utils.logger.html">logger</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/utils.file_io.html">file_io</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/utils.config.html">config</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/utils.lazy_import.html">lazy_import</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/utils.registry.html">registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/utils.serialization.html">serialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utils/utils.cache.html">cache</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          

<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="optimization">
<span id="apis-optim"></span><h1>Optimization<a class="headerlink" href="#optimization" title="Link to this heading">¶</a></h1>
<section id="base-classes-and-data-structures">
<h2>Base Classes and Data Structures<a class="headerlink" href="#base-classes-and-data-structures" title="Link to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">GradComponent</span></code> and <code class="docutils literal notranslate"><span class="pre">LossComponent</span></code> are a subclass from <code class="docutils literal notranslate"><span class="pre">Component</span></code> to serve the purpose to differentiate the gradient and loss components in the optimization process.
And it will be used if users want to implement their own with more customization.</p>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="optim.parameter.html#module-optim.parameter" title="optim.parameter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optim.parameter</span></code></a></p></td>
<td><p>Parameter is used by Optimizer, Trainers, AdalComponent to auto-optimizations</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="optim.optimizer.html#module-optim.optimizer" title="optim.optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optim.optimizer</span></code></a></p></td>
<td><p>Base Classes for AdalFlow Optimizers, including Optimizer, TextOptimizer, and DemoOptimizer.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="optim.grad_component.html#module-optim.grad_component" title="optim.grad_component"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optim.grad_component</span></code></a></p></td>
<td><p>Base class for Autograd Components that can be called and backpropagated through.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="optim.loss_component.html#module-optim.loss_component" title="optim.loss_component"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optim.loss_component</span></code></a></p></td>
<td><p>Base class for Autograd Components that can be called and backpropagated through.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="optim.types.html#module-optim.types" title="optim.types"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optim.types</span></code></a></p></td>
<td><p>All data types used by Parameter, Optimizer, AdalComponent, and Trainer.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="toctree-wrapper compound">
</div>
</section>
<section id="few-shot-optimizer">
<h2>Few Shot Optimizer<a class="headerlink" href="#few-shot-optimizer" title="Link to this heading">¶</a></h2>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="optim.few_shot.bootstrap_optimizer.html#module-optim.few_shot.bootstrap_optimizer" title="optim.few_shot.bootstrap_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optim.few_shot.bootstrap_optimizer</span></code></a></p></td>
<td><p>Adapted and optimized boostrap fewshot optimizer:</p></td>
</tr>
</tbody>
</table>
</div>
<div class="toctree-wrapper compound">
</div>
</section>
<section id="textual-gradient">
<h2>Textual Gradient<a class="headerlink" href="#textual-gradient" title="Link to this heading">¶</a></h2>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="optim.text_grad.llm_text_loss.html#module-optim.text_grad.llm_text_loss" title="optim.text_grad.llm_text_loss"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optim.text_grad.llm_text_loss</span></code></a></p></td>
<td><p>Implementation of TextGrad: Automatic “Differentiation” via Text.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="optim.text_grad.text_loss_with_eval_fn.html#module-optim.text_grad.text_loss_with_eval_fn" title="optim.text_grad.text_loss_with_eval_fn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optim.text_grad.text_loss_with_eval_fn</span></code></a></p></td>
<td><p>Adapted from text_grad's String Based Function</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="optim.text_grad.ops.html#module-optim.text_grad.ops" title="optim.text_grad.ops"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optim.text_grad.ops</span></code></a></p></td>
<td><p>Text-grad operations such as Sum and Aggregate.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="optim.text_grad.tgd_optimizer.html#module-optim.text_grad.tgd_optimizer" title="optim.text_grad.tgd_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optim.text_grad.tgd_optimizer</span></code></a></p></td>
<td><p>Text-grad optimizer and prompts.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="toctree-wrapper compound">
</div>
</section>
<section id="trainer-and-adalcomponent">
<h2>Trainer and AdalComponent<a class="headerlink" href="#trainer-and-adalcomponent" title="Link to this heading">¶</a></h2>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="optim.trainer.adal.html#module-optim.trainer.adal" title="optim.trainer.adal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optim.trainer.adal</span></code></a></p></td>
<td><p>AdalComponent provides an interface to compose different parts, from eval_fn, train_step, loss_step, optimizers, backward engine, teacher generator, etc to work with Trainer.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="optim.trainer.trainer.html#module-optim.trainer.trainer" title="optim.trainer.trainer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optim.trainer.trainer</span></code></a></p></td>
<td><p>Ready to use trainer for LLM task pipeline</p></td>
</tr>
</tbody>
</table>
</div>
<div class="toctree-wrapper compound">
</div>
</section>
<section id="module-optim">
<span id="overview"></span><h2>Overview<a class="headerlink" href="#module-optim" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="optim.Optimizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Optimizer</span></span><a class="reference internal" href="../../_modules/optim/optimizer.html#Optimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Optimizer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for all optimizers.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Optimizer.proposing">
<span class="sig-name descname"><span class="pre">proposing</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#optim.Optimizer.proposing" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Optimizer.params">
<span class="sig-name descname"><span class="pre">params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Parameter</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#optim.Optimizer.params" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Optimizer.state_dict">
<span class="sig-name descname"><span class="pre">state_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/optimizer.html#Optimizer.state_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Optimizer.state_dict" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Optimizer.propose">
<span class="sig-name descname"><span class="pre">propose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/optimizer.html#Optimizer.propose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Optimizer.propose" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Optimizer.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/optimizer.html#Optimizer.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Optimizer.step" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Optimizer.revert">
<span class="sig-name descname"><span class="pre">revert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/optimizer.html#Optimizer.revert"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Optimizer.revert" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="optim.RandomSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RandomSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">T_co</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_num_shots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/sampler.html#RandomSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.RandomSampler" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="optim.sampler.html#optim.sampler.Sampler" title="optim.sampler.Sampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sampler</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">T_co</span></code>]</p>
<p>Simple random sampler to sample from the dataset.</p>
<dl class="py method">
<dt class="sig sig-object py" id="optim.RandomSampler.set_dataset">
<span class="sig-name descname"><span class="pre">set_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">T_co</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/sampler.html#RandomSampler.set_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.RandomSampler.set_dataset" title="Link to this definition">¶</a></dt>
<dd><p>Set the dataset for the sampler</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.RandomSampler.random_replace">
<span class="sig-name descname"><span class="pre">random_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="optim.sampler.html#optim.sampler.Sample" title="optim.sampler.Sample"><span class="pre">Sample</span></a><span class="p"><span class="pre">[</span></span><span class="pre">T_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="optim.sampler.html#optim.sampler.Sample" title="optim.sampler.Sample"><span class="pre">Sample</span></a><span class="p"><span class="pre">[</span></span><span class="pre">T_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/optim/sampler.html#RandomSampler.random_replace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.RandomSampler.random_replace" title="Link to this definition">¶</a></dt>
<dd><p>Randomly replace num of shots in the samples.</p>
<p>If replace is True, it will skip duplicate checks</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.RandomSampler.random_sample">
<span class="sig-name descname"><span class="pre">random_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="optim.sampler.html#optim.sampler.Sample" title="optim.sampler.Sample"><span class="pre">Sample</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/optim/sampler.html#RandomSampler.random_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.RandomSampler.random_sample" title="Link to this definition">¶</a></dt>
<dd><p>Randomly sample num of shots from the dataset. If replace is True, sample with replacement,
meaning the same sample can be sampled multiple times.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.RandomSampler.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_shots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="optim.sampler.html#optim.sampler.Sample" title="optim.sampler.Sample"><span class="pre">Sample</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/optim/sampler.html#RandomSampler.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.RandomSampler.call" title="Link to this definition">¶</a></dt>
<dd><p>Abstract method to do the main sampling</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="optim.ClassSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ClassSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">T_co</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_data_key_fun</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_num_shots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/sampler.html#ClassSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.ClassSampler" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="optim.sampler.html#optim.sampler.Sampler" title="optim.sampler.Sampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sampler</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">T_co</span></code>]</p>
<p>Sample from the dataset based on the class labels.</p>
<p>T_co can be any type of data, e.g., dict, list, etc. with get_data_key_fun to extract the class label.</p>
<p>Example:
Initialize
<code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">dataset</span> <span class="pre">=</span> <span class="pre">[{&quot;coarse_label&quot;:</span> <span class="pre">i}</span> <span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">range(10)]</span>
<span class="pre">sampler</span> <span class="pre">=</span> <span class="pre">ClassSampler[Dict](dataset,</span> <span class="pre">num_classes=6,</span> <span class="pre">get_data_key_fun=lambda</span> <span class="pre">x:</span> <span class="pre">x[&quot;coarse_label&quot;])</span>
<span class="pre">`</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="optim.ClassSampler.random_replace">
<span class="sig-name descname"><span class="pre">random_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="optim.sampler.html#optim.sampler.Sample" title="optim.sampler.Sample"><span class="pre">Sample</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_per_class</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="optim.sampler.html#optim.sampler.Sample" title="optim.sampler.Sample"><span class="pre">Sample</span></a><span class="p"><span class="pre">[</span></span><span class="pre">T_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/optim/sampler.html#ClassSampler.random_replace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.ClassSampler.random_replace" title="Link to this definition">¶</a></dt>
<dd><p>Randomly select num shots from the samples and replace it with another sample has the same class index</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.ClassSampler.random_sample">
<span class="sig-name descname"><span class="pre">random_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_shots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="optim.sampler.html#optim.sampler.Sample" title="optim.sampler.Sample"><span class="pre">Sample</span></a><span class="p"><span class="pre">[</span></span><span class="pre">T_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/optim/sampler.html#ClassSampler.random_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.ClassSampler.random_sample" title="Link to this definition">¶</a></dt>
<dd><p>Randomly sample num_shots from the dataset. If replace is True, sample with replacement.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.ClassSampler.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_shots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="optim.sampler.html#optim.sampler.Sample" title="optim.sampler.Sample"><span class="pre">Sample</span></a><span class="p"><span class="pre">[</span></span><span class="pre">T_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/optim/sampler.html#ClassSampler.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.ClassSampler.call" title="Link to this definition">¶</a></dt>
<dd><p>Sample num_shots from the dataset. If replace is True, sample with replacement.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="optim.Sampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/sampler.html#Sampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Sampler" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">T_co</span></code>]</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Sampler.dataset">
<span class="sig-name descname"><span class="pre">dataset</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.Sampler.dataset" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Sampler.set_dataset">
<span class="sig-name descname"><span class="pre">set_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">T_co</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/sampler.html#Sampler.set_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Sampler.set_dataset" title="Link to this definition">¶</a></dt>
<dd><p>Set the dataset for the sampler</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Sampler.random_replace">
<span class="sig-name descname"><span class="pre">random_replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/sampler.html#Sampler.random_replace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Sampler.random_replace" title="Link to this definition">¶</a></dt>
<dd><p>Randomly replace some samples</p>
<p>You can have two arguments, e.g., shots and samples, or shots, samples, and replace.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Sampler.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="optim.sampler.html#optim.sampler.Sample" title="optim.sampler.Sample"><span class="pre">Sample</span></a><span class="p"><span class="pre">[</span></span><span class="pre">T_co</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/optim/sampler.html#Sampler.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Sampler.call" title="Link to this definition">¶</a></dt>
<dd><p>Abstract method to do the main sampling</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="optim.Parameter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Parameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data:</span> <span class="pre">~optim.parameter.T</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_id:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires_opt:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">role_desc:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_type:</span> <span class="pre">~adalflow.optim.types.ParameterType</span> <span class="pre">=</span> <span class="pre">&lt;ParameterType.NONE:</span> <span class="pre">none</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">''&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instruction_to_optimizer:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instruction_to_backward_engine:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_input:</span> <span class="pre">object</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">successor_map_fn:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Callable]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_in_prompt:</span> <span class="pre">~typing.Callable</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">T</span></code>]</p>
<p>A data container to represent a parameter used for optimization.</p>
<p>A parameter enforce a specific data type and can be updated in-place.
When parameters are used in a component - when they are assigned as Component attributes
they are automatically added to the list of its parameters, and  will
appear in the <code class="xref py py-meth docutils literal notranslate"><span class="pre">parameters()</span></code> or <code class="xref py py-meth docutils literal notranslate"><span class="pre">named_parameters()</span></code> method.</p>
<p>Args:</p>
<p>End users only need to create the Parameter with four arguments and pass it to the
prompt_kwargs in the Generator.</p>
<blockquote>
<div><ul class="simple">
<li><p>data (str): the data of the parameter</p></li>
<li><p>requires_opt (bool, optional): if the parameter requires optimization. Default: <cite>True</cite></p></li>
<li><p>role_desc.</p></li>
<li><p>param_type, incuding ParameterType.PROMPT for instruction optimization, ParameterType.DEMOS</p></li>
</ul>
<p>for few-shot optimization.
- instruction_to_optimizer (str, optional): instruction to the optimizer. Default: <cite>None</cite>
- instruction_to_backward_engine (str, optional): instruction to the backward engine. Default: <cite>None</cite></p>
</div></blockquote>
<p>The parameter users created will be automatically assigned to the variable_name/key in the prompt_kwargs
for easy reading and debugging in the trace_graph.</p>
<p>References:</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://github.com/karpathy/micrograd/blob/master/micrograd/engine.py">https://github.com/karpathy/micrograd/blob/master/micrograd/engine.py</a></p></li>
</ol>
<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Parameter.allowed_types">
<span class="sig-name descname"><span class="pre">allowed_types</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{&lt;ParameterType.DEMOS:</span> <span class="pre">demos,</span> <span class="pre">'A</span> <span class="pre">few</span> <span class="pre">examples</span> <span class="pre">to</span> <span class="pre">guide</span> <span class="pre">the</span> <span class="pre">language</span> <span class="pre">model.'&gt;,</span> <span class="pre">&lt;ParameterType.HYPERPARAM:</span> <span class="pre">hyperparam,</span> <span class="pre">'Hyperparameters/args</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">component.'&gt;,</span> <span class="pre">&lt;ParameterType.INPUT:</span> <span class="pre">input,</span> <span class="pre">'The</span> <span class="pre">input</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">component.'&gt;,</span> <span class="pre">&lt;ParameterType.NONE:</span> <span class="pre">none,</span> <span class="pre">''&gt;,</span> <span class="pre">&lt;ParameterType.PROMPT:</span> <span class="pre">prompt,</span> <span class="pre">'Instruction</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">language</span> <span class="pre">model</span> <span class="pre">on</span> <span class="pre">task,</span> <span class="pre">data,</span> <span class="pre">and</span> <span class="pre">format.'&gt;}</span></em><a class="headerlink" href="#optim.Parameter.allowed_types" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Parameter.proposing">
<span class="sig-name descname"><span class="pre">proposing</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#optim.Parameter.proposing" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Parameter.predecessors">
<span class="sig-name descname"><span class="pre">predecessors</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Set</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#optim.Parameter" title="optim.Parameter"><span class="pre">Parameter</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#optim.Parameter.predecessors" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Parameter.peers">
<span class="sig-name descname"><span class="pre">peers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Set</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#optim.Parameter" title="optim.Parameter"><span class="pre">Parameter</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#optim.Parameter.peers" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Parameter.tgd_optimizer_trace">
<span class="sig-name descname"><span class="pre">tgd_optimizer_trace</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="optim.text_grad.tgd_optimizer.html#optim.text_grad.tgd_optimizer.TGDOptimizerTrace" title="optim.text_grad.tgd_optimizer.TGDOptimizerTrace"><span class="pre">TGDOptimizerTrace</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.Parameter.tgd_optimizer_trace" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Parameter.id">
<span class="sig-name descname"><span class="pre">id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.Parameter.id" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Parameter.data_id">
<span class="sig-name descname"><span class="pre">data_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.Parameter.data_id" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Parameter.role_desc">
<span class="sig-name descname"><span class="pre">role_desc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">''</span></em><a class="headerlink" href="#optim.Parameter.role_desc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Parameter.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.Parameter.name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Parameter.param_type">
<span class="sig-name descname"><span class="pre">param_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ParameterType</span></em><a class="headerlink" href="#optim.Parameter.param_type" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Parameter.data">
<span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">T</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.Parameter.data" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Parameter.eval_input">
<span class="sig-name descname"><span class="pre">eval_input</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">object</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.Parameter.eval_input" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Parameter.successor_map_fn">
<span class="sig-name descname"><span class="pre">successor_map_fn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.Parameter.successor_map_fn" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Parameter.data_in_prompt">
<span class="sig-name descname"><span class="pre">data_in_prompt</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.Parameter.data_in_prompt" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Parameter.gt">
<span class="sig-name descname"><span class="pre">gt</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">object</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.Parameter.gt" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.map_to_successor">
<span class="sig-name descname"><span class="pre">map_to_successor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">successor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">T</span></span></span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.map_to_successor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.map_to_successor" title="Link to this definition">¶</a></dt>
<dd><p>Apply the map function to the successor based on the successor’s id.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.add_successor_map_fn">
<span class="sig-name descname"><span class="pre">add_successor_map_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">successor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.add_successor_map_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.add_successor_map_fn" title="Link to this definition">¶</a></dt>
<dd><p>Add or update a map function of the value for a specific successor using its id.
succssor will know the value of the current parameter.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.check_if_already_computed_gradient_respect_to">
<span class="sig-name descname"><span class="pre">check_if_already_computed_gradient_respect_to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">response_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.check_if_already_computed_gradient_respect_to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.check_if_already_computed_gradient_respect_to" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.set_gt">
<span class="sig-name descname"><span class="pre">set_gt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.set_gt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.set_gt" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.get_gt">
<span class="sig-name descname"><span class="pre">get_gt</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">object</span></span></span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.get_gt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.get_gt" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.add_gradient">
<span class="sig-name descname"><span class="pre">add_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gradient</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Gradient</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.add_gradient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.add_gradient" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.reset_gradients">
<span class="sig-name descname"><span class="pre">reset_gradients</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.reset_gradients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.reset_gradients" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.get_gradients_names">
<span class="sig-name descname"><span class="pre">get_gradients_names</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.get_gradients_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.get_gradients_names" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.get_prompt_data">
<span class="sig-name descname"><span class="pre">get_prompt_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.get_prompt_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.get_prompt_data" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.get_gradients_str">
<span class="sig-name descname"><span class="pre">get_gradients_str</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.get_gradients_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.get_gradients_str" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.get_gradient_and_context_text">
<span class="sig-name descname"><span class="pre">get_gradient_and_context_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skip_correct_sample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.get_gradient_and_context_text"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.get_gradient_and_context_text" title="Link to this definition">¶</a></dt>
<dd><p>Aggregates and returns:
1. the gradients
2. the context text for which the gradients are computed</p>
<p>Sort the gradients from the lowest score to the highest score.
Highlight the gradients with the lowest score to the optimizer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.get_gradients_component_schema">
<span class="sig-name descname"><span class="pre">get_gradients_component_schema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skip_correct_sample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.get_gradients_component_schema"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.get_gradients_component_schema" title="Link to this definition">¶</a></dt>
<dd><p>Aggregates and returns:
1. the gradients
2. the context text for which the gradients are computed</p>
<p>Sort the gradients from the lowest score to the highest score.
Highlight the gradients with the lowest score to the optimizer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.merge_gradients_for_cycle_components">
<span class="sig-name descname"><span class="pre">merge_gradients_for_cycle_components</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.merge_gradients_for_cycle_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.merge_gradients_for_cycle_components" title="Link to this definition">¶</a></dt>
<dd><p>Merge data_id, from_response_component_id into the same gradient</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.sort_gradients">
<span class="sig-name descname"><span class="pre">sort_gradients</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.sort_gradients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.sort_gradients" title="Link to this definition">¶</a></dt>
<dd><p>With rules mentioned in Graient class, we will track the gradients by data_id, then response_component_id, then score</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.set_predecessors">
<span class="sig-name descname"><span class="pre">set_predecessors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predecessors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="optim.parameter.html#optim.parameter.Parameter" title="optim.parameter.Parameter"><span class="pre">Parameter</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.set_predecessors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.set_predecessors" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.set_grad_fn">
<span class="sig-name descname"><span class="pre">set_grad_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grad_fn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.set_grad_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.set_grad_fn" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.get_param_info">
<span class="sig-name descname"><span class="pre">get_param_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.get_param_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.get_param_info" title="Link to this definition">¶</a></dt>
<dd><p>Used to represent the parameter in the prompt.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.set_peers">
<span class="sig-name descname"><span class="pre">set_peers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">peers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="optim.parameter.html#optim.parameter.Parameter" title="optim.parameter.Parameter"><span class="pre">Parameter</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.set_peers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.set_peers" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.trace_optimizer">
<span class="sig-name descname"><span class="pre">trace_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">api_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">response</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="optim.text_grad.tgd_optimizer.html#optim.text_grad.tgd_optimizer.TGDData" title="optim.text_grad.tgd_optimizer.TGDData"><span class="pre">TGDData</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.trace_optimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.trace_optimizer" title="Link to this definition">¶</a></dt>
<dd><p>Trace the inputs and output of a TGD optimizer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.set_eval_fn_input">
<span class="sig-name descname"><span class="pre">set_eval_fn_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eval_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.set_eval_fn_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.set_eval_fn_input" title="Link to this definition">¶</a></dt>
<dd><p>Set the input for the eval_fn.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.set_score">
<span class="sig-name descname"><span class="pre">set_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">score</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.set_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.set_score" title="Link to this definition">¶</a></dt>
<dd><p>Set the score of the parameter in the backward pass
For intermediate nodes, there is only one score per each eval fn behind this node.
For leaf nodes, like DEMO or PROMPT, it will have [batch_size] of scores.</p>
<p>But this score is only used to relay the score to the demo parametr.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.add_dataclass_to_trace">
<span class="sig-name descname"><span class="pre">add_dataclass_to_trace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataClass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_teacher</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.add_dataclass_to_trace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.add_dataclass_to_trace" title="Link to this definition">¶</a></dt>
<dd><p>Called by the generator.forward to add a trace to the parameter.</p>
<p>It is important to allow updating to the trace, as this will give different sampling weight.
If the score increases as the training going on, it will become less likely to be sampled,
allowing the samples to be more diverse. Or else, it will keep sampling failed examples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.add_score_to_trace">
<span class="sig-name descname"><span class="pre">add_score_to_trace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trace_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_teacher</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.add_score_to_trace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.add_score_to_trace" title="Link to this definition">¶</a></dt>
<dd><p>Called by the generator.backward to add the eval score to the trace.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.propose_data">
<span class="sig-name descname"><span class="pre">propose_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">demos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">DataClass</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.propose_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.propose_data" title="Link to this definition">¶</a></dt>
<dd><p>Used by optimizer to put the new data, and save the previous data in case of revert.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.revert_data">
<span class="sig-name descname"><span class="pre">revert_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_demos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.revert_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.revert_data" title="Link to this definition">¶</a></dt>
<dd><p>Revert the data to the previous data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.step_data">
<span class="sig-name descname"><span class="pre">step_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_demos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.step_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.step_data" title="Link to this definition">¶</a></dt>
<dd><p>Use PyTorch’s optimizer syntax to finalize the update of the data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.get_grad_fn">
<span class="sig-name descname"><span class="pre">get_grad_fn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.get_grad_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.get_grad_fn" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.update_value">
<span class="sig-name descname"><span class="pre">update_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">T</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.update_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.update_value" title="Link to this definition">¶</a></dt>
<dd><p>Update the parameter’s value in-place, checking for type correctness.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.get_short_value">
<span class="sig-name descname"><span class="pre">get_short_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_words_offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.get_short_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.get_short_value" title="Link to this definition">¶</a></dt>
<dd><p>Returns a short version of the value of the variable. We sometimes use it during optimization, when we want to see the value of the variable, but don’t want to see the entire value.
This is sometimes to save tokens, sometimes to reduce repeating very long variables, such as code or solutions to hard problems.
:param n_words_offset: The number of words to show from the beginning and the end of the value.
:type n_words_offset: int</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.reset_all_gradients">
<span class="sig-name descname"><span class="pre">reset_all_gradients</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.reset_all_gradients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.reset_all_gradients" title="Link to this definition">¶</a></dt>
<dd><p>Traverse the graph and reset the gradients for all nodes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.trace_graph">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">trace_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="optim.parameter.html#optim.parameter.Parameter" title="optim.parameter.Parameter"><span class="pre">Parameter</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Set</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="optim.parameter.html#optim.parameter.Parameter" title="optim.parameter.Parameter"><span class="pre">Parameter</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Set</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="optim.parameter.html#optim.parameter.Parameter" title="optim.parameter.Parameter"><span class="pre">Parameter</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="optim.parameter.html#optim.parameter.Parameter" title="optim.parameter.Parameter"><span class="pre">Parameter</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.trace_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.trace_graph" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.backward">
<span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.backward" title="Link to this definition">¶</a></dt>
<dd><p>Apply backward pass for for all nodes in the graph by reversing the topological order.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.generate_node_html">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">generate_node_html</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="optim.parameter.html#optim.parameter.Parameter" title="optim.parameter.Parameter"><span class="pre">Parameter</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'node_pages'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.generate_node_html"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.generate_node_html" title="Link to this definition">¶</a></dt>
<dd><p>Generate an HTML page for a specific node.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.draw_interactive_html_graph">
<span class="sig-name descname"><span class="pre">draw_interactive_html_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="optim.parameter.html#optim.parameter.Parameter" title="optim.parameter.Parameter"><span class="pre">Parameter</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edges</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="optim.parameter.html#optim.parameter.Parameter" title="optim.parameter.Parameter"><span class="pre">Parameter</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="optim.parameter.html#optim.parameter.Parameter" title="optim.parameter.Parameter"><span class="pre">Parameter</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.draw_interactive_html_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.draw_interactive_html_graph" title="Link to this definition">¶</a></dt>
<dd><p>Generate an interactive graph with pyvis and save as an HTML file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nodes</strong> (<em>list</em>) – A list of Parameter objects.</p></li>
<li><p><strong>edges</strong> (<em>list</em>) – A list of edges as tuples (source, target).</p></li>
<li><p><strong>filepath</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to save the graph file. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the graph file path.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.wrap_and_escape">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">wrap_and_escape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.wrap_and_escape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.wrap_and_escape" title="Link to this definition">¶</a></dt>
<dd><p>Wrap text to the specified width, considering HTML breaks, and escape special characters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.draw_graph">
<span class="sig-name descname"><span class="pre">draw_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">add_grads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_trace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'png'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'svg'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'png'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rankdir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'LR'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'TB'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'TB'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.draw_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.draw_graph" title="Link to this definition">¶</a></dt>
<dd><p>Draw the graph of the parameter and its gradients.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>add_grads</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to add gradients to the graph. Defaults to True.</p></li>
<li><p><strong>format</strong> (<em>str</em><em>, </em><em>optional</em>) – The format of the output file. Defaults to “png”.</p></li>
<li><p><strong>rankdir</strong> (<em>str</em><em>, </em><em>optional</em>) – The direction of the graph. Defaults to “TB”.</p></li>
<li><p><strong>filepath</strong> (<em>str</em><em>, </em><em>optional</em>) – The path to save the graph. Defaults to None.</p></li>
<li><p><strong>full_trace</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to include more detailed trace such as api_kwargs. Defaults to False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.draw_output_subgraph">
<span class="sig-name descname"><span class="pre">draw_output_subgraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">add_grads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'png'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rankdir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'TB'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.draw_output_subgraph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.draw_output_subgraph" title="Link to this definition">¶</a></dt>
<dd><p>Build and visualize a subgraph containing only OUTPUT parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>add_grads</strong> (<em>bool</em>) – Whether to include gradient edges.</p></li>
<li><p><strong>format</strong> (<em>str</em>) – Format for output (e.g., png, svg).</p></li>
<li><p><strong>rankdir</strong> (<em>str</em>) – Graph layout direction (“LR” or “TB”).</p></li>
<li><p><strong>filepath</strong> (<em>str</em>) – Path to save the graph.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.draw_component_subgraph">
<span class="sig-name descname"><span class="pre">draw_component_subgraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'png'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rankdir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'TB'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.draw_component_subgraph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.draw_component_subgraph" title="Link to this definition">¶</a></dt>
<dd><p>Build and visualize a subgraph containing only OUTPUT parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>format</strong> (<em>str</em>) – Format for output (e.g., png, svg).</p></li>
<li><p><strong>rankdir</strong> (<em>str</em>) – Graph layout direction (“LR” or “TB”).</p></li>
<li><p><strong>filepath</strong> (<em>str</em>) – Path to save the graph.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.to_dict">
<span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.to_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.to_dict" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Parameter.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#Parameter.from_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Parameter.from_dict" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="optim.OutputParameter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">OutputParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data:</span> <span class="pre">~optim.parameter.T</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_id:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires_opt:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">role_desc:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_type:</span> <span class="pre">~adalflow.optim.types.ParameterType</span> <span class="pre">=</span> <span class="pre">&lt;ParameterType.OUTPUT:</span> <span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'The</span> <span class="pre">output</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">component.'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instruction_to_optimizer:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instruction_to_backward_engine:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score:</span> <span class="pre">float</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_input:</span> <span class="pre">object</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">successor_map_fn:</span> <span class="pre">~typing.Dict[str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">~typing.Callable]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_in_prompt:</span> <span class="pre">~typing.Callable</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_response:</span> <span class="pre">~typing.Any</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#OutputParameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.OutputParameter" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="optim.parameter.html#optim.parameter.Parameter" title="optim.parameter.Parameter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameter</span></code></a></p>
<p>The output parameter is the most complex type of parameter in the system.</p>
<p>It will trace the predecessors, set up a grad_fn, store gradients, and trace the forward pass by tracking the component_trace.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="optim.OutputParameter.allowed_types">
<span class="sig-name descname"><span class="pre">allowed_types</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{&lt;ParameterType.GENERATOR_OUTPUT:</span> <span class="pre">generator_output,</span> <span class="pre">'The</span> <span class="pre">output</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">generator.'&gt;,</span> <span class="pre">&lt;ParameterType.LOSS_OUTPUT:</span> <span class="pre">loss,</span> <span class="pre">'The</span> <span class="pre">loss</span> <span class="pre">value.'&gt;,</span> <span class="pre">&lt;ParameterType.OUTPUT:</span> <span class="pre">output,</span> <span class="pre">'The</span> <span class="pre">output</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">component.'&gt;,</span> <span class="pre">&lt;ParameterType.SUM_OUTPUT:</span> <span class="pre">sum,</span> <span class="pre">'The</span> <span class="pre">sum</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">losses.'&gt;}</span></em><a class="headerlink" href="#optim.OutputParameter.allowed_types" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.OutputParameter.component_trace">
<span class="sig-name descname"><span class="pre">component_trace</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="optim.parameter.html#optim.parameter.ComponentTrace" title="optim.parameter.ComponentTrace"><span class="pre">ComponentTrace</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.OutputParameter.component_trace" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.OutputParameter.full_response">
<span class="sig-name descname"><span class="pre">full_response</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">object</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.OutputParameter.full_response" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.OutputParameter.trace_forward_pass">
<span class="sig-name descname"><span class="pre">trace_forward_pass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_response</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#OutputParameter.trace_forward_pass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.OutputParameter.trace_forward_pass" title="Link to this definition">¶</a></dt>
<dd><p>Trace the forward pass of the parameter. Adding the component information to the trace</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.OutputParameter.trace_api_kwargs">
<span class="sig-name descname"><span class="pre">trace_api_kwargs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">api_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#OutputParameter.trace_api_kwargs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.OutputParameter.trace_api_kwargs" title="Link to this definition">¶</a></dt>
<dd><p>Trace the api_kwargs for components like Generator and Retriever that pass to the model client.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.OutputParameter.to_dict">
<span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#OutputParameter.to_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.OutputParameter.to_dict" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.OutputParameter.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/parameter.html#OutputParameter.from_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.OutputParameter.from_dict" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="optim.BackwardContext">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BackwardContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">disable_backward_engine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backward_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backward_engine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../core/core.generator.html#core.generator.BackwardEngine" title="core.generator.BackwardEngine"><span class="pre">BackwardEngine</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/function.html#BackwardContext"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.BackwardContext" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Represents a context for backward computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>backward_fn</strong> (<em>callable</em>) – The backward function to be called during backward computation.</p></li>
<li><p><strong>args</strong> – Variable length argument list to be passed to the backward function.</p></li>
<li><p><strong>kwargs</strong> – Arbitrary keyword arguments to be passed to the backward function.</p></li>
</ul>
</dd>
<dt class="field-even">Variables<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>backward_fn</strong> (<em>callable</em>) – The backward function to be called during backward computation.</p></li>
<li><p><strong>fn_name</strong> (<em>str</em>) – The fully qualified name of the backward function.</p></li>
<li><p><strong>args</strong> – Variable length argument list to be passed to the backward function.</p></li>
<li><p><strong>kwargs</strong> – Arbitrary keyword arguments to be passed to the backward function.</p></li>
</ul>
</dd>
<dt class="field-odd">Method __call__(backward_engine<span class="colon">:</span></dt>
<dd class="field-odd"><p>EngineLM) -&gt; Any:
Calls the backward function with the given backward engine and returns the result.</p>
</dd>
<dt class="field-even">Method __repr__() -&gt; str<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns a string representation of the BackwardContext object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="optim.BootstrapFewShot">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BootstrapFewShot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Parameter</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw_shots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_shots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">DataClass</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_input_fields_from_bootstrap_demos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/few_shot/bootstrap_optimizer.html#BootstrapFewShot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.BootstrapFewShot" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">DemoOptimizer</span></code></p>
<p>BootstrapFewShot performs few-shot sampling used in few-shot ICL.</p>
<p>It will be used to optimize paramters of demos.
Based on research from AdalFlow team and DsPy library.</p>
<dl class="simple">
<dt>Compared with Dspy’s version:</dt><dd><ol class="arabic simple">
<li><p>we added weighted sampling for both the raw and augmented demos
to prioritize failed demos but successful in augmented demos based on the evaluation score
while we backpropagate the demo samples.</p></li>
<li><p>In default, we exclude the input fields from the augmented demos. Our reserch finds that
using the reasoning demostrations from teacher model can be more effective in some cases than taking both inputs and output
samples and be more token efficient.</p></li>
</ol>
</dd>
</dl>
<p>Reference:
- DsPy: Com-piling declarative language model calls into state-of-the-art pipelines.</p>
<dl class="py method">
<dt class="sig sig-object py" id="optim.BootstrapFewShot.add_scores">
<span class="sig-name descname"><span class="pre">add_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_teacher</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/few_shot/bootstrap_optimizer.html#BootstrapFewShot.add_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.BootstrapFewShot.add_scores" title="Link to this definition">¶</a></dt>
<dd><p>Add scores for each demo via _teacher_scores or _student_scores.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.BootstrapFewShot.config_shots">
<span class="sig-name descname"><span class="pre">config_shots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raw_shots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_shots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/few_shot/bootstrap_optimizer.html#BootstrapFewShot.config_shots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.BootstrapFewShot.config_shots" title="Link to this definition">¶</a></dt>
<dd><p>Initialize the samples for each parameter.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.BootstrapFewShot.config_dataset">
<span class="sig-name descname"><span class="pre">config_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">DataClass</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/few_shot/bootstrap_optimizer.html#BootstrapFewShot.config_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.BootstrapFewShot.config_dataset" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="optim.BootstrapFewShot.num_shots">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_shots</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#optim.BootstrapFewShot.num_shots" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.BootstrapFewShot.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">augmented_demos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataClass</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">demos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataClass</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">DataClass</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw_shots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_shots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/few_shot/bootstrap_optimizer.html#BootstrapFewShot.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.BootstrapFewShot.sample" title="Link to this definition">¶</a></dt>
<dd><p>Performs weighted sampling, ensure the score is in range [0, 1]. The higher score means better accuracy.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.BootstrapFewShot.samples_to_str">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">samples_to_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">DataClass</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">augmented</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../../_modules/optim/few_shot/bootstrap_optimizer.html#BootstrapFewShot.samples_to_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.BootstrapFewShot.samples_to_str" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.BootstrapFewShot.propose">
<span class="sig-name descname"><span class="pre">propose</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/few_shot/bootstrap_optimizer.html#BootstrapFewShot.propose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.BootstrapFewShot.propose" title="Link to this definition">¶</a></dt>
<dd><p>Proposing a value while keeping previous value saved on parameter.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.BootstrapFewShot.revert">
<span class="sig-name descname"><span class="pre">revert</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/few_shot/bootstrap_optimizer.html#BootstrapFewShot.revert"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.BootstrapFewShot.revert" title="Link to this definition">¶</a></dt>
<dd><p>Revert to the previous value when the evaluation is worse.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.BootstrapFewShot.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/few_shot/bootstrap_optimizer.html#BootstrapFewShot.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.BootstrapFewShot.step" title="Link to this definition">¶</a></dt>
<dd><p>Discard the previous value and keep the proposed value.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="optim.TGDOptimizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TGDOptimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Parameter</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_client</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../core/core.model_client.html#core.model_client.ModelClient" title="core.model_client.ModelClient"><span class="pre">ModelClient</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer_system_prompt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'You</span> <span class="pre">are</span> <span class="pre">an</span> <span class="pre">excellent</span> <span class="pre">prompt</span> <span class="pre">engineer</span> <span class="pre">tasked</span> <span class="pre">with</span> <span class="pre">instruction</span> <span class="pre">and</span> <span class="pre">demonstration</span> <span class="pre">tuning</span> <span class="pre">a</span> <span class="pre">compound</span> <span class="pre">LLM</span> <span class="pre">system.\nYour</span> <span class="pre">task</span> <span class="pre">is</span> <span class="pre">to</span> <span class="pre">refine</span> <span class="pre">a</span> <span class="pre">variable/prompt</span> <span class="pre">based</span> <span class="pre">on</span> <span class="pre">feedback</span> <span class="pre">from</span> <span class="pre">a</span> <span class="pre">batch</span> <span class="pre">of</span> <span class="pre">input</span> <span class="pre">data</span> <span class="pre">points.\n\nThe</span> <span class="pre">variable</span> <span class="pre">is</span> <span class="pre">either</span> <span class="pre">input</span> <span class="pre">or</span> <span class="pre">output</span> <span class="pre">of</span> <span class="pre">a</span> <span class="pre">functional</span> <span class="pre">component</span> <span class="pre">where</span> <span class="pre">the</span> <span class="pre">component</span> <span class="pre">schema</span> <span class="pre">will</span> <span class="pre">be</span> <span class="pre">provided.\nIf</span> <span class="pre">the</span> <span class="pre">same</span> <span class="pre">DataID</span> <span class="pre">has</span> <span class="pre">multiple</span> <span class="pre">gradients,</span> <span class="pre">it</span> <span class="pre">means</span> <span class="pre">this</span> <span class="pre">component/variable</span> <span class="pre">is</span> <span class="pre">called</span> <span class="pre">multiple</span> <span class="pre">times</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">compound</span> <span class="pre">system(with</span> <span class="pre">a</span> <span class="pre">cycle)</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">same</span> <span class="pre">order</span> <span class="pre">as</span> <span class="pre">it</span> <span class="pre">appears</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">gradient</span> <span class="pre">list.\n\nYou</span> <span class="pre">Must</span> <span class="pre">edit</span> <span class="pre">the</span> <span class="pre">current</span> <span class="pre">variable</span> <span class="pre">with</span> <span class="pre">one</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">following</span> <span class="pre">editing</span> <span class="pre">methods.\nYou</span> <span class="pre">can</span> <span class="pre">not</span> <span class="pre">rewrite</span> <span class="pre">everything</span> <span class="pre">all</span> <span class="pre">at</span> <span class="pre">once:\n\nYou</span> <span class="pre">have</span> <span class="pre">Four</span> <span class="pre">Editing</span> <span class="pre">Methods:\n1.</span> <span class="pre">ADD</span> <span class="pre">new</span> <span class="pre">elements(instruction)</span> <span class="pre">to</span> <span class="pre">address</span> <span class="pre">each</span> <span class="pre">specific</span> <span class="pre">feedback.\n2.</span> <span class="pre">ADD</span> <span class="pre">Examples</span> <span class="pre">(e.g.,</span> <span class="pre">input-reasoning-answer)</span> <span class="pre">for</span> <span class="pre">tasks</span> <span class="pre">that</span> <span class="pre">require</span> <span class="pre">strong</span> <span class="pre">reasoning</span> <span class="pre">skills.\n3.</span> <span class="pre">Rephrase</span> <span class="pre">existing</span> <span class="pre">instruction(for</span> <span class="pre">more</span> <span class="pre">clarity),</span> <span class="pre">Replace</span> <span class="pre">existing</span> <span class="pre">sample</span> <span class="pre">with</span> <span class="pre">another,</span> <span class="pre">to</span> <span class="pre">address</span> <span class="pre">the</span> <span class="pre">feedback.\n4.</span> <span class="pre">DELETE</span> <span class="pre">unnecessary</span> <span class="pre">words</span> <span class="pre">to</span> <span class="pre">improve</span> <span class="pre">clarity.\n\nThese</span> <span class="pre">SIX</span> <span class="pre">prompting</span> <span class="pre">techniques</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">a</span> <span class="pre">helpful</span> <span class="pre">direction.\n1.</span> <span class="pre">Set</span> <span class="pre">Context</span> <span class="pre">and</span> <span class="pre">Role:</span> <span class="pre">Establish</span> <span class="pre">a</span> <span class="pre">specific</span> <span class="pre">identity</span> <span class="pre">or</span> <span class="pre">domain</span> <span class="pre">expertise</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">AI</span> <span class="pre">to</span> <span class="pre">guide</span> <span class="pre">style,</span> <span class="pre">knowledge,</span> <span class="pre">and</span> <span class="pre">constraints.\n2.</span> <span class="pre">Be</span> <span class="pre">Specific,</span> <span class="pre">Clear,</span> <span class="pre">and</span> <span class="pre">Grammarly</span> <span class="pre">correct:</span> <span class="pre">Clearly</span> <span class="pre">define</span> <span class="pre">instructions,</span> <span class="pre">desired</span> <span class="pre">format,</span> <span class="pre">and</span> <span class="pre">constraints</span> <span class="pre">to</span> <span class="pre">ensure</span> <span class="pre">accurate</span> <span class="pre">and</span> <span class="pre">relevant</span> <span class="pre">outputs</span> <span class="pre">with</span> <span class="pre">regards</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">feedback.\n3.</span> <span class="pre">Illicit</span> <span class="pre">reasoning:</span> <span class="pre">&quot;chain-of-thought&quot;</span> <span class="pre">(e.g.</span> <span class="pre">&quot;think</span> <span class="pre">step</span> <span class="pre">by</span> <span class="pre">step&quot;)</span> <span class="pre">helps</span> <span class="pre">the</span> <span class="pre">model</span> <span class="pre">reason</span> <span class="pre">better.\n4.</span> <span class="pre">Examples:</span> <span class="pre">Construct</span> <span class="pre">examples(e.g.,</span> <span class="pre">input(optional)-reasoning(required)-answer)</span> <span class="pre">especially</span> <span class="pre">for</span> <span class="pre">tasks</span> <span class="pre">that</span> <span class="pre">require</span> <span class="pre">strong</span> <span class="pre">reasoning</span> <span class="pre">skills.\n5.</span> <span class="pre">Leverage</span> <span class="pre">Constraints</span> <span class="pre">and</span> <span class="pre">Formatting:</span> <span class="pre">Explicitly</span> <span class="pre">direct</span> <span class="pre">how</span> <span class="pre">the</span> <span class="pre">answer</span> <span class="pre">should</span> <span class="pre">be</span> <span class="pre">structured</span> <span class="pre">(e.g.,</span> <span class="pre">bullet</span> <span class="pre">points,</span> <span class="pre">tables,</span> <span class="pre">or</span> <span class="pre">tone).\n6.</span> <span class="pre">Self-Consistency</span> <span class="pre">/</span> <span class="pre">Verification</span> <span class="pre">Prompts:</span> <span class="pre">Prompt</span> <span class="pre">the</span> <span class="pre">model</span> <span class="pre">to</span> <span class="pre">check</span> <span class="pre">its</span> <span class="pre">own</span> <span class="pre">logic</span> <span class="pre">for</span> <span class="pre">errors,</span> <span class="pre">inconsistencies,</span> <span class="pre">or</span> <span class="pre">missing</span> <span class="pre">details.\n\nYour</span> <span class="pre">final</span> <span class="pre">action/reasoning</span>&#160; <span class="pre">=</span> <span class="pre">one</span> <span class="pre">of</span> <span class="pre">FOUR</span> <span class="pre">editing</span> <span class="pre">method</span> <span class="pre">+</span> <span class="pre">one</span> <span class="pre">of</span> <span class="pre">SIX</span> <span class="pre">prompting</span> <span class="pre">technique.\n\nYou</span> <span class="pre">must</span> <span class="pre">stick</span> <span class="pre">to</span> <span class="pre">these</span> <span class="pre">instructions:\n1.</span> <span class="pre">**MUST</span> <span class="pre">Resolve</span> <span class="pre">concerns</span> <span class="pre">raised</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">feedback**</span> <span class="pre">while</span> <span class="pre">preserving</span> <span class="pre">the</span> <span class="pre">positive</span> <span class="pre">aspects</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">original</span> <span class="pre">variable.\n2.</span> <span class="pre">**Observe</span> <span class="pre">past</span> <span class="pre">performance</span> <span class="pre">patterns**</span> <span class="pre">to</span> <span class="pre">retain</span> <span class="pre">good</span> <span class="pre">qualities</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">variable</span> <span class="pre">and</span> <span class="pre">past</span> <span class="pre">failed</span> <span class="pre">ones</span> <span class="pre">to</span> <span class="pre">try</span> <span class="pre">things</span> <span class="pre">differently.\n3.</span> <span class="pre">**System</span> <span class="pre">Awareness**:</span> <span class="pre">When</span> <span class="pre">other</span> <span class="pre">system</span> <span class="pre">variables</span> <span class="pre">are</span> <span class="pre">given,</span> <span class="pre">ensure</span> <span class="pre">you</span> <span class="pre">understand</span> <span class="pre">how</span> <span class="pre">this</span> <span class="pre">variable</span> <span class="pre">works</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">whole</span> <span class="pre">system.\n4.</span> <span class="pre">**Peer</span> <span class="pre">Awareness**:</span> <span class="pre">This</span> <span class="pre">variable</span> <span class="pre">works</span> <span class="pre">together</span> <span class="pre">with</span> <span class="pre">Peer</span> <span class="pre">variables,</span> <span class="pre">ensure</span> <span class="pre">you</span> <span class="pre">are</span> <span class="pre">aware</span> <span class="pre">of</span> <span class="pre">their</span> <span class="pre">roles</span> <span class="pre">and</span> <span class="pre">constraints.\n5.</span> <span class="pre">**Batch</span> <span class="pre">Awareness**:</span> <span class="pre">You</span> <span class="pre">are</span> <span class="pre">optimizing</span> <span class="pre">a</span> <span class="pre">batch</span> <span class="pre">of</span> <span class="pre">input</span> <span class="pre">data,</span> <span class="pre">ensure</span> <span class="pre">the</span> <span class="pre">change</span> <span class="pre">applys</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">whole</span> <span class="pre">batch</span> <span class="pre">(except</span> <span class="pre">while</span> <span class="pre">using</span> <span class="pre">demonstration.)\n\n{{output_format_str}}\n\n{%</span> <span class="pre">if</span> <span class="pre">instruction_to_optimizer</span> <span class="pre">%}\n**Additional</span> <span class="pre">User</span> <span class="pre">Instructions**:</span> <span class="pre">{{instruction_to_optimizer}}\n{%</span> <span class="pre">endif</span> <span class="pre">%}\n'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_context_examples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_past_history</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_failed_proposals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps_from_last_improvement</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_parameter_at_a_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/text_grad/tgd_optimizer.html#TGDOptimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.TGDOptimizer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TextOptimizer</span></code></p>
<p>Textual Gradient Descent(LLM) optimizer for text-based variables.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="optim.TGDOptimizer.proposing">
<span class="sig-name descname"><span class="pre">proposing</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#optim.TGDOptimizer.proposing" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.TGDOptimizer.params_history">
<span class="sig-name descname"><span class="pre">params_history</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="optim.text_grad.tgd_optimizer.html#optim.text_grad.tgd_optimizer.HistoryPrompt" title="optim.text_grad.tgd_optimizer.HistoryPrompt"><span class="pre">HistoryPrompt</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#optim.TGDOptimizer.params_history" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.TGDOptimizer.failed_proposals">
<span class="sig-name descname"><span class="pre">failed_proposals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="optim.text_grad.tgd_optimizer.html#optim.text_grad.tgd_optimizer.HistoryPrompt" title="optim.text_grad.tgd_optimizer.HistoryPrompt"><span class="pre">HistoryPrompt</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#optim.TGDOptimizer.failed_proposals" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.TGDOptimizer.current_tgd_output">
<span class="sig-name descname"><span class="pre">current_tgd_output</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="optim.text_grad.tgd_optimizer.html#optim.text_grad.tgd_optimizer.TGDData" title="optim.text_grad.tgd_optimizer.TGDData"><span class="pre">TGDData</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#optim.TGDOptimizer.current_tgd_output" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.TGDOptimizer.params">
<span class="sig-name descname"><span class="pre">params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Parameter</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#optim.TGDOptimizer.params" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.TGDOptimizer.constraints">
<span class="sig-name descname"><span class="pre">constraints</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#optim.TGDOptimizer.constraints" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.TGDOptimizer.one_parameter_at_a_time">
<span class="sig-name descname"><span class="pre">one_parameter_at_a_time</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#optim.TGDOptimizer.one_parameter_at_a_time" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="optim.TGDOptimizer.constraint_text">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">constraint_text</span></span><a class="headerlink" href="#optim.TGDOptimizer.constraint_text" title="Link to this definition">¶</a></dt>
<dd><p>Returns a formatted string representation of the constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A string containing the constraints in the format “Constraint {index}: {constraint}”.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.TGDOptimizer.increment_steps_from_last_improvement">
<span class="sig-name descname"><span class="pre">increment_steps_from_last_improvement</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/text_grad/tgd_optimizer.html#TGDOptimizer.increment_steps_from_last_improvement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.TGDOptimizer.increment_steps_from_last_improvement" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.TGDOptimizer.reset_steps_from_last_improvement">
<span class="sig-name descname"><span class="pre">reset_steps_from_last_improvement</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/text_grad/tgd_optimizer.html#TGDOptimizer.reset_steps_from_last_improvement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.TGDOptimizer.reset_steps_from_last_improvement" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.TGDOptimizer.add_score_to_params">
<span class="sig-name descname"><span class="pre">add_score_to_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val_score</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/text_grad/tgd_optimizer.html#TGDOptimizer.add_score_to_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.TGDOptimizer.add_score_to_params" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.TGDOptimizer.add_score_to_current_param">
<span class="sig-name descname"><span class="pre">add_score_to_current_param</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Parameter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/text_grad/tgd_optimizer.html#TGDOptimizer.add_score_to_current_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.TGDOptimizer.add_score_to_current_param" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.TGDOptimizer.add_history">
<span class="sig-name descname"><span class="pre">add_history</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">history</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="optim.text_grad.tgd_optimizer.html#optim.text_grad.tgd_optimizer.HistoryPrompt" title="optim.text_grad.tgd_optimizer.HistoryPrompt"><span class="pre">HistoryPrompt</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/text_grad/tgd_optimizer.html#TGDOptimizer.add_history"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.TGDOptimizer.add_history" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.TGDOptimizer.render_history">
<span class="sig-name descname"><span class="pre">render_history</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/optim/text_grad/tgd_optimizer.html#TGDOptimizer.render_history"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.TGDOptimizer.render_history" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.TGDOptimizer.add_failed_proposal">
<span class="sig-name descname"><span class="pre">add_failed_proposal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/text_grad/tgd_optimizer.html#TGDOptimizer.add_failed_proposal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.TGDOptimizer.add_failed_proposal" title="Link to this definition">¶</a></dt>
<dd><p>Save a copy of the current value of the parameter in the failed proposals.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.TGDOptimizer.render_failed_proposals">
<span class="sig-name descname"><span class="pre">render_failed_proposals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/optim/text_grad/tgd_optimizer.html#TGDOptimizer.render_failed_proposals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.TGDOptimizer.render_failed_proposals" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.TGDOptimizer.update_gradient_memory">
<span class="sig-name descname"><span class="pre">update_gradient_memory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Parameter</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/text_grad/tgd_optimizer.html#TGDOptimizer.update_gradient_memory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.TGDOptimizer.update_gradient_memory" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.TGDOptimizer.zero_grad">
<span class="sig-name descname"><span class="pre">zero_grad</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/text_grad/tgd_optimizer.html#TGDOptimizer.zero_grad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.TGDOptimizer.zero_grad" title="Link to this definition">¶</a></dt>
<dd><p>Clear all the gradients of the parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.TGDOptimizer.set_target_param">
<span class="sig-name descname"><span class="pre">set_target_param</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/text_grad/tgd_optimizer.html#TGDOptimizer.set_target_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.TGDOptimizer.set_target_param" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.TGDOptimizer.propose">
<span class="sig-name descname"><span class="pre">propose</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/text_grad/tgd_optimizer.html#TGDOptimizer.propose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.TGDOptimizer.propose" title="Link to this definition">¶</a></dt>
<dd><p>Proposing a value while keeping previous value saved on parameter.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.TGDOptimizer.revert">
<span class="sig-name descname"><span class="pre">revert</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/text_grad/tgd_optimizer.html#TGDOptimizer.revert"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.TGDOptimizer.revert" title="Link to this definition">¶</a></dt>
<dd><p>Revert to the previous value when the evaluation is worse.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.TGDOptimizer.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/text_grad/tgd_optimizer.html#TGDOptimizer.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.TGDOptimizer.step" title="Link to this definition">¶</a></dt>
<dd><p>Discard the previous value and keep the proposed value.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.TGDOptimizer.to_dict">
<span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/text_grad/tgd_optimizer.html#TGDOptimizer.to_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.TGDOptimizer.to_dict" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="optim.EvalFnToTextLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">EvalFnToTextLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eval_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">BaseEvaluator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_fn_desc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backward_engine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../core/core.generator.html#core.generator.BackwardEngine" title="core.generator.BackwardEngine"><span class="pre">BackwardEngine</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_client</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../core/core.model_client.html#core.model_client.ModelClient" title="core.model_client.ModelClient"><span class="pre">ModelClient</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/text_grad/text_loss_with_eval_fn.html#EvalFnToTextLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.EvalFnToTextLoss" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">LossComponent</span></code></p>
<p>Convert an evaluation function to a text loss.</p>
<p>LossComponent will take an eval function and output a score
(usually a float in range [0, 1], and the higher the better, unlike the loss function in model training).</p>
<p>In math:</p>
<p>score/loss = eval_fn(y_pred, y_gt)</p>
<p>The gradident/feedback = d(score)/d(y_pred) will be computed using a backward engine.
Gradient_context = GradientContext(</p>
<blockquote>
<div><p>context=conversation_str,
response_desc=response.role_desc,
variable_desc=role_desc,</p>
</div></blockquote>
<p>)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eval_fn</strong> – The evaluation function that takes a pair of y and y_gt and returns a score.</p></li>
<li><p><strong>eval_fn_desc</strong> – Description of the evaluation function.</p></li>
<li><p><strong>backward_engine</strong> – The backward engine to use for the text prompt optimization.</p></li>
<li><p><strong>model_client</strong> – The model client to use for the backward engine if backward_engine is not provided.</p></li>
<li><p><strong>model_kwargs</strong> – The model kwargs to use for the backward engine if backward_engine is not provided.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="optim.EvalFnToTextLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Parameter</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">response_desc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Parameter</span></span></span><a class="reference internal" href="../../_modules/optim/text_grad/text_loss_with_eval_fn.html#EvalFnToTextLoss.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.EvalFnToTextLoss.forward" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kwargs</strong> – The inputs to the eval_fn.</p></li>
<li><p><strong>response_desc</strong> – Description of the output.</p></li>
<li><p><strong>metadata</strong> – Additional notes on the input kwargs.</p></li>
<li><p><strong>id</strong> – The unique identifier for the data point.</p></li>
<li><p><strong>gt</strong> – The ground truth for the evaluation function.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.EvalFnToTextLoss.set_backward_engine">
<span class="sig-name descname"><span class="pre">set_backward_engine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">backward_engine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../core/core.generator.html#core.generator.BackwardEngine" title="core.generator.BackwardEngine"><span class="pre">BackwardEngine</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_client</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../core/core.model_client.html#core.model_client.ModelClient" title="core.model_client.ModelClient"><span class="pre">ModelClient</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/text_grad/text_loss_with_eval_fn.html#EvalFnToTextLoss.set_backward_engine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.EvalFnToTextLoss.set_backward_engine" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.EvalFnToTextLoss.backward">
<span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">response</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Parameter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_fn_desc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Parameter</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ground_truth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backward_engine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../core/core.generator.html#core.generator.BackwardEngine" title="core.generator.BackwardEngine"><span class="pre">BackwardEngine</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable_backward_engine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/text_grad/text_loss_with_eval_fn.html#EvalFnToTextLoss.backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.EvalFnToTextLoss.backward" title="Link to this definition">¶</a></dt>
<dd><p>Ensure to set backward_engine for the text prompt optimization. It can be None if you
are only doing demo optimization and it will not have gradients but simply backpropagate the score.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="optim.LLMAsTextLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LLMAsTextLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prompt_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#optim.Parameter" title="optim.Parameter"><span class="pre">Parameter</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_client</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../core/core.model_client.html#core.model_client.ModelClient" title="core.model_client.ModelClient"><span class="pre">ModelClient</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/text_grad/llm_text_loss.html#LLMAsTextLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.LLMAsTextLoss" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">LossComponent</span></code></p>
<p>Evaluate the final RAG response using an LLM judge.</p>
<p>The LLM judge will have:
- eval_system_prompt: The system prompt to evaluate the response.
- y_hat: The response to evaluate.
- Optional: y: The correct response to compare against.</p>
<p>The loss will be a Parameter with the evaluation result and can be used to compute gradients.
This loss use LLM/Generator as the computation/transformation operator, so it’s gradient will be
found from the Generator’s backward method.</p>
<dl class="py method">
<dt class="sig sig-object py" id="optim.LLMAsTextLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#optim.Parameter" title="optim.Parameter"><span class="pre">Parameter</span></a></span></span><a class="reference internal" href="../../_modules/optim/text_grad/llm_text_loss.html#LLMAsTextLoss.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.LLMAsTextLoss.forward" title="Link to this definition">¶</a></dt>
<dd><p>Default just wraps the call method.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="optim.Trainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Trainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adaltask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AdalComponent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'sequential'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'mix'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'sequential'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strategy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'random'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'constrained'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'constrained'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ckpt_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_val_score_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_val_score_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_error_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_correct_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_proposals_per_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_loader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw_shots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_shots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted_sampling</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_input_fields_from_bootstrap_demos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_traces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequential_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['text',</span> <span class="pre">'demo']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_subset_val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable_backward_gradients</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable_backward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_optimizers_config_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/trainer/trainer.html#Trainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Trainer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></p>
<p>Ready to use trainer for LLM task pipeline to optimize all types of parameters.</p>
<p>Training set: can be used for passing initial proposed prompt or for few-shot sampling.
Validation set: Will be used to select the final prompt or samples.
Test set: Will be used to evaluate the final prompt or samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adaltask</strong> – AdalComponent: AdalComponent instance</p></li>
<li><p><strong>strategy</strong> – Literal[“random”, “constrained”]: Strategy to use for the optimizer</p></li>
<li><p><strong>max_steps</strong> – int: Maximum number of steps to run the optimizer</p></li>
<li><p><strong>num_workers</strong> – int: Number of workers to use for parallel processing</p></li>
<li><p><strong>ckpt_path</strong> – str: Path to save the checkpoint files, default to ~/.adalflow/ckpt.</p></li>
<li><p><strong>batch_val_score_threshold</strong> – Optional[float]: Threshold for skipping a batch</p></li>
<li><p><strong>max_error_samples</strong> – Optional[int]: Maximum number of error samples to keep</p></li>
<li><p><strong>max_correct_samples</strong> – Optional[int]: Maximum number of correct samples to keep</p></li>
<li><p><strong>max_proposals_per_step</strong> – int: Maximum number of proposals to generate per step</p></li>
<li><p><strong>train_loader</strong> – Any: DataLoader instance for training</p></li>
<li><p><strong>train_dataset</strong> – Any: Training dataset</p></li>
<li><p><strong>val_dataset</strong> – Any: Validation dataset</p></li>
<li><p><strong>test_dataset</strong> – Any: Test dataset</p></li>
<li><p><strong>few_shots_config</strong> – Optional[FewShotConfig]: Few shot configuration</p></li>
<li><p><strong>save_traces</strong> – bool: Save traces for for synthetic data generation or debugging</p></li>
<li><p><strong>debug</strong> (<em>and for demo</em>) – bool: Debug mode to run the trainer in debug mode. If debug is True, for text debug, the graph will be under /ckpt/YourAdalComponentName/debug_text_grads for prompt parameter,</p></li>
<li><p><strong>debug</strong></p></li>
<li><p><strong>parameters.</strong> (<em>the graph will be under /ckpt/YourAdalComponentName/debug_demos for demo</em>)</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When you are in the debug mode, you can use get_logger api to show more detailed log on your own.</p>
<p>Example:</p>
<blockquote>
<div><p>from adalflow.utils import get_logger</p>
<p>get_logger(level=”DEBUG”)</p>
</div></blockquote>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Trainer.optimizer">
<span class="sig-name descname"><span class="pre">optimizer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optimizer</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.Trainer.optimizer" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Trainer.ckpt_file">
<span class="sig-name descname"><span class="pre">ckpt_file</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.Trainer.ckpt_file" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Trainer.random_seed">
<span class="sig-name descname"><span class="pre">random_seed</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.Trainer.random_seed" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Trainer.optimization_order">
<span class="sig-name descname"><span class="pre">optimization_order</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'sequential'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'mix'</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'sequential'</span></em><a class="headerlink" href="#optim.Trainer.optimization_order" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Trainer.strategy">
<span class="sig-name descname"><span class="pre">strategy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'random'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'constrained'</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#optim.Trainer.strategy" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Trainer.max_steps">
<span class="sig-name descname"><span class="pre">max_steps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#optim.Trainer.max_steps" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Trainer.ckpt_path">
<span class="sig-name descname"><span class="pre">ckpt_path</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.Trainer.ckpt_path" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Trainer.adaltask">
<span class="sig-name descname"><span class="pre">adaltask</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">AdalComponent</span></em><a class="headerlink" href="#optim.Trainer.adaltask" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Trainer.num_workers">
<span class="sig-name descname"><span class="pre">num_workers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></em><a class="headerlink" href="#optim.Trainer.num_workers" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Trainer.train_loader">
<span class="sig-name descname"><span class="pre">train_loader</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#optim.Trainer.train_loader" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Trainer.val_dataset">
<span class="sig-name descname"><span class="pre">val_dataset</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.Trainer.val_dataset" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Trainer.test_dataset">
<span class="sig-name descname"><span class="pre">test_dataset</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.Trainer.test_dataset" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Trainer.batch_val_score_threshold">
<span class="sig-name descname"><span class="pre">batch_val_score_threshold</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#optim.Trainer.batch_val_score_threshold" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Trainer.correct_val_score_threshold">
<span class="sig-name descname"><span class="pre">correct_val_score_threshold</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.5</span></em><a class="headerlink" href="#optim.Trainer.correct_val_score_threshold" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Trainer.max_error_samples">
<span class="sig-name descname"><span class="pre">max_error_samples</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#optim.Trainer.max_error_samples" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Trainer.max_correct_samples">
<span class="sig-name descname"><span class="pre">max_correct_samples</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#optim.Trainer.max_correct_samples" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Trainer.max_proposals_per_step">
<span class="sig-name descname"><span class="pre">max_proposals_per_step</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5</span></em><a class="headerlink" href="#optim.Trainer.max_proposals_per_step" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Trainer.train_batch_size">
<span class="sig-name descname"><span class="pre">train_batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></em><a class="headerlink" href="#optim.Trainer.train_batch_size" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Trainer.debug">
<span class="sig-name descname"><span class="pre">debug</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#optim.Trainer.debug" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Trainer.sequential_order">
<span class="sig-name descname"><span class="pre">sequential_order</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['text',</span> <span class="pre">'demo']</span></em><a class="headerlink" href="#optim.Trainer.sequential_order" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Trainer.skip_subset_val">
<span class="sig-name descname"><span class="pre">skip_subset_val</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#optim.Trainer.skip_subset_val" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Trainer.disable_backward_gradients">
<span class="sig-name descname"><span class="pre">disable_backward_gradients</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#optim.Trainer.disable_backward_gradients" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Trainer.disable_backward">
<span class="sig-name descname"><span class="pre">disable_backward</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#optim.Trainer.disable_backward" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Trainer.text_optimizers_config_kwargs">
<span class="sig-name descname"><span class="pre">text_optimizers_config_kwargs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#optim.Trainer.text_optimizers_config_kwargs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Trainer.set_random_seed">
<span class="sig-name descname"><span class="pre">set_random_seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/trainer/trainer.html#Trainer.set_random_seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Trainer.set_random_seed" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Trainer.diagnose">
<span class="sig-name descname"><span class="pre">diagnose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'train'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resume_from_ckpt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/trainer/trainer.html#Trainer.diagnose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Trainer.diagnose" title="Link to this definition">¶</a></dt>
<dd><p>Run an evaluation on the trainset to track all error response, and its raw response using AdaplComponent’s default configure_callbacks
:param dataset: Any: Dataset to evaluate
:param split: str: Split name, default to train and it is also used as set the directory name for saving the logs</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">trainset</span><span class="p">,</span> <span class="n">valset</span><span class="p">,</span> <span class="n">testset</span> <span class="o">=</span> <span class="n">load_datasets</span><span class="p">(</span><span class="n">max_samples</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">adaltask</span> <span class="o">=</span> <span class="n">TGDWithEvalFnLoss</span><span class="p">(</span>
    <span class="n">task_model_config</span><span class="o">=</span><span class="n">llama3_model</span><span class="p">,</span>
    <span class="n">backward_engine_model_config</span><span class="o">=</span><span class="n">llama3_model</span><span class="p">,</span>
    <span class="n">optimizer_model_config</span><span class="o">=</span><span class="n">llama3_model</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">adaltask</span><span class="o">=</span><span class="n">adaltask</span><span class="p">)</span>
<span class="n">diagnose</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">diagnose</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">trainset</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">diagnose</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Trainer.diagnose_report">
<span class="sig-name descname"><span class="pre">diagnose_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acc_score</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stats_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/trainer/trainer.html#Trainer.diagnose_report"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Trainer.diagnose_report" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Trainer.debug_report">
<span class="sig-name descname"><span class="pre">debug_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text_grad_debug_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">few_shot_demo_debug_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/trainer/trainer.html#Trainer.debug_report"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Trainer.debug_report" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Trainer.resume_params_from_ckpt">
<span class="sig-name descname"><span class="pre">resume_params_from_ckpt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpt_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/trainer/trainer.html#Trainer.resume_params_from_ckpt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Trainer.resume_params_from_ckpt" title="Link to this definition">¶</a></dt>
<dd><p>Resume the parameters from the checkpoint file</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Trainer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaltask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AdalComponent</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_loader</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_traces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw_shots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bootstrap_shots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resume_from_ckpt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backward_pass_setup</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BackwardPassSetup</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">TrainerResult</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/optim/trainer/trainer.html#Trainer.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Trainer.fit" title="Link to this definition">¶</a></dt>
<dd><p>train_loader: An iterable or collection of iterables specifying training samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Checkpoint file and the TrainerResult object</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[str, <a class="reference internal" href="optim.types.html#optim.types.TrainerResult" title="optim.types.TrainerResult">TrainerResult</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Trainer.initial_validation">
<span class="sig-name descname"><span class="pre">initial_validation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/trainer/trainer.html#Trainer.initial_validation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Trainer.initial_validation" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Trainer.gather_trainer_states">
<span class="sig-name descname"><span class="pre">gather_trainer_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/trainer/trainer.html#Trainer.gather_trainer_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Trainer.gather_trainer_states" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Trainer.prep_ckpt_file_path">
<span class="sig-name descname"><span class="pre">prep_ckpt_file_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/trainer/trainer.html#Trainer.prep_ckpt_file_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Trainer.prep_ckpt_file_path" title="Link to this definition">¶</a></dt>
<dd><p>Prepare the checkpoint root path: ~/.adalflow/ckpt/task_name/.</p>
<p>It also generates a unique checkpoint file name based on the strategy, max_steps, and a unique hash key.
For multiple runs but with the same adalcomponent + trainer setup, the run number will be incremented.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="optim.AdalComponent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AdalComponent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Component</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_eval_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LossComponent</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backward_engine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../core/core.generator.html#core.generator.BackwardEngine" title="core.generator.BackwardEngine"><span class="pre">BackwardEngine</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backward_engine_model_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">teacher_model_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_optimizer_model_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/trainer/adal.html#AdalComponent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.AdalComponent" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></p>
<p>Define a train, eval, and test step for a task pipeline.</p>
<p>This serves the following purposes:
1. Organize all parts for training a task pipeline in one place.
2. Help with debugging and testing before the actual training.
3. Adds multi-threading support for training and evaluation.</p>
<p>It has no need on call, forward, bicall, or __call__, so we need to overwrite the base ones.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="optim.AdalComponent.task">
<span class="sig-name descname"><span class="pre">task</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Component</span></em><a class="headerlink" href="#optim.AdalComponent.task" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.AdalComponent.eval_fn">
<span class="sig-name descname"><span class="pre">eval_fn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.AdalComponent.eval_fn" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.AdalComponent.loss_eval_fn">
<span class="sig-name descname"><span class="pre">loss_eval_fn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.AdalComponent.loss_eval_fn" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.AdalComponent.loss_fn">
<span class="sig-name descname"><span class="pre">loss_fn</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">LossComponent</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.AdalComponent.loss_fn" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.AdalComponent.backward_engine">
<span class="sig-name descname"><span class="pre">backward_engine</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="../core/core.generator.html#core.generator.BackwardEngine" title="core.generator.BackwardEngine"><span class="pre">BackwardEngine</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.AdalComponent.backward_engine" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.AdalComponent.prepare_task">
<span class="sig-name descname"><span class="pre">prepare_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/optim/trainer/adal.html#AdalComponent.prepare_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.AdalComponent.prepare_task" title="Link to this definition">¶</a></dt>
<dd><p>Tell Trainer how to call the task in both training and inference mode.</p>
<p>Return a task call and kwargs for one training sample.</p>
<p>If you just need to eval, ensure the Callable has the inference mode.
If you need to also train, ensure the Callable has the training mode which returns a Parameter and mainly
call forward for all subcomponents within the task.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">prepare_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sample</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="n">Dict</span><span class="p">]:</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">task</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">sample</span><span class="o">.</span><span class="n">x</span><span class="p">}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.AdalComponent.prepare_loss">
<span class="sig-name descname"><span class="pre">prepare_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#optim.Parameter" title="optim.Parameter"><span class="pre">Parameter</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/optim/trainer/adal.html#AdalComponent.prepare_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.AdalComponent.prepare_loss" title="Link to this definition">¶</a></dt>
<dd><p>Tell Trainer how to calculate the loss in the training mode.</p>
<p>Return a loss call and kwargs for one loss sample.</p>
<p>Need to ensure y_pred is a Parameter, and the real input to use
for y_gt and y_pred is <cite>eval_input</cite>.
Make sure it is setup.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># &quot;y&quot; and &quot;y_gt&quot; are arguments needed</span>
<span class="c1">#by the eval_fn inside of the loss_fn if it is a EvalFnToTextLoss</span>

<span class="k">def</span><span class="w"> </span><span class="nf">prepare_loss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sample</span><span class="p">:</span> <span class="n">Example</span><span class="p">,</span> <span class="n">pred</span><span class="p">:</span> <span class="n">adal</span><span class="o">.</span><span class="n">Parameter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
    <span class="c1"># prepare gt parameter</span>
    <span class="n">y_gt</span> <span class="o">=</span> <span class="n">adal</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;y_gt&quot;</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="n">sample</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span>
        <span class="n">eval_input</span><span class="o">=</span><span class="n">sample</span><span class="o">.</span><span class="n">answer</span><span class="p">,</span>
        <span class="n">requires_opt</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># pred&#39;s full_response is the output of the task pipeline which is GeneratorOutput</span>
    <span class="n">pred</span><span class="o">.</span><span class="n">eval_input</span> <span class="o">=</span> <span class="n">pred</span><span class="o">.</span><span class="n">full_response</span><span class="o">.</span><span class="n">data</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;kwargs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">y_gt</span><span class="p">,</span> <span class="s2">&quot;y_pred&quot;</span><span class="p">:</span> <span class="n">pred</span><span class="p">}}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.AdalComponent.prepare_eval">
<span class="sig-name descname"><span class="pre">prepare_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../../_modules/optim/trainer/adal.html#AdalComponent.prepare_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.AdalComponent.prepare_eval" title="Link to this definition">¶</a></dt>
<dd><p>Tell Trainer how to eval in inference mode.
Return the eval_fn and kwargs for one evaluation sample.</p>
<p>Ensure the eval_fn is a callable that takes the predicted output and the ground truth output.
Ensure the kwargs are setup correctly.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.AdalComponent.prepare_loss_eval">
<span class="sig-name descname"><span class="pre">prepare_loss_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../../_modules/optim/trainer/adal.html#AdalComponent.prepare_loss_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.AdalComponent.prepare_loss_eval" title="Link to this definition">¶</a></dt>
<dd><p>Tell Trainer how to eval in inference mode.
Return the eval_fn and kwargs for one evaluation sample.</p>
<p>Ensure the eval_fn is a callable that takes the predicted output and the ground truth output.
Ensure the kwargs are setup correctly.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.AdalComponent.configure_optimizers">
<span class="sig-name descname"><span class="pre">configure_optimizers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">text_optimizer_kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Optimizer</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/optim/trainer/adal.html#AdalComponent.configure_optimizers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.AdalComponent.configure_optimizers" title="Link to this definition">¶</a></dt>
<dd><p>Note: When you use text optimizor, ensure you call <cite>configure_backward_engine_engine</cite> too.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.AdalComponent.configure_backward_engine">
<span class="sig-name descname"><span class="pre">configure_backward_engine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/trainer/adal.html#AdalComponent.configure_backward_engine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.AdalComponent.configure_backward_engine" title="Link to this definition">¶</a></dt>
<dd><p>Configure a backward engine for all GradComponent in the task for bootstrapping examples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.AdalComponent.disable_backward_engine">
<span class="sig-name descname"><span class="pre">disable_backward_engine</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/trainer/adal.html#AdalComponent.disable_backward_engine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.AdalComponent.disable_backward_engine" title="Link to this definition">¶</a></dt>
<dd><p>Disable the backward engine for all GradComponent in the task.
No more gradients generation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.AdalComponent.evaluate_samples">
<span class="sig-name descname"><span class="pre">evaluate_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_preds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_loss_eval_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">EvaluationResult</span></span></span><a class="reference internal" href="../../_modules/optim/trainer/adal.html#AdalComponent.evaluate_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.AdalComponent.evaluate_samples" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate predictions against the ground truth samples.
Run evaluation on samples using parallel processing. Utilizes <code class="docutils literal notranslate"><span class="pre">prepare_eval</span></code> defined by the user.</p>
<p>Metadata is used for storing context that you can find from generator input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>Any</em>) – The input samples to evaluate.</p></li>
<li><p><strong>y_preds</strong> (<em>List</em>) – The predicted outputs corresponding to each sample.</p></li>
<li><p><strong>metadata</strong> (<em>Optional</em><em>[</em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – Optional metadata dictionary.</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – Number of worker threads for parallel processing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An object containing the average score and per-item scores.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="../eval/eval.base.html#eval.base.EvaluationResult" title="eval.base.EvaluationResult">EvaluationResult</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.AdalComponent.pred_step">
<span class="sig-name descname"><span class="pre">pred_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">running_eval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_score</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_loss_eval_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#optim.Parameter" title="optim.Parameter"><span class="pre">Parameter</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/optim/trainer/adal.html#AdalComponent.pred_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.AdalComponent.pred_step" title="Link to this definition">¶</a></dt>
<dd><p>Applies to only the eval mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<em>Any</em>) – The input batch to predict.</p></li>
<li><p><strong>batch_idx</strong> (<em>int</em>) – The index of the batch.</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – Number of worker threads for parallel processing.</p></li>
<li><p><strong>running_eval</strong> – bool = False,</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The predicted outputs, the samples, and the scores.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[List[“Parameter”], List, Dict[int, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.AdalComponent.train_step">
<span class="sig-name descname"><span class="pre">train_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span></span></span><a class="reference internal" href="../../_modules/optim/trainer/adal.html#AdalComponent.train_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.AdalComponent.train_step" title="Link to this definition">¶</a></dt>
<dd><p>Run a training step and return the predicted outputs.
Likely a list of Parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.AdalComponent.validate_condition">
<span class="sig-name descname"><span class="pre">validate_condition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../../_modules/optim/trainer/adal.html#AdalComponent.validate_condition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.AdalComponent.validate_condition" title="Link to this definition">¶</a></dt>
<dd><p>In default, trainer will validate at every step.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.AdalComponent.validation_step">
<span class="sig-name descname"><span class="pre">validation_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimum_score</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_loss_eval_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">EvaluationResult</span></span></span><a class="reference internal" href="../../_modules/optim/trainer/adal.html#AdalComponent.validation_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.AdalComponent.validation_step" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> (<em>Any</em>) – The input batch to validate, can be a whole dataset</p></li>
<li><p><strong>batch_idx</strong> (<em>int</em>) – The index of the batch. or current_step</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – Number of worker threads for parallel processing.</p></li>
<li><p><strong>minimum_score</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – The max potential score needs to be larger than this to continue evaluating.</p></li>
</ul>
</dd>
</dl>
<p>Evaluate a batch or the validate dataset by setting the batch=val_dataset.
Uses self.eval_fn to evaluate the samples.
If you require self.task.eval() to be called before validation, you can override this method as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">validation_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="n">num_workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">validation_step</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="n">num_workers</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.AdalComponent.loss_step">
<span class="sig-name descname"><span class="pre">loss_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_preds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#optim.Parameter" title="optim.Parameter"><span class="pre">Parameter</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#optim.Parameter" title="optim.Parameter"><span class="pre">Parameter</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/optim/trainer/adal.html#AdalComponent.loss_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.AdalComponent.loss_step" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the loss for the batch.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.AdalComponent.configure_teacher_generator">
<span class="sig-name descname"><span class="pre">configure_teacher_generator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/trainer/adal.html#AdalComponent.configure_teacher_generator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.AdalComponent.configure_teacher_generator" title="Link to this definition">¶</a></dt>
<dd><p>Configure a teach generator for all generators in the task for bootstrapping examples.</p>
<p>You can call <cite>configure_teacher_generator_helper</cite> to easily configure it by passing the model_client and model_kwargs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.AdalComponent.configure_teacher_generator_helper">
<span class="sig-name descname"><span class="pre">configure_teacher_generator_helper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_client</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../core/core.model_client.html#core.model_client.ModelClient" title="core.model_client.ModelClient"><span class="pre">ModelClient</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/trainer/adal.html#AdalComponent.configure_teacher_generator_helper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.AdalComponent.configure_teacher_generator_helper" title="Link to this definition">¶</a></dt>
<dd><p>Configure a teach generator for all generators in the task for bootstrapping examples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.AdalComponent.disable_backward_engine_helper">
<span class="sig-name descname"><span class="pre">disable_backward_engine_helper</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/trainer/adal.html#AdalComponent.disable_backward_engine_helper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.AdalComponent.disable_backward_engine_helper" title="Link to this definition">¶</a></dt>
<dd><p>Disable the backward engine for all gradcomponents in the task.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.AdalComponent.configure_backward_engine_helper">
<span class="sig-name descname"><span class="pre">configure_backward_engine_helper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_client</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../core/core.model_client.html#core.model_client.ModelClient" title="core.model_client.ModelClient"><span class="pre">ModelClient</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backward_pass_setup</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BackwardPassSetup</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/trainer/adal.html#AdalComponent.configure_backward_engine_helper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.AdalComponent.configure_backward_engine_helper" title="Link to this definition">¶</a></dt>
<dd><p>Configure a backward engine for all generators in the task for bootstrapping examples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.AdalComponent.configure_callbacks">
<span class="sig-name descname"><span class="pre">configure_callbacks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'traces'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/optim/trainer/adal.html#AdalComponent.configure_callbacks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.AdalComponent.configure_callbacks" title="Link to this definition">¶</a></dt>
<dd><p>In default we config the failure generator callback. User can overwrite this method to add more callbacks.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.AdalComponent.run_one_task_sample">
<span class="sig-name descname"><span class="pre">run_one_task_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../../_modules/optim/trainer/adal.html#AdalComponent.run_one_task_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.AdalComponent.run_one_task_sample" title="Link to this definition">¶</a></dt>
<dd><p>Run one training sample. Used for debugging and testing.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.AdalComponent.run_one_loss_sample">
<span class="sig-name descname"><span class="pre">run_one_loss_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../../_modules/optim/trainer/adal.html#AdalComponent.run_one_loss_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.AdalComponent.run_one_loss_sample" title="Link to this definition">¶</a></dt>
<dd><p>Run one loss sample. Used for debugging and testing.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.AdalComponent.configure_demo_optimizer_helper">
<span class="sig-name descname"><span class="pre">configure_demo_optimizer_helper</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">DemoOptimizer</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/optim/trainer/adal.html#AdalComponent.configure_demo_optimizer_helper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.AdalComponent.configure_demo_optimizer_helper" title="Link to this definition">¶</a></dt>
<dd><p>One demo optimizer can handle multiple demo parameters.
But the demo optimizer will only have one dataset (trainset) configured by the Trainer.</p>
<p>If users want to use different trainset for different demo optimizer,
they can configure it by themselves.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.AdalComponent.configure_text_optimizer_helper">
<span class="sig-name descname"><span class="pre">configure_text_optimizer_helper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_client</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../core/core.model_client.html#core.model_client.ModelClient" title="core.model_client.ModelClient"><span class="pre">ModelClient</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">TextOptimizer</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../_modules/optim/trainer/adal.html#AdalComponent.configure_text_optimizer_helper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.AdalComponent.configure_text_optimizer_helper" title="Link to this definition">¶</a></dt>
<dd><p>Text optimizer hands prompt parameter type. One text optimizer can handle multiple text parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.AdalComponent.bicall">
<span class="sig-name descname"><span class="pre">bicall</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/trainer/adal.html#AdalComponent.bicall"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.AdalComponent.bicall" title="Link to this definition">¶</a></dt>
<dd><p>If the user provides a <cite>bicall</cite> method, then <cite>__call__</cite> will automatically
dispatch here for both training and inference scenarios. This can internally
decide how to handle training vs. inference, or just produce a single unified
output type.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.AdalComponent.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/trainer/adal.html#AdalComponent.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.AdalComponent.call" title="Link to this definition">¶</a></dt>
<dd><p>User must override this for the inference scenario
if bicall is not defined.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.AdalComponent.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/trainer/adal.html#AdalComponent.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.AdalComponent.forward" title="Link to this definition">¶</a></dt>
<dd><p>User must override this for the training scenario
if bicall is not defined.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="optim.DemoOptimizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DemoOptimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weighted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">DataClass</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_input_fields_from_bootstrap_demos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/optimizer.html#DemoOptimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.DemoOptimizer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="optim.optimizer.html#optim.optimizer.Optimizer" title="optim.optimizer.Optimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Optimizer</span></code></a></p>
<p>Base class for all demo optimizers.</p>
<p>Demo optimizer are few-shot optimization, where it will sample raw examples from train dataset or bootstrap examples from the model’s output.
It will work with a sampler to generate new values for a given text prompt.</p>
<p>If bootstrap is used, it will require a teacher genearator to generate the examples.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="optim.DemoOptimizer.dataset">
<span class="sig-name descname"><span class="pre">dataset</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">DataClass</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#optim.DemoOptimizer.dataset" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.DemoOptimizer.exclude_input_fields_from_bootstrap_demos">
<span class="sig-name descname"><span class="pre">exclude_input_fields_from_bootstrap_demos</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#optim.DemoOptimizer.exclude_input_fields_from_bootstrap_demos" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.DemoOptimizer.use_weighted_sampling">
<span class="sig-name descname"><span class="pre">use_weighted_sampling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weighted</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/optimizer.html#DemoOptimizer.use_weighted_sampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.DemoOptimizer.use_weighted_sampling" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.DemoOptimizer.config_shots">
<span class="sig-name descname"><span class="pre">config_shots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/optimizer.html#DemoOptimizer.config_shots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.DemoOptimizer.config_shots" title="Link to this definition">¶</a></dt>
<dd><p>Initialize the samples for each parameter.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.DemoOptimizer.set_dataset">
<span class="sig-name descname"><span class="pre">set_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">DataClass</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/optimizer.html#DemoOptimizer.set_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.DemoOptimizer.set_dataset" title="Link to this definition">¶</a></dt>
<dd><p>Set the dataset for the optimizer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.DemoOptimizer.add_scores">
<span class="sig-name descname"><span class="pre">add_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/optimizer.html#DemoOptimizer.add_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.DemoOptimizer.add_scores" title="Link to this definition">¶</a></dt>
<dd><p>Add scores to the optimizer.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="optim.TextOptimizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TextOptimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/optimizer.html#TextOptimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.TextOptimizer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="optim.optimizer.html#optim.optimizer.Optimizer" title="optim.optimizer.Optimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Optimizer</span></code></a></p>
<p>Base class for all text optimizers.</p>
<p>Text optimizer is via textual gradient descent, which is a variant of gradient descent that optimizes the text directly.
It will generate new values for a given text prompt.This includes:
- System prompt
- output format
- prompt template</p>
<dl class="py method">
<dt class="sig sig-object py" id="optim.TextOptimizer.zero_grad">
<span class="sig-name descname"><span class="pre">zero_grad</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/optimizer.html#TextOptimizer.zero_grad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.TextOptimizer.zero_grad" title="Link to this definition">¶</a></dt>
<dd><p>Clear all the gradients of the parameters.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="optim.Gradient">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_response</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#optim.Parameter" title="optim.Parameter"><span class="pre">Parameter</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#optim.Parameter" title="optim.Parameter"><span class="pre">Parameter</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/gradient.html#Gradient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Gradient" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">DataClass</span></code></p>
<p>It will handle gradients and feedbacks.</p>
<p>It tracks the d_from_response_id / d_to_pred_id and the score of the whole response.</p>
<p>if two gradients have the same data_id, different from_response_id, and same from_response_component_id, this is a cycle component structure.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Gradient.context">
<span class="sig-name descname"><span class="pre">context</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="optim.gradient.html#optim.gradient.GradientContext" title="optim.gradient.GradientContext"><span class="pre">GradientContext</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.Gradient.context" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Gradient.prompt">
<span class="sig-name descname"><span class="pre">prompt</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.Gradient.prompt" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Gradient.is_default_copy">
<span class="sig-name descname"><span class="pre">is_default_copy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#optim.Gradient.is_default_copy" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Gradient.from_response_component_id">
<span class="sig-name descname"><span class="pre">from_response_component_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.Gradient.from_response_component_id" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Gradient.from_response_id">
<span class="sig-name descname"><span class="pre">from_response_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.Gradient.from_response_id" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Gradient.to_pred_id">
<span class="sig-name descname"><span class="pre">to_pred_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.Gradient.to_pred_id" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Gradient.score">
<span class="sig-name descname"><span class="pre">score</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.Gradient.score" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Gradient.data_id">
<span class="sig-name descname"><span class="pre">data_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.Gradient.data_id" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Gradient.data">
<span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.Gradient.data" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.Gradient.order">
<span class="sig-name descname"><span class="pre">order</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#optim.Gradient.order" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Gradient.add_context">
<span class="sig-name descname"><span class="pre">add_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="optim.gradient.html#optim.gradient.GradientContext" title="optim.gradient.GradientContext"><span class="pre">GradientContext</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/gradient.html#Gradient.add_context"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Gradient.add_context" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Gradient.add_data">
<span class="sig-name descname"><span class="pre">add_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/gradient.html#Gradient.add_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Gradient.add_data" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Gradient.update_from_to">
<span class="sig-name descname"><span class="pre">update_from_to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">from_response</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#optim.Parameter" title="optim.Parameter"><span class="pre">Parameter</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#optim.Parameter" title="optim.Parameter"><span class="pre">Parameter</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/gradient.html#Gradient.update_from_to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Gradient.update_from_to" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="optim.Gradient.add_prompt">
<span class="sig-name descname"><span class="pre">add_prompt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prompt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/gradient.html#Gradient.add_prompt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.Gradient.add_prompt" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="optim.GradientContext">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GradientContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_desc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">response_desc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/optim/gradient.html#GradientContext"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#optim.GradientContext" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">DataClass</span></code></p>
<p>GradientContext is used to describe the component’s function and trace its input and output.</p>
<p>To get the component’s function desc, use GradientContext.to_yaml_signature()
To get the data: use instance.to_yaml()</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="optim.GradientContext.variable_desc">
<span class="sig-name descname"><span class="pre">variable_desc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#optim.GradientContext.variable_desc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.GradientContext.input_output">
<span class="sig-name descname"><span class="pre">input_output</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#optim.GradientContext.input_output" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="optim.GradientContext.response_desc">
<span class="sig-name descname"><span class="pre">response_desc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#optim.GradientContext.response_desc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="optim.parameter.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">parameter</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../eval/eval.g_eval.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">g_eval</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, SylphAI, Inc
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Optimization</a><ul>
<li><a class="reference internal" href="#base-classes-and-data-structures">Base Classes and Data Structures</a></li>
<li><a class="reference internal" href="#few-shot-optimizer">Few Shot Optimizer</a></li>
<li><a class="reference internal" href="#textual-gradient">Textual Gradient</a></li>
<li><a class="reference internal" href="#trainer-and-adalcomponent">Trainer and AdalComponent</a></li>
<li><a class="reference internal" href="#module-optim">Overview</a><ul>
<li><a class="reference internal" href="#optim.Optimizer"><code class="docutils literal notranslate"><span class="pre">Optimizer</span></code></a><ul>
<li><a class="reference internal" href="#optim.Optimizer.proposing"><code class="docutils literal notranslate"><span class="pre">Optimizer.proposing</span></code></a></li>
<li><a class="reference internal" href="#optim.Optimizer.params"><code class="docutils literal notranslate"><span class="pre">Optimizer.params</span></code></a></li>
<li><a class="reference internal" href="#optim.Optimizer.state_dict"><code class="docutils literal notranslate"><span class="pre">Optimizer.state_dict()</span></code></a></li>
<li><a class="reference internal" href="#optim.Optimizer.propose"><code class="docutils literal notranslate"><span class="pre">Optimizer.propose()</span></code></a></li>
<li><a class="reference internal" href="#optim.Optimizer.step"><code class="docutils literal notranslate"><span class="pre">Optimizer.step()</span></code></a></li>
<li><a class="reference internal" href="#optim.Optimizer.revert"><code class="docutils literal notranslate"><span class="pre">Optimizer.revert()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#optim.RandomSampler"><code class="docutils literal notranslate"><span class="pre">RandomSampler</span></code></a><ul>
<li><a class="reference internal" href="#optim.RandomSampler.set_dataset"><code class="docutils literal notranslate"><span class="pre">RandomSampler.set_dataset()</span></code></a></li>
<li><a class="reference internal" href="#optim.RandomSampler.random_replace"><code class="docutils literal notranslate"><span class="pre">RandomSampler.random_replace()</span></code></a></li>
<li><a class="reference internal" href="#optim.RandomSampler.random_sample"><code class="docutils literal notranslate"><span class="pre">RandomSampler.random_sample()</span></code></a></li>
<li><a class="reference internal" href="#optim.RandomSampler.call"><code class="docutils literal notranslate"><span class="pre">RandomSampler.call()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#optim.ClassSampler"><code class="docutils literal notranslate"><span class="pre">ClassSampler</span></code></a><ul>
<li><a class="reference internal" href="#optim.ClassSampler.random_replace"><code class="docutils literal notranslate"><span class="pre">ClassSampler.random_replace()</span></code></a></li>
<li><a class="reference internal" href="#optim.ClassSampler.random_sample"><code class="docutils literal notranslate"><span class="pre">ClassSampler.random_sample()</span></code></a></li>
<li><a class="reference internal" href="#optim.ClassSampler.call"><code class="docutils literal notranslate"><span class="pre">ClassSampler.call()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#optim.Sampler"><code class="docutils literal notranslate"><span class="pre">Sampler</span></code></a><ul>
<li><a class="reference internal" href="#optim.Sampler.dataset"><code class="docutils literal notranslate"><span class="pre">Sampler.dataset</span></code></a></li>
<li><a class="reference internal" href="#optim.Sampler.set_dataset"><code class="docutils literal notranslate"><span class="pre">Sampler.set_dataset()</span></code></a></li>
<li><a class="reference internal" href="#optim.Sampler.random_replace"><code class="docutils literal notranslate"><span class="pre">Sampler.random_replace()</span></code></a></li>
<li><a class="reference internal" href="#optim.Sampler.call"><code class="docutils literal notranslate"><span class="pre">Sampler.call()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#optim.Parameter"><code class="docutils literal notranslate"><span class="pre">Parameter</span></code></a><ul>
<li><a class="reference internal" href="#optim.Parameter.allowed_types"><code class="docutils literal notranslate"><span class="pre">Parameter.allowed_types</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.proposing"><code class="docutils literal notranslate"><span class="pre">Parameter.proposing</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.predecessors"><code class="docutils literal notranslate"><span class="pre">Parameter.predecessors</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.peers"><code class="docutils literal notranslate"><span class="pre">Parameter.peers</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.tgd_optimizer_trace"><code class="docutils literal notranslate"><span class="pre">Parameter.tgd_optimizer_trace</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.id"><code class="docutils literal notranslate"><span class="pre">Parameter.id</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.data_id"><code class="docutils literal notranslate"><span class="pre">Parameter.data_id</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.role_desc"><code class="docutils literal notranslate"><span class="pre">Parameter.role_desc</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.name"><code class="docutils literal notranslate"><span class="pre">Parameter.name</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.param_type"><code class="docutils literal notranslate"><span class="pre">Parameter.param_type</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.data"><code class="docutils literal notranslate"><span class="pre">Parameter.data</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.eval_input"><code class="docutils literal notranslate"><span class="pre">Parameter.eval_input</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.successor_map_fn"><code class="docutils literal notranslate"><span class="pre">Parameter.successor_map_fn</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.data_in_prompt"><code class="docutils literal notranslate"><span class="pre">Parameter.data_in_prompt</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.gt"><code class="docutils literal notranslate"><span class="pre">Parameter.gt</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.map_to_successor"><code class="docutils literal notranslate"><span class="pre">Parameter.map_to_successor()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.add_successor_map_fn"><code class="docutils literal notranslate"><span class="pre">Parameter.add_successor_map_fn()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.check_if_already_computed_gradient_respect_to"><code class="docutils literal notranslate"><span class="pre">Parameter.check_if_already_computed_gradient_respect_to()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.set_gt"><code class="docutils literal notranslate"><span class="pre">Parameter.set_gt()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.get_gt"><code class="docutils literal notranslate"><span class="pre">Parameter.get_gt()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.add_gradient"><code class="docutils literal notranslate"><span class="pre">Parameter.add_gradient()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.reset_gradients"><code class="docutils literal notranslate"><span class="pre">Parameter.reset_gradients()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.get_gradients_names"><code class="docutils literal notranslate"><span class="pre">Parameter.get_gradients_names()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.get_prompt_data"><code class="docutils literal notranslate"><span class="pre">Parameter.get_prompt_data()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.get_gradients_str"><code class="docutils literal notranslate"><span class="pre">Parameter.get_gradients_str()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.get_gradient_and_context_text"><code class="docutils literal notranslate"><span class="pre">Parameter.get_gradient_and_context_text()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.get_gradients_component_schema"><code class="docutils literal notranslate"><span class="pre">Parameter.get_gradients_component_schema()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.merge_gradients_for_cycle_components"><code class="docutils literal notranslate"><span class="pre">Parameter.merge_gradients_for_cycle_components()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.sort_gradients"><code class="docutils literal notranslate"><span class="pre">Parameter.sort_gradients()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.set_predecessors"><code class="docutils literal notranslate"><span class="pre">Parameter.set_predecessors()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.set_grad_fn"><code class="docutils literal notranslate"><span class="pre">Parameter.set_grad_fn()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.get_param_info"><code class="docutils literal notranslate"><span class="pre">Parameter.get_param_info()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.set_peers"><code class="docutils literal notranslate"><span class="pre">Parameter.set_peers()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.trace_optimizer"><code class="docutils literal notranslate"><span class="pre">Parameter.trace_optimizer()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.set_eval_fn_input"><code class="docutils literal notranslate"><span class="pre">Parameter.set_eval_fn_input()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.set_score"><code class="docutils literal notranslate"><span class="pre">Parameter.set_score()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.add_dataclass_to_trace"><code class="docutils literal notranslate"><span class="pre">Parameter.add_dataclass_to_trace()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.add_score_to_trace"><code class="docutils literal notranslate"><span class="pre">Parameter.add_score_to_trace()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.propose_data"><code class="docutils literal notranslate"><span class="pre">Parameter.propose_data()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.revert_data"><code class="docutils literal notranslate"><span class="pre">Parameter.revert_data()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.step_data"><code class="docutils literal notranslate"><span class="pre">Parameter.step_data()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.get_grad_fn"><code class="docutils literal notranslate"><span class="pre">Parameter.get_grad_fn()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.update_value"><code class="docutils literal notranslate"><span class="pre">Parameter.update_value()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.get_short_value"><code class="docutils literal notranslate"><span class="pre">Parameter.get_short_value()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.reset_all_gradients"><code class="docutils literal notranslate"><span class="pre">Parameter.reset_all_gradients()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.trace_graph"><code class="docutils literal notranslate"><span class="pre">Parameter.trace_graph()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.backward"><code class="docutils literal notranslate"><span class="pre">Parameter.backward()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.generate_node_html"><code class="docutils literal notranslate"><span class="pre">Parameter.generate_node_html()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.draw_interactive_html_graph"><code class="docutils literal notranslate"><span class="pre">Parameter.draw_interactive_html_graph()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.wrap_and_escape"><code class="docutils literal notranslate"><span class="pre">Parameter.wrap_and_escape()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.draw_graph"><code class="docutils literal notranslate"><span class="pre">Parameter.draw_graph()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.draw_output_subgraph"><code class="docutils literal notranslate"><span class="pre">Parameter.draw_output_subgraph()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.draw_component_subgraph"><code class="docutils literal notranslate"><span class="pre">Parameter.draw_component_subgraph()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.to_dict"><code class="docutils literal notranslate"><span class="pre">Parameter.to_dict()</span></code></a></li>
<li><a class="reference internal" href="#optim.Parameter.from_dict"><code class="docutils literal notranslate"><span class="pre">Parameter.from_dict()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#optim.OutputParameter"><code class="docutils literal notranslate"><span class="pre">OutputParameter</span></code></a><ul>
<li><a class="reference internal" href="#optim.OutputParameter.allowed_types"><code class="docutils literal notranslate"><span class="pre">OutputParameter.allowed_types</span></code></a></li>
<li><a class="reference internal" href="#optim.OutputParameter.component_trace"><code class="docutils literal notranslate"><span class="pre">OutputParameter.component_trace</span></code></a></li>
<li><a class="reference internal" href="#optim.OutputParameter.full_response"><code class="docutils literal notranslate"><span class="pre">OutputParameter.full_response</span></code></a></li>
<li><a class="reference internal" href="#optim.OutputParameter.trace_forward_pass"><code class="docutils literal notranslate"><span class="pre">OutputParameter.trace_forward_pass()</span></code></a></li>
<li><a class="reference internal" href="#optim.OutputParameter.trace_api_kwargs"><code class="docutils literal notranslate"><span class="pre">OutputParameter.trace_api_kwargs()</span></code></a></li>
<li><a class="reference internal" href="#optim.OutputParameter.to_dict"><code class="docutils literal notranslate"><span class="pre">OutputParameter.to_dict()</span></code></a></li>
<li><a class="reference internal" href="#optim.OutputParameter.from_dict"><code class="docutils literal notranslate"><span class="pre">OutputParameter.from_dict()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#optim.BackwardContext"><code class="docutils literal notranslate"><span class="pre">BackwardContext</span></code></a></li>
<li><a class="reference internal" href="#optim.BootstrapFewShot"><code class="docutils literal notranslate"><span class="pre">BootstrapFewShot</span></code></a><ul>
<li><a class="reference internal" href="#optim.BootstrapFewShot.add_scores"><code class="docutils literal notranslate"><span class="pre">BootstrapFewShot.add_scores()</span></code></a></li>
<li><a class="reference internal" href="#optim.BootstrapFewShot.config_shots"><code class="docutils literal notranslate"><span class="pre">BootstrapFewShot.config_shots()</span></code></a></li>
<li><a class="reference internal" href="#optim.BootstrapFewShot.config_dataset"><code class="docutils literal notranslate"><span class="pre">BootstrapFewShot.config_dataset()</span></code></a></li>
<li><a class="reference internal" href="#optim.BootstrapFewShot.num_shots"><code class="docutils literal notranslate"><span class="pre">BootstrapFewShot.num_shots</span></code></a></li>
<li><a class="reference internal" href="#optim.BootstrapFewShot.sample"><code class="docutils literal notranslate"><span class="pre">BootstrapFewShot.sample()</span></code></a></li>
<li><a class="reference internal" href="#optim.BootstrapFewShot.samples_to_str"><code class="docutils literal notranslate"><span class="pre">BootstrapFewShot.samples_to_str()</span></code></a></li>
<li><a class="reference internal" href="#optim.BootstrapFewShot.propose"><code class="docutils literal notranslate"><span class="pre">BootstrapFewShot.propose()</span></code></a></li>
<li><a class="reference internal" href="#optim.BootstrapFewShot.revert"><code class="docutils literal notranslate"><span class="pre">BootstrapFewShot.revert()</span></code></a></li>
<li><a class="reference internal" href="#optim.BootstrapFewShot.step"><code class="docutils literal notranslate"><span class="pre">BootstrapFewShot.step()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#optim.TGDOptimizer"><code class="docutils literal notranslate"><span class="pre">TGDOptimizer</span></code></a><ul>
<li><a class="reference internal" href="#optim.TGDOptimizer.proposing"><code class="docutils literal notranslate"><span class="pre">TGDOptimizer.proposing</span></code></a></li>
<li><a class="reference internal" href="#optim.TGDOptimizer.params_history"><code class="docutils literal notranslate"><span class="pre">TGDOptimizer.params_history</span></code></a></li>
<li><a class="reference internal" href="#optim.TGDOptimizer.failed_proposals"><code class="docutils literal notranslate"><span class="pre">TGDOptimizer.failed_proposals</span></code></a></li>
<li><a class="reference internal" href="#optim.TGDOptimizer.current_tgd_output"><code class="docutils literal notranslate"><span class="pre">TGDOptimizer.current_tgd_output</span></code></a></li>
<li><a class="reference internal" href="#optim.TGDOptimizer.params"><code class="docutils literal notranslate"><span class="pre">TGDOptimizer.params</span></code></a></li>
<li><a class="reference internal" href="#optim.TGDOptimizer.constraints"><code class="docutils literal notranslate"><span class="pre">TGDOptimizer.constraints</span></code></a></li>
<li><a class="reference internal" href="#optim.TGDOptimizer.one_parameter_at_a_time"><code class="docutils literal notranslate"><span class="pre">TGDOptimizer.one_parameter_at_a_time</span></code></a></li>
<li><a class="reference internal" href="#optim.TGDOptimizer.constraint_text"><code class="docutils literal notranslate"><span class="pre">TGDOptimizer.constraint_text</span></code></a></li>
<li><a class="reference internal" href="#optim.TGDOptimizer.increment_steps_from_last_improvement"><code class="docutils literal notranslate"><span class="pre">TGDOptimizer.increment_steps_from_last_improvement()</span></code></a></li>
<li><a class="reference internal" href="#optim.TGDOptimizer.reset_steps_from_last_improvement"><code class="docutils literal notranslate"><span class="pre">TGDOptimizer.reset_steps_from_last_improvement()</span></code></a></li>
<li><a class="reference internal" href="#optim.TGDOptimizer.add_score_to_params"><code class="docutils literal notranslate"><span class="pre">TGDOptimizer.add_score_to_params()</span></code></a></li>
<li><a class="reference internal" href="#optim.TGDOptimizer.add_score_to_current_param"><code class="docutils literal notranslate"><span class="pre">TGDOptimizer.add_score_to_current_param()</span></code></a></li>
<li><a class="reference internal" href="#optim.TGDOptimizer.add_history"><code class="docutils literal notranslate"><span class="pre">TGDOptimizer.add_history()</span></code></a></li>
<li><a class="reference internal" href="#optim.TGDOptimizer.render_history"><code class="docutils literal notranslate"><span class="pre">TGDOptimizer.render_history()</span></code></a></li>
<li><a class="reference internal" href="#optim.TGDOptimizer.add_failed_proposal"><code class="docutils literal notranslate"><span class="pre">TGDOptimizer.add_failed_proposal()</span></code></a></li>
<li><a class="reference internal" href="#optim.TGDOptimizer.render_failed_proposals"><code class="docutils literal notranslate"><span class="pre">TGDOptimizer.render_failed_proposals()</span></code></a></li>
<li><a class="reference internal" href="#optim.TGDOptimizer.update_gradient_memory"><code class="docutils literal notranslate"><span class="pre">TGDOptimizer.update_gradient_memory()</span></code></a></li>
<li><a class="reference internal" href="#optim.TGDOptimizer.zero_grad"><code class="docutils literal notranslate"><span class="pre">TGDOptimizer.zero_grad()</span></code></a></li>
<li><a class="reference internal" href="#optim.TGDOptimizer.set_target_param"><code class="docutils literal notranslate"><span class="pre">TGDOptimizer.set_target_param()</span></code></a></li>
<li><a class="reference internal" href="#optim.TGDOptimizer.propose"><code class="docutils literal notranslate"><span class="pre">TGDOptimizer.propose()</span></code></a></li>
<li><a class="reference internal" href="#optim.TGDOptimizer.revert"><code class="docutils literal notranslate"><span class="pre">TGDOptimizer.revert()</span></code></a></li>
<li><a class="reference internal" href="#optim.TGDOptimizer.step"><code class="docutils literal notranslate"><span class="pre">TGDOptimizer.step()</span></code></a></li>
<li><a class="reference internal" href="#optim.TGDOptimizer.to_dict"><code class="docutils literal notranslate"><span class="pre">TGDOptimizer.to_dict()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#optim.EvalFnToTextLoss"><code class="docutils literal notranslate"><span class="pre">EvalFnToTextLoss</span></code></a><ul>
<li><a class="reference internal" href="#optim.EvalFnToTextLoss.forward"><code class="docutils literal notranslate"><span class="pre">EvalFnToTextLoss.forward()</span></code></a></li>
<li><a class="reference internal" href="#optim.EvalFnToTextLoss.set_backward_engine"><code class="docutils literal notranslate"><span class="pre">EvalFnToTextLoss.set_backward_engine()</span></code></a></li>
<li><a class="reference internal" href="#optim.EvalFnToTextLoss.backward"><code class="docutils literal notranslate"><span class="pre">EvalFnToTextLoss.backward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#optim.LLMAsTextLoss"><code class="docutils literal notranslate"><span class="pre">LLMAsTextLoss</span></code></a><ul>
<li><a class="reference internal" href="#optim.LLMAsTextLoss.forward"><code class="docutils literal notranslate"><span class="pre">LLMAsTextLoss.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#optim.Trainer"><code class="docutils literal notranslate"><span class="pre">Trainer</span></code></a><ul>
<li><a class="reference internal" href="#optim.Trainer.optimizer"><code class="docutils literal notranslate"><span class="pre">Trainer.optimizer</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.ckpt_file"><code class="docutils literal notranslate"><span class="pre">Trainer.ckpt_file</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.random_seed"><code class="docutils literal notranslate"><span class="pre">Trainer.random_seed</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.optimization_order"><code class="docutils literal notranslate"><span class="pre">Trainer.optimization_order</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.strategy"><code class="docutils literal notranslate"><span class="pre">Trainer.strategy</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.max_steps"><code class="docutils literal notranslate"><span class="pre">Trainer.max_steps</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.ckpt_path"><code class="docutils literal notranslate"><span class="pre">Trainer.ckpt_path</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.adaltask"><code class="docutils literal notranslate"><span class="pre">Trainer.adaltask</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.num_workers"><code class="docutils literal notranslate"><span class="pre">Trainer.num_workers</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.train_loader"><code class="docutils literal notranslate"><span class="pre">Trainer.train_loader</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.val_dataset"><code class="docutils literal notranslate"><span class="pre">Trainer.val_dataset</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.test_dataset"><code class="docutils literal notranslate"><span class="pre">Trainer.test_dataset</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.batch_val_score_threshold"><code class="docutils literal notranslate"><span class="pre">Trainer.batch_val_score_threshold</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.correct_val_score_threshold"><code class="docutils literal notranslate"><span class="pre">Trainer.correct_val_score_threshold</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.max_error_samples"><code class="docutils literal notranslate"><span class="pre">Trainer.max_error_samples</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.max_correct_samples"><code class="docutils literal notranslate"><span class="pre">Trainer.max_correct_samples</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.max_proposals_per_step"><code class="docutils literal notranslate"><span class="pre">Trainer.max_proposals_per_step</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.train_batch_size"><code class="docutils literal notranslate"><span class="pre">Trainer.train_batch_size</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.debug"><code class="docutils literal notranslate"><span class="pre">Trainer.debug</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.sequential_order"><code class="docutils literal notranslate"><span class="pre">Trainer.sequential_order</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.skip_subset_val"><code class="docutils literal notranslate"><span class="pre">Trainer.skip_subset_val</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.disable_backward_gradients"><code class="docutils literal notranslate"><span class="pre">Trainer.disable_backward_gradients</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.disable_backward"><code class="docutils literal notranslate"><span class="pre">Trainer.disable_backward</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.text_optimizers_config_kwargs"><code class="docutils literal notranslate"><span class="pre">Trainer.text_optimizers_config_kwargs</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.set_random_seed"><code class="docutils literal notranslate"><span class="pre">Trainer.set_random_seed()</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.diagnose"><code class="docutils literal notranslate"><span class="pre">Trainer.diagnose()</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.diagnose_report"><code class="docutils literal notranslate"><span class="pre">Trainer.diagnose_report()</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.debug_report"><code class="docutils literal notranslate"><span class="pre">Trainer.debug_report()</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.resume_params_from_ckpt"><code class="docutils literal notranslate"><span class="pre">Trainer.resume_params_from_ckpt()</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.fit"><code class="docutils literal notranslate"><span class="pre">Trainer.fit()</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.initial_validation"><code class="docutils literal notranslate"><span class="pre">Trainer.initial_validation()</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.gather_trainer_states"><code class="docutils literal notranslate"><span class="pre">Trainer.gather_trainer_states()</span></code></a></li>
<li><a class="reference internal" href="#optim.Trainer.prep_ckpt_file_path"><code class="docutils literal notranslate"><span class="pre">Trainer.prep_ckpt_file_path()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#optim.AdalComponent"><code class="docutils literal notranslate"><span class="pre">AdalComponent</span></code></a><ul>
<li><a class="reference internal" href="#optim.AdalComponent.task"><code class="docutils literal notranslate"><span class="pre">AdalComponent.task</span></code></a></li>
<li><a class="reference internal" href="#optim.AdalComponent.eval_fn"><code class="docutils literal notranslate"><span class="pre">AdalComponent.eval_fn</span></code></a></li>
<li><a class="reference internal" href="#optim.AdalComponent.loss_eval_fn"><code class="docutils literal notranslate"><span class="pre">AdalComponent.loss_eval_fn</span></code></a></li>
<li><a class="reference internal" href="#optim.AdalComponent.loss_fn"><code class="docutils literal notranslate"><span class="pre">AdalComponent.loss_fn</span></code></a></li>
<li><a class="reference internal" href="#optim.AdalComponent.backward_engine"><code class="docutils literal notranslate"><span class="pre">AdalComponent.backward_engine</span></code></a></li>
<li><a class="reference internal" href="#optim.AdalComponent.prepare_task"><code class="docutils literal notranslate"><span class="pre">AdalComponent.prepare_task()</span></code></a></li>
<li><a class="reference internal" href="#optim.AdalComponent.prepare_loss"><code class="docutils literal notranslate"><span class="pre">AdalComponent.prepare_loss()</span></code></a></li>
<li><a class="reference internal" href="#optim.AdalComponent.prepare_eval"><code class="docutils literal notranslate"><span class="pre">AdalComponent.prepare_eval()</span></code></a></li>
<li><a class="reference internal" href="#optim.AdalComponent.prepare_loss_eval"><code class="docutils literal notranslate"><span class="pre">AdalComponent.prepare_loss_eval()</span></code></a></li>
<li><a class="reference internal" href="#optim.AdalComponent.configure_optimizers"><code class="docutils literal notranslate"><span class="pre">AdalComponent.configure_optimizers()</span></code></a></li>
<li><a class="reference internal" href="#optim.AdalComponent.configure_backward_engine"><code class="docutils literal notranslate"><span class="pre">AdalComponent.configure_backward_engine()</span></code></a></li>
<li><a class="reference internal" href="#optim.AdalComponent.disable_backward_engine"><code class="docutils literal notranslate"><span class="pre">AdalComponent.disable_backward_engine()</span></code></a></li>
<li><a class="reference internal" href="#optim.AdalComponent.evaluate_samples"><code class="docutils literal notranslate"><span class="pre">AdalComponent.evaluate_samples()</span></code></a></li>
<li><a class="reference internal" href="#optim.AdalComponent.pred_step"><code class="docutils literal notranslate"><span class="pre">AdalComponent.pred_step()</span></code></a></li>
<li><a class="reference internal" href="#optim.AdalComponent.train_step"><code class="docutils literal notranslate"><span class="pre">AdalComponent.train_step()</span></code></a></li>
<li><a class="reference internal" href="#optim.AdalComponent.validate_condition"><code class="docutils literal notranslate"><span class="pre">AdalComponent.validate_condition()</span></code></a></li>
<li><a class="reference internal" href="#optim.AdalComponent.validation_step"><code class="docutils literal notranslate"><span class="pre">AdalComponent.validation_step()</span></code></a></li>
<li><a class="reference internal" href="#optim.AdalComponent.loss_step"><code class="docutils literal notranslate"><span class="pre">AdalComponent.loss_step()</span></code></a></li>
<li><a class="reference internal" href="#optim.AdalComponent.configure_teacher_generator"><code class="docutils literal notranslate"><span class="pre">AdalComponent.configure_teacher_generator()</span></code></a></li>
<li><a class="reference internal" href="#optim.AdalComponent.configure_teacher_generator_helper"><code class="docutils literal notranslate"><span class="pre">AdalComponent.configure_teacher_generator_helper()</span></code></a></li>
<li><a class="reference internal" href="#optim.AdalComponent.disable_backward_engine_helper"><code class="docutils literal notranslate"><span class="pre">AdalComponent.disable_backward_engine_helper()</span></code></a></li>
<li><a class="reference internal" href="#optim.AdalComponent.configure_backward_engine_helper"><code class="docutils literal notranslate"><span class="pre">AdalComponent.configure_backward_engine_helper()</span></code></a></li>
<li><a class="reference internal" href="#optim.AdalComponent.configure_callbacks"><code class="docutils literal notranslate"><span class="pre">AdalComponent.configure_callbacks()</span></code></a></li>
<li><a class="reference internal" href="#optim.AdalComponent.run_one_task_sample"><code class="docutils literal notranslate"><span class="pre">AdalComponent.run_one_task_sample()</span></code></a></li>
<li><a class="reference internal" href="#optim.AdalComponent.run_one_loss_sample"><code class="docutils literal notranslate"><span class="pre">AdalComponent.run_one_loss_sample()</span></code></a></li>
<li><a class="reference internal" href="#optim.AdalComponent.configure_demo_optimizer_helper"><code class="docutils literal notranslate"><span class="pre">AdalComponent.configure_demo_optimizer_helper()</span></code></a></li>
<li><a class="reference internal" href="#optim.AdalComponent.configure_text_optimizer_helper"><code class="docutils literal notranslate"><span class="pre">AdalComponent.configure_text_optimizer_helper()</span></code></a></li>
<li><a class="reference internal" href="#optim.AdalComponent.bicall"><code class="docutils literal notranslate"><span class="pre">AdalComponent.bicall()</span></code></a></li>
<li><a class="reference internal" href="#optim.AdalComponent.call"><code class="docutils literal notranslate"><span class="pre">AdalComponent.call()</span></code></a></li>
<li><a class="reference internal" href="#optim.AdalComponent.forward"><code class="docutils literal notranslate"><span class="pre">AdalComponent.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#optim.DemoOptimizer"><code class="docutils literal notranslate"><span class="pre">DemoOptimizer</span></code></a><ul>
<li><a class="reference internal" href="#optim.DemoOptimizer.dataset"><code class="docutils literal notranslate"><span class="pre">DemoOptimizer.dataset</span></code></a></li>
<li><a class="reference internal" href="#optim.DemoOptimizer.exclude_input_fields_from_bootstrap_demos"><code class="docutils literal notranslate"><span class="pre">DemoOptimizer.exclude_input_fields_from_bootstrap_demos</span></code></a></li>
<li><a class="reference internal" href="#optim.DemoOptimizer.use_weighted_sampling"><code class="docutils literal notranslate"><span class="pre">DemoOptimizer.use_weighted_sampling()</span></code></a></li>
<li><a class="reference internal" href="#optim.DemoOptimizer.config_shots"><code class="docutils literal notranslate"><span class="pre">DemoOptimizer.config_shots()</span></code></a></li>
<li><a class="reference internal" href="#optim.DemoOptimizer.set_dataset"><code class="docutils literal notranslate"><span class="pre">DemoOptimizer.set_dataset()</span></code></a></li>
<li><a class="reference internal" href="#optim.DemoOptimizer.add_scores"><code class="docutils literal notranslate"><span class="pre">DemoOptimizer.add_scores()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#optim.TextOptimizer"><code class="docutils literal notranslate"><span class="pre">TextOptimizer</span></code></a><ul>
<li><a class="reference internal" href="#optim.TextOptimizer.zero_grad"><code class="docutils literal notranslate"><span class="pre">TextOptimizer.zero_grad()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#optim.Gradient"><code class="docutils literal notranslate"><span class="pre">Gradient</span></code></a><ul>
<li><a class="reference internal" href="#optim.Gradient.context"><code class="docutils literal notranslate"><span class="pre">Gradient.context</span></code></a></li>
<li><a class="reference internal" href="#optim.Gradient.prompt"><code class="docutils literal notranslate"><span class="pre">Gradient.prompt</span></code></a></li>
<li><a class="reference internal" href="#optim.Gradient.is_default_copy"><code class="docutils literal notranslate"><span class="pre">Gradient.is_default_copy</span></code></a></li>
<li><a class="reference internal" href="#optim.Gradient.from_response_component_id"><code class="docutils literal notranslate"><span class="pre">Gradient.from_response_component_id</span></code></a></li>
<li><a class="reference internal" href="#optim.Gradient.from_response_id"><code class="docutils literal notranslate"><span class="pre">Gradient.from_response_id</span></code></a></li>
<li><a class="reference internal" href="#optim.Gradient.to_pred_id"><code class="docutils literal notranslate"><span class="pre">Gradient.to_pred_id</span></code></a></li>
<li><a class="reference internal" href="#optim.Gradient.score"><code class="docutils literal notranslate"><span class="pre">Gradient.score</span></code></a></li>
<li><a class="reference internal" href="#optim.Gradient.data_id"><code class="docutils literal notranslate"><span class="pre">Gradient.data_id</span></code></a></li>
<li><a class="reference internal" href="#optim.Gradient.data"><code class="docutils literal notranslate"><span class="pre">Gradient.data</span></code></a></li>
<li><a class="reference internal" href="#optim.Gradient.order"><code class="docutils literal notranslate"><span class="pre">Gradient.order</span></code></a></li>
<li><a class="reference internal" href="#optim.Gradient.add_context"><code class="docutils literal notranslate"><span class="pre">Gradient.add_context()</span></code></a></li>
<li><a class="reference internal" href="#optim.Gradient.add_data"><code class="docutils literal notranslate"><span class="pre">Gradient.add_data()</span></code></a></li>
<li><a class="reference internal" href="#optim.Gradient.update_from_to"><code class="docutils literal notranslate"><span class="pre">Gradient.update_from_to()</span></code></a></li>
<li><a class="reference internal" href="#optim.Gradient.add_prompt"><code class="docutils literal notranslate"><span class="pre">Gradient.add_prompt()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#optim.GradientContext"><code class="docutils literal notranslate"><span class="pre">GradientContext</span></code></a><ul>
<li><a class="reference internal" href="#optim.GradientContext.variable_desc"><code class="docutils literal notranslate"><span class="pre">GradientContext.variable_desc</span></code></a></li>
<li><a class="reference internal" href="#optim.GradientContext.input_output"><code class="docutils literal notranslate"><span class="pre">GradientContext.input_output</span></code></a></li>
<li><a class="reference internal" href="#optim.GradientContext.response_desc"><code class="docutils literal notranslate"><span class="pre">GradientContext.response_desc</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../../_static/js/rtd_search_config.js"></script>
    <script src="../../_static/js/rtd_sphinx_search.min.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>