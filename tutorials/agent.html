
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Agent &#8212; AdalFlow: The Library to Build and Auto-Optimize LLM Task Pipelines</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=af51538a" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/rtd_sphinx_search.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../_static/js/rtd_search_config.js"></script>
    <script src="../_static/js/rtd_sphinx_search.min.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorials/agent';</script>
    <link rel="icon" href="../_static/LightRAG-logo-circle.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="LLM Evaluation" href="evaluation.html" />
    <link rel="prev" title="Function calls" href="tool_helper.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/adalflow-logo.png" class="logo__image only-light" alt="AdalFlow: The Library to Build and Auto-Optimize LLM Task Pipelines - Home"/>
    <script>document.write(`<img src="../_static/adalflow-logo.png" class="logo__image only-dark" alt="AdalFlow: The Library to Build and Auto-Optimize LLM Task Pipelines - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../get_started/index.html">
    Get Started
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../use_cases/index.html">
    Use Cases
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributor/index.html">
    Contributor Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../apis/index.html">
    API Reference
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/SylphAI-Inc/LightRAG" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://discord.gg/ezzszrRZvT" title="Discord" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-discord fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Discord</span></a>
        </li>
</ul></div>
      
        <div class="navbar-item">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../get_started/index.html">
    Get Started
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../use_cases/index.html">
    Use Cases
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributor/index.html">
    Contributor Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../apis/index.html">
    API Reference
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/SylphAI-Inc/LightRAG" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://discord.gg/ezzszrRZvT" title="Discord" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-discord fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Discord</span></a>
        </li>
</ul></div>
        
          <div class="navbar-item">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lightrag_design_philosophy.html">Design Philosophy</a></li>
<li class="toctree-l1"><a class="reference internal" href="class_hierarchy.html">Class Hierarchy</a></li>
<li class="toctree-l1"><a class="reference internal" href="trace_graph.html">AdalFlow Trace Graph</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Base Classes</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="component.html">Component</a></li>
<li class="toctree-l1"><a class="reference internal" href="base_data_class.html">DataClass</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">RAG Essentials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="prompt.html">Prompt</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_client.html">ModelClient</a></li>
<li class="toctree-l1"><a class="reference internal" href="generator.html">Generator</a></li>

<li class="toctree-l1"><a class="reference internal" href="output_parsers.html">Parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="embedder.html">Embedder</a></li>
<li class="toctree-l1"><a class="reference internal" href="retriever.html">Retriever</a></li>
<li class="toctree-l1"><a class="reference internal" href="text_splitter.html">Text Splitter</a></li>
<li class="toctree-l1"><a class="reference internal" href="db.html">Data (Database/Pipeline)</a></li>
<li class="toctree-l1"><a class="reference internal" href="rag_playbook.html">RAG Playbook</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Agent Essentials</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="tool_helper.html">Function calls</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Agent</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Evaluating</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="evaluation.html">LLM Evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="datasets.html">Datasets</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Logging &amp; Tracing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logger Example</a></li>


<li class="toctree-l1"><a class="reference internal" href="logging_tracing.html">Tracing</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Agent</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div style="display: flex; justify-content: flex-start; align-items: center; margin-bottom: 20px;">
   <a href="https://colab.research.google.com/drive/1mpocvG8lPyW1ISOK7SJ4bCt9KmQCP0SJ?usp=sharing" target="_blank" style="margin-right: 10px;">
      <img alt="Try Quickstart in Colab" src="https://colab.research.google.com/assets/colab-badge.svg" style="vertical-align: middle;">
   </a>
   <a href="https://github.com/SylphAI-Inc/AdalFlow/blob/main/tutorials/react_note.py" target="_blank" style="display: flex; align-items: center;">
      <img src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" alt="GitHub" style="height: 20px; width: 20px; margin-right: 5px;">
      <span style="vertical-align: middle;"> Open Source Code</span>
   </a>
</div><section id="agent">
<h1>Agent<a class="headerlink" href="#agent" title="Link to this heading">#</a></h1>
<blockquote class="epigraph">
<div><p>“An autonomous agent is a system situated within and a part of an environment that senses that environment and acts on it, over time, in pursuit of its own agenda and so as to effect what it senses in the future.”</p>
<p class="attribution">—Franklin and Graesser (1997)</p>
</div></blockquote>
<p>Alongside the well-known RAGs, agents <a class="footnote-reference brackets" href="#id3" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>  are another popular family of LLM applications.
What makes agents stand out is their ability to reason, plan, and act via accessible tools.
When it comes to implementation, AdalFlow has simplified it down to a generator that can use tools, taking multiple steps (sequential or parallel) to complete a user query.</p>
<section id="design">
<h2>Design<a class="headerlink" href="#design" title="Link to this heading">#</a></h2>
<p>We will first introduce ReAct <a class="footnote-reference brackets" href="#id4" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>, a general paradigm for building agents with a sequential of interleaving thought, action, and observation steps.</p>
<ul class="simple">
<li><p><strong>Thought</strong>: The reasoning behind taking an action.</p></li>
<li><p><strong>Action</strong>: The action to take from a predefined set of actions. In particular, these are the tools/functional tools we have introduced in <a class="reference internal" href="tool_helper.html"><span class="doc">tools</span></a>.</p></li>
<li><p><strong>Observation</strong>: The simplest scenario is the execution result of the action in string format. To be more robust, this can be defined in any way that provides the right amount of execution information for the LLM to plan the next step.</p></li>
</ul>
<section id="prompt-and-data-models">
<h3>Prompt and Data Models<a class="headerlink" href="#prompt-and-data-models" title="Link to this heading">#</a></h3>
<p><code class="xref py py-const docutils literal notranslate"><span class="pre">DEFAULT_REACT_AGENT_SYSTEM_PROMPT</span></code> is the default prompt for React agent’s LLM planner.
We can categorize the prompt template into four parts:</p>
<ol class="arabic simple">
<li><p>Task description</p></li>
</ol>
<p>This part is the overall role setup and task description for the agent.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">task_desc</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;&quot;&quot;You are a helpful assistant.</span>
<span class="s2">Answer the user&#39;s query using the tools provided below with minimal steps and maximum accuracy.</span>

<span class="s2">Each step you will read the previous Thought, Action, and Observation(execution result of the action) and then provide the next Thought and Action.&quot;&quot;&quot;</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Tools, output format, and example</p></li>
</ol>
<p>This part of the template is exactly the same as how we were calling functions in the <a class="reference internal" href="tool_helper.html"><span class="doc">tools</span></a>.
The <code class="docutils literal notranslate"><span class="pre">output_format_str</span></code> is generated by <code class="docutils literal notranslate"><span class="pre">FunctionExpression</span></code> via <code class="docutils literal notranslate"><span class="pre">JsonOutputParser</span></code>.
It includes the actual output format and examples of a list of <code class="docutils literal notranslate"><span class="pre">FunctionExpression</span></code> instances.
We use <code class="docutils literal notranslate"><span class="pre">thought</span></code> and <code class="docutils literal notranslate"><span class="pre">action</span></code> fields of the <code class="docutils literal notranslate"><span class="pre">FunctionExpression</span></code> as the agent’s response.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tools</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;&quot;&quot;{</span><span class="si">% i</span><span class="s2">f tools %}</span>
<span class="s2">&lt;TOOLS&gt;</span>
<span class="s2">{</span><span class="si">% f</span><span class="s2">or tool in tools %}</span>
<span class="s2">{{ loop.index }}.</span>
<span class="s2">{{tool}}</span>
<span class="s2">------------------------</span>
<span class="s2">{</span><span class="si">% e</span><span class="s2">ndfor %}</span>
<span class="s2">&lt;/TOOLS&gt;</span>
<span class="s2">{</span><span class="si">% e</span><span class="s2">ndif %}</span>
<span class="s2">{{output_format_str}}&quot;&quot;&quot;</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Task specification to teach the planner how to “think”.</p></li>
</ol>
<p>We provide more detailed instruction to ensure the agent will always end with ‘finish’ action to complete the task.
Additionally, we teach it how to handle simple queries and complex queries.</p>
<ul class="simple">
<li><p>For simple queries, we instruct the agent to finish with as few steps as possible.</p></li>
<li><p>For complex queries, we teach the agent a ‘divide-and-conquer’ strategy to solve the query step by step.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">task_spec</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;&quot;&quot;&lt;TASK_SPEC&gt;</span>
<span class="s2">- For simple queries: Directly call the ``finish`` action and provide the answer.</span>
<span class="s2">- For complex queries:</span>
<span class="s2">   - Step 1: Read the user query and potentially divide it into subqueries. And get started with the first subquery.</span>
<span class="s2">   - Call one available tool at a time to solve each subquery/subquestion. \</span>
<span class="s2">   - At step &#39;finish&#39;, join all subqueries answers and finish the task.</span>
<span class="s2">Remember:</span>
<span class="s2">- Action must call one of the above tools with name. It can not be empty.</span>
<span class="s2">- You will always end with &#39;finish&#39; action to finish the task. The answer can be the final answer or failure message.</span>
<span class="s2">&lt;/TASK_SPEC&gt;&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>We put all these three parts together to be within the <code class="docutils literal notranslate"><span class="pre">&lt;SYS&gt;&lt;/SYS&gt;</span></code> tag.</p>
<ol class="arabic simple" start="4">
<li><p>Agent step history.</p></li>
</ol>
<p>We use <code class="xref py py-class docutils literal notranslate"><span class="pre">StepOutput</span></code> to record the agent’s step history, including:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">action</span></code>: This will be the <code class="docutils literal notranslate"><span class="pre">FunctionExpression</span></code> instance predicted by the agent.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">observation</span></code>: The execution result of the action.</p></li>
</ul>
<p>In particular, we format the steps history after the user query as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">step_history</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;&quot;&quot;User query:</span>
<span class="s2">{{ input_str }}</span>
<span class="s2">{# Step History #}</span>
<span class="s2">{</span><span class="si">% i</span><span class="s2">f step_history %}</span>
<span class="s2">&lt;STEPS&gt;</span>
<span class="s2">{</span><span class="si">% f</span><span class="s2">or history in step_history %}</span>
<span class="s2">Step {{ loop.index }}.</span>
<span class="s2">&quot;Thought&quot;: &quot;{{history.action.thought}}&quot;,</span>
<span class="s2">&quot;Action&quot;: &quot;{{history.action.action}}&quot;,</span>
<span class="s2">&quot;Observation&quot;: &quot;{{history.observation}}&quot;</span>
<span class="s2">------------------------</span>
<span class="s2">{</span><span class="si">% e</span><span class="s2">ndfor %}</span>
<span class="s2">&lt;/STEPS&gt;</span>
<span class="s2">{</span><span class="si">% e</span><span class="s2">ndif %}</span>
<span class="s2">You:&quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
<section id="tools">
<h3>Tools<a class="headerlink" href="#tools" title="Link to this heading">#</a></h3>
<p>In addition to the tools provided by users, by default, we add a new tool named <code class="docutils literal notranslate"><span class="pre">finish</span></code> to allow the agent to stop and return the final answer.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">finish</span><span class="p">(</span><span class="n">answer</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">   </span><span class="sd">&quot;&quot;&quot;Finish the task with answer.&quot;&quot;&quot;</span>
   <span class="k">return</span> <span class="n">answer</span>
</pre></div>
</div>
<p>Simply returning a string might not fit all scenarios, and we might consider allowing users to define their own finish function in the future for more complex cases.</p>
<p>Additionally, since the provided tools cannot always solve user queries, we allow users to configure if an LLM model should be used to solve a subquery via the <code class="docutils literal notranslate"><span class="pre">add_llm_as_fallback</span></code> parameter.
This LLM will use the same model client and model arguments as the agent’s planner. Here is our code to specify the fallback LLM tool:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">_additional_llm_tool</span> <span class="o">=</span> <span class="p">(</span>
   <span class="n">Generator</span><span class="p">(</span><span class="n">model_client</span><span class="o">=</span><span class="n">model_client</span><span class="p">,</span> <span class="n">model_kwargs</span><span class="o">=</span><span class="n">model_kwargs</span><span class="p">)</span>
   <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_llm_as_fallback</span>
   <span class="k">else</span> <span class="kc">None</span>
<span class="p">)</span>

<span class="k">def</span> <span class="nf">llm_tool</span><span class="p">(</span><span class="nb">input</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">   </span><span class="sd">&quot;&quot;&quot;I answer any input query with llm&#39;s world knowledge. Use me as a fallback tool or when the query is simple.&quot;&quot;&quot;</span>
   <span class="c1"># use the generator to answer the query</span>
   <span class="k">try</span><span class="p">:</span>
         <span class="n">output</span><span class="p">:</span> <span class="n">GeneratorOutput</span> <span class="o">=</span> <span class="n">_additional_llm_tool</span><span class="p">(</span>
            <span class="n">prompt_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;input_str&quot;</span><span class="p">:</span> <span class="nb">input</span><span class="p">}</span>
         <span class="p">)</span>
         <span class="n">response</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">data</span> <span class="k">if</span> <span class="n">output</span> <span class="k">else</span> <span class="kc">None</span>
         <span class="k">return</span> <span class="n">response</span>
   <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
         <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error using the generator: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
         <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error using the generator: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

   <span class="k">return</span> <span class="kc">None</span>
</pre></div>
</div>
</section>
<section id="react-agent">
<h3>React Agent<a class="headerlink" href="#react-agent" title="Link to this heading">#</a></h3>
<p>We define the class <code class="xref py py-class docutils literal notranslate"><span class="pre">ReActAgent</span></code> to put everything together.
It will orchestrate two components:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">planner</span></code>: A <code class="docutils literal notranslate"><span class="pre">Generator</span></code> that works with a <code class="docutils literal notranslate"><span class="pre">JsonOutputParser</span></code> to parse the output format and examples of the function calls using <code class="docutils literal notranslate"><span class="pre">FunctionExpression</span></code>.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ToolManager</span></code>: Manages a given list of tools, the finish function, and the LLM tool. It is responsible for parsing and executing the functions.</p></li>
</ul>
<p>Additionally, it manages <cite>step_history</cite> as a list of <code class="docutils literal notranslate"><span class="pre">StepOutput</span></code> instances for the agent’s internal state.</p>
<div class="pst-scrollable-table-container"><table class="table">
<colgroup>
<col style="width: 63.6%" />
<col style="width: 36.4%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">__init__(self,</span> <span class="pre">tools:</span> <span class="pre">List[Union[Callable,</span> <span class="pre">AsyncCallable,</span> <span class="pre">FunctionTool]]</span> <span class="pre">=</span> <span class="pre">[],</span> <span class="pre">max_steps:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">10,</span> <span class="pre">add_llm_as_fallback:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True,</span> <span class="pre">examples:</span> <span class="pre">List[FunctionExpression]</span> <span class="pre">=</span> <span class="pre">[],</span> <span class="pre">*,</span> <span class="pre">model_client:</span> <span class="pre">ModelClient,</span> <span class="pre">model_kwargs:</span> <span class="pre">Dict</span> <span class="pre">=</span> <span class="pre">{},</span> <span class="pre">template:</span> <span class="pre">Optional[str]</span> <span class="pre">=</span> <span class="pre">None)</span></code></p></td>
<td><p>Initialize the <cite>ReActAgent</cite> with the specified tools, maximum steps, fallback option, examples, model client, model arguments, and template if you want to customize the prompt.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">call(self,</span> <span class="pre">input:</span> <span class="pre">str,</span> <span class="pre">prompt_kwargs:</span> <span class="pre">Optional[Dict]</span> <span class="pre">=</span> <span class="pre">{},</span> <span class="pre">model_kwargs:</span> <span class="pre">Optional[Dict]</span> <span class="pre">=</span> <span class="pre">{})</span> <span class="pre">-&gt;</span> <span class="pre">Any</span></code></p></td>
<td><p>Prompt the agent with an input query and process the steps to generate a response.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="agent-in-action">
<h2>Agent In Action<a class="headerlink" href="#agent-in-action" title="Link to this heading">#</a></h2>
<p>We will set up two sets of models, <cite>llama3-70b-8192`</cite> by Groq and <cite>gpt-3.5-turbo`</cite> by OpenAI, to test two queries.
For comparison, we will compare these with a vanilla LLM response without using the agent.
Here are the code snippets:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">adalflow.components.agent</span> <span class="kn">import</span> <span class="n">ReActAgent</span>
<span class="kn">from</span> <span class="nn">adalflow.core</span> <span class="kn">import</span> <span class="n">Generator</span><span class="p">,</span> <span class="n">ModelClientType</span><span class="p">,</span> <span class="n">ModelClient</span>
<span class="kn">from</span> <span class="nn">adalflow.utils</span> <span class="kn">import</span> <span class="n">setup_env</span>

<span class="n">setup_env</span><span class="p">()</span>


<span class="c1"># Define tools</span>
<span class="k">def</span> <span class="nf">multiply</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">   </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Multiply two numbers.</span>
<span class="sd">   &quot;&quot;&quot;</span>
   <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>

<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">   </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Add two numbers.</span>
<span class="sd">   &quot;&quot;&quot;</span>
   <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>

<span class="k">def</span> <span class="nf">divide</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">   </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Divide two numbers.</span>
<span class="sd">   &quot;&quot;&quot;</span>
   <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="n">b</span>

<span class="n">llama3_model_kwargs</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="s2">&quot;llama3-70b-8192&quot;</span><span class="p">,</span>  <span class="c1"># llama3 70b works better than 8b here.</span>
   <span class="s2">&quot;temperature&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">gpt_model_kwargs</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="s2">&quot;gpt-3.5-turbo&quot;</span><span class="p">,</span>
   <span class="s2">&quot;temperature&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="p">}</span>


<span class="k">def</span> <span class="nf">test_react_agent</span><span class="p">(</span><span class="n">model_client</span><span class="p">:</span> <span class="n">ModelClient</span><span class="p">,</span> <span class="n">model_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
   <span class="n">tools</span> <span class="o">=</span> <span class="p">[</span><span class="n">multiply</span><span class="p">,</span> <span class="n">add</span><span class="p">,</span> <span class="n">divide</span><span class="p">]</span>
   <span class="n">queries</span> <span class="o">=</span> <span class="p">[</span>
      <span class="s2">&quot;What is the capital of France? and what is 465 times 321 then add 95297 and then divide by 13.2?&quot;</span><span class="p">,</span>
      <span class="s2">&quot;Give me 5 words rhyming with cool, and make a 4-sentence poem using them&quot;</span><span class="p">,</span>
   <span class="p">]</span>
   <span class="c1"># define a generator without tools for comparison</span>

   <span class="n">generator</span> <span class="o">=</span> <span class="n">Generator</span><span class="p">(</span>
      <span class="n">model_client</span><span class="o">=</span><span class="n">model_client</span><span class="p">,</span>
      <span class="n">model_kwargs</span><span class="o">=</span><span class="n">model_kwargs</span><span class="p">,</span>
   <span class="p">)</span>

   <span class="n">react</span> <span class="o">=</span> <span class="n">ReActAgent</span><span class="p">(</span>
      <span class="n">max_steps</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
      <span class="n">add_llm_as_fallback</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
      <span class="n">tools</span><span class="o">=</span><span class="n">tools</span><span class="p">,</span>
      <span class="n">model_client</span><span class="o">=</span><span class="n">model_client</span><span class="p">,</span>
      <span class="n">model_kwargs</span><span class="o">=</span><span class="n">model_kwargs</span><span class="p">,</span>
   <span class="p">)</span>
   <span class="c1"># print(react)</span>

   <span class="k">for</span> <span class="n">query</span> <span class="ow">in</span> <span class="n">queries</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Query: </span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
      <span class="n">agent_response</span> <span class="o">=</span> <span class="n">react</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
      <span class="n">llm_response</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">prompt_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;input_str&quot;</span><span class="p">:</span> <span class="n">query</span><span class="p">})</span>
      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Agent response: </span><span class="si">{</span><span class="n">agent_response</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LLM response: </span><span class="si">{</span><span class="n">llm_response</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The structure of React, including the initialization arguments and two major components: <code class="docutils literal notranslate"><span class="pre">tool_manager</span></code> and <code class="docutils literal notranslate"><span class="pre">planner</span></code>, is shown below.</p>
 <div style="max-height: 300px; overflow-y: auto;">
     <pre>
         <code class="language-python">

ReActAgent(
   max_steps=6, add_llm_as_fallback=True,
   (tool_manager): ToolManager(Tools: [FunctionTool(fn: <function multiply at 0x1005768e0>, async: False, definition: FunctionDefinition(func_name='multiply', func_desc='multiply(a: int, b: int) -> int\n\n    Multiply two numbers.\n    ', func_parameters={'type': 'object', 'properties': {'a': {'type': 'int'}, 'b': {'type': 'int'}}, 'required': ['a', 'b']})), FunctionTool(fn: <function add at 0x1005cb7e0>, async: False, definition: FunctionDefinition(func_name='add', func_desc='add(a: int, b: int) -> int\n\n    Add two numbers.\n    ', func_parameters={'type': 'object', 'properties': {'a': {'type': 'int'}, 'b': {'type': 'int'}}, 'required': ['a', 'b']})), FunctionTool(fn: <function divide at 0x1005cb600>, async: False, definition: FunctionDefinition(func_name='divide', func_desc='divide(a: float, b: float) -> float\n\n    Divide two numbers.\n    ', func_parameters={'type': 'object', 'properties': {'a': {'type': 'float'}, 'b': {'type': 'float'}}, 'required': ['a', 'b']})), FunctionTool(fn: <function ReActAgent._init_tools.<locals>.llm_tool at 0x11384b740>, async: False, definition: FunctionDefinition(func_name='llm_tool', func_desc="llm_tool(input: str) -> str\nI answer any input query with llm's world knowledge. Use me as a fallback tool or when the query is simple.", func_parameters={'type': 'object', 'properties': {'input': {'type': 'str'}}, 'required': ['input']})), FunctionTool(fn: <function ReActAgent._init_tools.<locals>.finish at 0x11382fa60>, async: False, definition: FunctionDefinition(func_name='finish', func_desc='finish(answer: str) -> str\nFinish the task with answer.', func_parameters={'type': 'object', 'properties': {'answer': {'type': 'str'}}, 'required': ['answer']}))], Additional Context: {})
   (planner): Generator(
      model_kwargs={'model': 'llama3-70b-8192', 'temperature': 0.0},
      (prompt): Prompt(
         template: <SYS>
         {# role/task description #}
         You are a helpful assistant.
         Answer the user's query using the tools provided below with minimal steps and maximum accuracy.
         {# REACT instructions #}
         Each step you will read the previous Thought, Action, and Observation(execution result of the action) and then provide the next Thought and Action.
         {# Tools #}
         {% if tools %}
         <TOOLS>
         You available tools are:
         {# tools #}
         {% for tool in tools %}
         {{ loop.index }}.
         {{tool}}
         ------------------------
         {% endfor %}
         </TOOLS>
         {% endif %}
         {# output format and examples #}
         <OUTPUT_FORMAT>
         {{output_format_str}}
         </OUTPUT_FORMAT>
         <TASK_SPEC>
         {# Task specification to teach the agent how to think using 'divide and conquer' strategy #}
         - For simple queries: Directly call the ``finish`` action and provide the answer.
         - For complex queries:
            - Step 1: Read the user query and potentially divide it into subqueries. And get started with the first subquery.
            - Call one available tool at a time to solve each subquery/subquestion. \
            - At step 'finish', join all subqueries answers and finish the task.
         Remember:
         - Action must call one of the above tools with name. It can not be empty.
         - You will always end with 'finish' action to finish the task. The answer can be the final answer or failure message.
         </TASK_SPEC>
         </SYS>
         -----------------
         User query:
         {{ input_str }}
         {# Step History #}
         {% if step_history %}
         <STEPS>
         {% for history in step_history %}
         Step {{ loop.index }}.
         "Thought": "{{history.action.thought}}",
         "Action": "{{history.action.action}}",
         "Observation": "{{history.observation}}"
         ------------------------
         {% endfor %}
         </STEPS>
         {% endif %}
         You:, prompt_kwargs: {'tools': ['func_name: multiply\nfunc_desc: "multiply(a: int, b: int) -> int\\n\\n    Multiply two numbers.\\n    "\nfunc_parameters:\n  type: object\n  properties:\n    a:\n      type: int\n    b:\n      type: int\n  required:\n  - a\n  - b\n', 'func_name: add\nfunc_desc: "add(a: int, b: int) -> int\\n\\n    Add two numbers.\\n    "\nfunc_parameters:\n  type: object\n  properties:\n    a:\n      type: int\n    b:\n      type: int\n  required:\n  - a\n  - b\n', 'func_name: divide\nfunc_desc: "divide(a: float, b: float) -> float\\n\\n    Divide two numbers.\\n    "\nfunc_parameters:\n  type: object\n  properties:\n    a:\n      type: float\n    b:\n      type: float\n  required:\n  - a\n  - b\n', "func_name: llm_tool\nfunc_desc: 'llm_tool(input: str) -> str\n\n  I answer any input query with llm''s world knowledge. Use me as a fallback tool\n  or when the query is simple.'\nfunc_parameters:\n  type: object\n  properties:\n    input:\n      type: str\n  required:\n  - input\n", "func_name: finish\nfunc_desc: 'finish(answer: str) -> str\n\n  Finish the task with answer.'\nfunc_parameters:\n  type: object\n  properties:\n    answer:\n      type: str\n  required:\n  - answer\n"], 'output_format_str': 'Your output should be formatted as a standard JSON instance with the following schema:\n```\n{\n    "thought": "Why the function is called (Optional[str]) (optional)",\n    "action": "FuncName(<kwargs>) Valid function call expression. Example: \\"FuncName(a=1, b=2)\\" Follow the data type specified in the function parameters.e.g. for Type object with x,y properties, use \\"ObjectType(x=1, y=2) (str) (required)"\n}\n```\nExamples:\n```\n{\n    "thought": "I have finished the task.",\n    "action": "finish(answer=\\"final answer: \'answer\'\\")"\n}\n________\n```\n-Make sure to always enclose the JSON output in triple backticks (```). Please do not add anything other than valid JSON output!\n-Use double quotes for the keys and string values.\n-DO NOT mistaken the "properties" and "type" in the schema as the actual fields in the JSON output.\n-Follow the JSON formatting conventions.'}, prompt_variables: ['input_str', 'tools', 'step_history', 'output_format_str']
      )
      (model_client): GroqAPIClient()
      (output_processors): JsonOutputParser(
         data_class=FunctionExpression, examples=[FunctionExpression(thought='I have finished the task.', action='finish(answer="final answer: \'answer\'")')], exclude_fields=None, return_data_class=True
         (output_format_prompt): Prompt(
         template: Your output should be formatted as a standard JSON instance with the following schema:
         ```
         {{schema}}
         ```
         {% if example %}
         Examples:
         ```
         {{example}}
         ```
         {% endif %}
         -Make sure to always enclose the JSON output in triple backticks (```). Please do not add anything other than valid JSON output!
         -Use double quotes for the keys and string values.
         -DO NOT mistaken the "properties" and "type" in the schema as the actual fields in the JSON output.
         -Follow the JSON formatting conventions., prompt_variables: ['example', 'schema']
         )
         (output_processors): JsonParser()
      )
   )
)
         </code>
     </pre>
 </div><p>Now, let’s run the test function to see the agent in action.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">test_react_agent</span><span class="p">(</span><span class="n">ModelClientType</span><span class="o">.</span><span class="n">GROQ</span><span class="p">(),</span> <span class="n">llama3_model_kwargs</span><span class="p">)</span>
<span class="n">test_react_agent</span><span class="p">(</span><span class="n">ModelClientType</span><span class="o">.</span><span class="n">OPENAI</span><span class="p">(),</span> <span class="n">gpt_model_kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>Our agent will show the core steps for developers via colored printout, including input_query, steps, and the final answer.
The printout of the first query with llama3 is shown below (without the color here):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="mi">2024</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">10</span> <span class="mi">16</span><span class="p">:</span><span class="mi">48</span><span class="p">:</span><span class="mi">47</span> <span class="o">-</span> <span class="p">[</span><span class="n">react</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">287</span><span class="p">:</span><span class="n">call</span><span class="p">]</span> <span class="o">-</span> <span class="n">input_query</span><span class="p">:</span> <span class="n">What</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">capital</span> <span class="n">of</span> <span class="n">France</span><span class="err">?</span> <span class="ow">and</span> <span class="n">what</span> <span class="ow">is</span> <span class="mi">465</span> <span class="n">times</span> <span class="mi">321</span> <span class="n">then</span> <span class="n">add</span> <span class="mi">95297</span> <span class="ow">and</span> <span class="n">then</span> <span class="n">divide</span> <span class="n">by</span> <span class="mf">13.2</span>

<span class="mi">2024</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">10</span> <span class="mi">16</span><span class="p">:</span><span class="mi">48</span><span class="p">:</span><span class="mi">48</span> <span class="o">-</span> <span class="p">[</span><span class="n">react</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">266</span><span class="p">:</span><span class="n">_run_one_step</span><span class="p">]</span> <span class="o">-</span> <span class="n">Step</span> <span class="mi">1</span><span class="p">:</span>
<span class="n">StepOutput</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="n">FunctionExpression</span><span class="p">(</span><span class="n">thought</span><span class="o">=</span><span class="s2">&quot;Let&#39;s break down the query into subqueries and start with the first one.&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;llm_tool(input=&quot;What is the capital of France?&quot;)&#39;</span><span class="p">),</span> <span class="n">function</span><span class="o">=</span><span class="n">Function</span><span class="p">(</span><span class="n">thought</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;llm_tool&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[],</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;input&#39;</span><span class="p">:</span> <span class="s1">&#39;What is the capital of France?&#39;</span><span class="p">}),</span> <span class="n">observation</span><span class="o">=</span><span class="s1">&#39;The capital of France is Paris!&#39;</span><span class="p">)</span>
<span class="n">_______</span>

<span class="mi">2024</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">10</span> <span class="mi">16</span><span class="p">:</span><span class="mi">48</span><span class="p">:</span><span class="mi">49</span> <span class="o">-</span> <span class="p">[</span><span class="n">react</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">266</span><span class="p">:</span><span class="n">_run_one_step</span><span class="p">]</span> <span class="o">-</span> <span class="n">Step</span> <span class="mi">2</span><span class="p">:</span>
<span class="n">StepOutput</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="n">FunctionExpression</span><span class="p">(</span><span class="n">thought</span><span class="o">=</span><span class="s2">&quot;Now, let&#39;s move on to the second subquery.&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;multiply(a=465, b=321)&#39;</span><span class="p">),</span> <span class="n">function</span><span class="o">=</span><span class="n">Function</span><span class="p">(</span><span class="n">thought</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;multiply&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[],</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">465</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">321</span><span class="p">}),</span> <span class="n">observation</span><span class="o">=</span><span class="mi">149265</span><span class="p">)</span>
<span class="n">_______</span>

<span class="mi">2024</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">10</span> <span class="mi">16</span><span class="p">:</span><span class="mi">48</span><span class="p">:</span><span class="mi">49</span> <span class="o">-</span> <span class="p">[</span><span class="n">react</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">266</span><span class="p">:</span><span class="n">_run_one_step</span><span class="p">]</span> <span class="o">-</span> <span class="n">Step</span> <span class="mi">3</span><span class="p">:</span>
<span class="n">StepOutput</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="n">FunctionExpression</span><span class="p">(</span><span class="n">thought</span><span class="o">=</span><span class="s2">&quot;Now, let&#39;s add 95297 to the result.&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;add(a=149265, b=95297)&#39;</span><span class="p">),</span> <span class="n">function</span><span class="o">=</span><span class="n">Function</span><span class="p">(</span><span class="n">thought</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[],</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">149265</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">95297</span><span class="p">}),</span> <span class="n">observation</span><span class="o">=</span><span class="mi">244562</span><span class="p">)</span>
<span class="n">_______</span>

<span class="mi">2024</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">10</span> <span class="mi">16</span><span class="p">:</span><span class="mi">48</span><span class="p">:</span><span class="mi">50</span> <span class="o">-</span> <span class="p">[</span><span class="n">react</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">266</span><span class="p">:</span><span class="n">_run_one_step</span><span class="p">]</span> <span class="o">-</span> <span class="n">Step</span> <span class="mi">4</span><span class="p">:</span>
<span class="n">StepOutput</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="n">FunctionExpression</span><span class="p">(</span><span class="n">thought</span><span class="o">=</span><span class="s2">&quot;Now, let&#39;s divide the result by 13.2.&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;divide(a=244562, b=13.2)&#39;</span><span class="p">),</span> <span class="n">function</span><span class="o">=</span><span class="n">Function</span><span class="p">(</span><span class="n">thought</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;divide&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[],</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">244562</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mf">13.2</span><span class="p">}),</span> <span class="n">observation</span><span class="o">=</span><span class="mf">18527.424242424244</span><span class="p">)</span>
<span class="n">_______</span>

<span class="mi">2024</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">10</span> <span class="mi">16</span><span class="p">:</span><span class="mi">48</span><span class="p">:</span><span class="mi">50</span> <span class="o">-</span> <span class="p">[</span><span class="n">react</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">266</span><span class="p">:</span><span class="n">_run_one_step</span><span class="p">]</span> <span class="o">-</span> <span class="n">Step</span> <span class="mi">5</span><span class="p">:</span>
<span class="n">StepOutput</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="n">FunctionExpression</span><span class="p">(</span><span class="n">thought</span><span class="o">=</span><span class="s2">&quot;Now, let&#39;s combine the answers of both subqueries.&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;finish(answer=&quot;The capital of France is Paris! and the result of the mathematical operation is 18527.424242424244.&quot;)&#39;</span><span class="p">),</span> <span class="n">function</span><span class="o">=</span><span class="n">Function</span><span class="p">(</span><span class="n">thought</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;finish&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[],</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;answer&#39;</span><span class="p">:</span> <span class="s1">&#39;The capital of France is Paris! and the result of the mathematical operation is 18527.424242424244.&#39;</span><span class="p">}),</span> <span class="n">observation</span><span class="o">=</span><span class="s1">&#39;The capital of France is Paris! and the result of the mathematical operation is 18527.424242424244.&#39;</span><span class="p">)</span>
<span class="n">_______</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">10</span> <span class="mi">16</span><span class="p">:</span><span class="mi">48</span><span class="p">:</span><span class="mi">50</span> <span class="o">-</span> <span class="p">[</span><span class="n">react</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">301</span><span class="p">:</span><span class="n">call</span><span class="p">]</span> <span class="o">-</span> <span class="n">answer</span><span class="p">:</span>
<span class="n">The</span> <span class="n">capital</span> <span class="n">of</span> <span class="n">France</span> <span class="ow">is</span> <span class="n">Paris</span><span class="err">!</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">result</span> <span class="n">of</span> <span class="n">the</span> <span class="n">mathematical</span> <span class="n">operation</span> <span class="ow">is</span> <span class="mf">18527.424242424244</span><span class="o">.</span>
</pre></div>
</div>
<p>For the second query, the printout:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="mi">2024</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">10</span> <span class="mi">16</span><span class="p">:</span><span class="mi">48</span><span class="p">:</span><span class="mi">51</span> <span class="o">-</span> <span class="p">[</span><span class="n">react</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">287</span><span class="p">:</span><span class="n">call</span><span class="p">]</span> <span class="o">-</span> <span class="n">input_query</span><span class="p">:</span> <span class="n">Give</span> <span class="n">me</span> <span class="mi">5</span> <span class="n">words</span> <span class="n">rhyming</span> <span class="k">with</span> <span class="n">cool</span><span class="p">,</span> <span class="ow">and</span> <span class="n">make</span> <span class="n">a</span> <span class="mi">4</span><span class="o">-</span><span class="n">sentence</span> <span class="n">poem</span> <span class="n">using</span> <span class="n">them</span>
<span class="mi">2024</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">10</span> <span class="mi">16</span><span class="p">:</span><span class="mi">48</span><span class="p">:</span><span class="mi">52</span> <span class="o">-</span> <span class="p">[</span><span class="n">react</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">266</span><span class="p">:</span><span class="n">_run_one_step</span><span class="p">]</span> <span class="o">-</span> <span class="n">Step</span> <span class="mi">1</span><span class="p">:</span>
<span class="n">StepOutput</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="n">FunctionExpression</span><span class="p">(</span><span class="n">thought</span><span class="o">=</span><span class="s2">&quot;I need to find 5 words that rhyme with &#39;cool&#39;.&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;llm_tool(input=&quot;What are 5 words that rhyme with </span><span class="se">\&#39;</span><span class="s1">cool</span><span class="se">\&#39;</span><span class="s1">?&quot;)&#39;</span><span class="p">),</span> <span class="n">function</span><span class="o">=</span><span class="n">Function</span><span class="p">(</span><span class="n">thought</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;llm_tool&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[],</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;input&#39;</span><span class="p">:</span> <span class="s2">&quot;What are 5 words that rhyme with &#39;cool&#39;?&quot;</span><span class="p">}),</span> <span class="n">observation</span><span class="o">=</span><span class="s1">&#39;Here are 5 words that rhyme with &quot;cool&quot;:</span><span class="se">\n\n</span><span class="s1">1. Rule</span><span class="se">\n</span><span class="s1">2. Tool</span><span class="se">\n</span><span class="s1">3. Fool</span><span class="se">\n</span><span class="s1">4. Pool</span><span class="se">\n</span><span class="s1">5. School&#39;</span><span class="p">)</span>
<span class="n">_______</span>

<span class="mi">2024</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">10</span> <span class="mi">16</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">00</span> <span class="o">-</span> <span class="p">[</span><span class="n">react</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">266</span><span class="p">:</span><span class="n">_run_one_step</span><span class="p">]</span> <span class="o">-</span> <span class="n">Step</span> <span class="mi">2</span><span class="p">:</span>
<span class="n">StepOutput</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="n">FunctionExpression</span><span class="p">(</span><span class="n">thought</span><span class="o">=</span><span class="s1">&#39;Now that I have the rhyming words, I need to create a 4-sentence poem using them.&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;llm_tool(input=&quot;Create a 4-sentence poem using the words </span><span class="se">\&#39;</span><span class="s1">rule</span><span class="se">\&#39;</span><span class="s1">, </span><span class="se">\&#39;</span><span class="s1">tool</span><span class="se">\&#39;</span><span class="s1">, </span><span class="se">\&#39;</span><span class="s1">fool</span><span class="se">\&#39;</span><span class="s1">, </span><span class="se">\&#39;</span><span class="s1">pool</span><span class="se">\&#39;</span><span class="s1">, and </span><span class="se">\&#39;</span><span class="s1">school</span><span class="se">\&#39;</span><span class="s1">.&quot;)&#39;</span><span class="p">),</span> <span class="n">function</span><span class="o">=</span><span class="n">Function</span><span class="p">(</span><span class="n">thought</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;llm_tool&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[],</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;input&#39;</span><span class="p">:</span> <span class="s2">&quot;Create a 4-sentence poem using the words &#39;rule&#39;, &#39;tool&#39;, &#39;fool&#39;, &#39;pool&#39;, and &#39;school&#39;.&quot;</span><span class="p">}),</span> <span class="n">observation</span><span class="o">=</span><span class="s2">&quot;Here is a 4-sentence poem using the words &#39;rule&#39;, &#39;tool&#39;, &#39;fool&#39;, &#39;pool&#39;, and &#39;school&#39;:</span><span class="se">\n\n</span><span class="s2">In the classroom, we learn to rule,</span><span class="se">\n</span><span class="s2">With a pencil as our trusty tool.</span><span class="se">\n</span><span class="s2">But if we&#39;re not careful, we can be a fool,</span><span class="se">\n</span><span class="s2">And end up swimming in the school pool.&quot;</span><span class="p">)</span>
<span class="n">_______</span>

<span class="mi">2024</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">10</span> <span class="mi">16</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">12</span> <span class="o">-</span> <span class="p">[</span><span class="n">react</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">266</span><span class="p">:</span><span class="n">_run_one_step</span><span class="p">]</span> <span class="o">-</span> <span class="n">Step</span> <span class="mi">3</span><span class="p">:</span>
<span class="n">StepOutput</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="n">FunctionExpression</span><span class="p">(</span><span class="n">thought</span><span class="o">=</span><span class="s1">&#39;I have the poem, now I need to finish the task.&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;finish(answer=&quot;Here are 5 words that rhyme with </span><span class="se">\&#39;</span><span class="s1">cool</span><span class="se">\&#39;</span><span class="s1">: rule, tool, fool, pool, school. Here is a 4-sentence poem using the words: In the classroom, we learn to rule, With a pencil as our trusty tool. But if we</span><span class="se">\&#39;</span><span class="s1">re not careful, we can be a fool, And end up swimming in the school pool.&quot;)&#39;</span><span class="p">),</span> <span class="n">function</span><span class="o">=</span><span class="n">Function</span><span class="p">(</span><span class="n">thought</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;finish&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[],</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;answer&#39;</span><span class="p">:</span> <span class="s2">&quot;Here are 5 words that rhyme with &#39;cool&#39;: rule, tool, fool, pool, school. Here is a 4-sentence poem using the words: In the classroom, we learn to rule, With a pencil as our trusty tool. But if we&#39;re not careful, we can be a fool, And end up swimming in the school pool.&quot;</span><span class="p">}),</span> <span class="n">observation</span><span class="o">=</span><span class="s2">&quot;Here are 5 words that rhyme with &#39;cool&#39;: rule, tool, fool, pool, school. Here is a 4-sentence poem using the words: In the classroom, we learn to rule, With a pencil as our trusty tool. But if we&#39;re not careful, we can be a fool, And end up swimming in the school pool.&quot;</span><span class="p">)</span>
<span class="n">_______</span>

<span class="mi">2024</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">10</span> <span class="mi">16</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">12</span> <span class="o">-</span> <span class="p">[</span><span class="n">react</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">301</span><span class="p">:</span><span class="n">call</span><span class="p">]</span> <span class="o">-</span> <span class="n">answer</span><span class="p">:</span>
<span class="n">Here</span> <span class="n">are</span> <span class="mi">5</span> <span class="n">words</span> <span class="n">that</span> <span class="n">rhyme</span> <span class="k">with</span> <span class="s1">&#39;cool&#39;</span><span class="p">:</span> <span class="n">rule</span><span class="p">,</span> <span class="n">tool</span><span class="p">,</span> <span class="n">fool</span><span class="p">,</span> <span class="n">pool</span><span class="p">,</span> <span class="n">school</span><span class="o">.</span> <span class="n">Here</span> <span class="ow">is</span> <span class="n">a</span> <span class="mi">4</span><span class="o">-</span><span class="n">sentence</span> <span class="n">poem</span> <span class="n">using</span> <span class="n">the</span> <span class="n">words</span><span class="p">:</span> <span class="n">In</span> <span class="n">the</span> <span class="n">classroom</span><span class="p">,</span> <span class="n">we</span> <span class="n">learn</span> <span class="n">to</span> <span class="n">rule</span><span class="p">,</span> <span class="n">With</span> <span class="n">a</span> <span class="n">pencil</span> <span class="k">as</span> <span class="n">our</span> <span class="n">trusty</span> <span class="n">tool</span><span class="o">.</span> <span class="n">But</span> <span class="k">if</span> <span class="n">we</span><span class="s1">&#39;re not careful, we can be a fool, And end up swimming in the school pool.</span>
</pre></div>
</div>
<p>The comparison between the agent and the vanilla LLM response is shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Answer with agent: The capital of France is Paris! and the result of the mathematical operation is 18527.424242424244.
Answer without agent: GeneratorOutput(data=&quot;I&#39;d be happy to help you with that!\n\nThe capital of France is Paris.\n\nNow, let&#39;s tackle the math problem:\n\n1. 465 × 321 = 149,485\n2. Add 95,297 to that result: 149,485 + 95,297 = 244,782\n3. Divide the result by 13.2: 244,782 ÷ 13.2 = 18,544.09\n\nSo, the answer is 18,544.09!&quot;, error=None, usage=None, raw_response=&quot;I&#39;d be happy to help you with that!\n\nThe capital of France is Paris.\n\nNow, let&#39;s tackle the math problem:\n\n1. 465 × 321 = 149,485\n2. Add 95,297 to that result: 149,485 + 95,297 = 244,782\n3. Divide the result by 13.2: 244,782 ÷ 13.2 = 18,544.09\n\nSo, the answer is 18,544.09!&quot;, metadata=None)
</pre></div>
</div>
<p>For the second query, the comparison is shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Answer</span> <span class="k">with</span> <span class="n">agent</span><span class="p">:</span> <span class="n">Here</span> <span class="n">are</span> <span class="mi">5</span> <span class="n">words</span> <span class="n">that</span> <span class="n">rhyme</span> <span class="k">with</span> <span class="s1">&#39;cool&#39;</span><span class="p">:</span> <span class="n">rule</span><span class="p">,</span> <span class="n">tool</span><span class="p">,</span> <span class="n">fool</span><span class="p">,</span> <span class="n">pool</span><span class="p">,</span> <span class="n">school</span><span class="o">.</span> <span class="n">Here</span> <span class="ow">is</span> <span class="n">a</span> <span class="mi">4</span><span class="o">-</span><span class="n">sentence</span> <span class="n">poem</span> <span class="n">using</span> <span class="n">the</span> <span class="n">words</span><span class="p">:</span> <span class="n">In</span> <span class="n">the</span> <span class="n">classroom</span><span class="p">,</span> <span class="n">we</span> <span class="n">learn</span> <span class="n">to</span> <span class="n">rule</span><span class="p">,</span> <span class="n">With</span> <span class="n">a</span> <span class="n">pencil</span> <span class="k">as</span> <span class="n">our</span> <span class="n">trusty</span> <span class="n">tool</span><span class="o">.</span> <span class="n">But</span> <span class="k">if</span> <span class="n">we</span><span class="s1">&#39;re not careful, we can be a fool, And end up swimming in the school pool.</span>
<span class="n">Answer</span> <span class="n">without</span> <span class="n">agent</span><span class="p">:</span> <span class="n">GeneratorOutput</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;Here are 5 words that rhyme with &quot;cool&quot;:</span><span class="se">\n\n</span><span class="s1">1. rule</span><span class="se">\n</span><span class="s1">2. tool</span><span class="se">\n</span><span class="s1">3. fool</span><span class="se">\n</span><span class="s1">4. pool</span><span class="se">\n</span><span class="s1">5. school</span><span class="se">\n\n</span><span class="s1">And here</span><span class="se">\&#39;</span><span class="s1">s a 4-sentence poem using these words:</span><span class="se">\n\n</span><span class="s1">In the summer heat, I like to be cool,</span><span class="se">\n</span><span class="s1">Following the rule, I take a dip in the pool.</span><span class="se">\n</span><span class="s1">I</span><span class="se">\&#39;</span><span class="s1">m not a fool, I know just what to do,</span><span class="se">\n</span><span class="s1">I grab my tool and head back to school.&#39;</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">usage</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">raw_response</span><span class="o">=</span><span class="s1">&#39;Here are 5 words that rhyme with &quot;cool&quot;:</span><span class="se">\n\n</span><span class="s1">1. rule</span><span class="se">\n</span><span class="s1">2. tool</span><span class="se">\n</span><span class="s1">3. fool</span><span class="se">\n</span><span class="s1">4. pool</span><span class="se">\n</span><span class="s1">5. school</span><span class="se">\n\n</span><span class="s1">And here</span><span class="se">\&#39;</span><span class="s1">s a 4-sentence poem using these words:</span><span class="se">\n\n</span><span class="s1">In the summer heat, I like to be cool,</span><span class="se">\n</span><span class="s1">Following the rule, I take a dip in the pool.</span><span class="se">\n</span><span class="s1">I</span><span class="se">\&#39;</span><span class="s1">m not a fool, I know just what to do,</span><span class="se">\n</span><span class="s1">I grab my tool and head back to school.&#39;</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>The ReAct agent is particularly helpful for answering queries that require capabilities like computation or more complicated reasoning and planning.
However, using it on general queries might be an overkill, as it might take more steps than necessary to answer the query.</p>
</section>
<section id="customization">
<h2>Customization<a class="headerlink" href="#customization" title="Link to this heading">#</a></h2>
<p><strong>Template</strong></p>
<p>The first thing you want to customize is the template itself.
You can do this by passing your own template to the agent’s constructor.
We suggest you to modify our default template: <code class="xref py py-const docutils literal notranslate"><span class="pre">DEFAULT_REACT_AGENT_SYSTEM_PROMPT</span></code>.</p>
<p><strong>Examples for Better Output Format</strong></p>
<p>Secondly, the <code class="docutils literal notranslate"><span class="pre">examples</span></code> in the constructor allow you to provide more examples to enforce the correct output format.
For instance, if we want it to learn how to correctly call <cite>multiply</cite>, we can pass in a list of <code class="docutils literal notranslate"><span class="pre">FunctionExpression</span></code> instances with the correct format.
Classmethod <code class="docutils literal notranslate"><span class="pre">from_function</span></code> can be used to create a <code class="docutils literal notranslate"><span class="pre">FunctionExpression</span></code> instance from a function and its arguments.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">adalflow.core.types</span> <span class="kn">import</span> <span class="n">FunctionExpression</span>

<span class="c1"># generate an example of calling multiply with key-word arguments</span>
<span class="n">example_using_multiply</span> <span class="o">=</span> <span class="n">FunctionExpression</span><span class="o">.</span><span class="n">from_function</span><span class="p">(</span>
     <span class="n">func</span><span class="o">=</span><span class="n">multiply</span><span class="p">,</span>
     <span class="n">thought</span><span class="o">=</span><span class="s2">&quot;Now, let&#39;s multiply two numbers.&quot;</span><span class="p">,</span>
     <span class="n">a</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
     <span class="n">b</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
 <span class="p">)</span>
<span class="n">examples</span> <span class="o">=</span> <span class="p">[</span><span class="n">example_using_multiply</span><span class="p">]</span>

<span class="c1"># pass it to the agent</span>
</pre></div>
</div>
<p>We can visualize how this is passed to the planner prompt via:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">react</span><span class="o">.</span><span class="n">planner</span><span class="o">.</span><span class="n">print_prompt</span><span class="p">()</span>
</pre></div>
</div>
<p>The above example will be formated as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;OUTPUT_FORMAT&gt;
Your output should be formatted as a standard JSON instance with the following schema:
```
{
   &quot;thought&quot;: &quot;Why the function is called (Optional[str]) (optional)&quot;,
   &quot;action&quot;: &quot;FuncName(&lt;kwargs&gt;) Valid function call expression. Example: \&quot;FuncName(a=1, b=2)\&quot; Follow the data type specified in the function parameters.e.g. for Type object with x,y properties, use \&quot;ObjectType(x=1, y=2) (str) (required)&quot;
}
```
Examples:
```
{
   &quot;thought&quot;: &quot;Now, let&#39;s multiply two numbers.&quot;,
   &quot;action&quot;: &quot;multiply(a=3, b=4)&quot;
}
________
{
   &quot;thought&quot;: &quot;I have finished the task.&quot;,
   &quot;action&quot;: &quot;finish(answer=\&quot;final answer: &#39;answer&#39;\&quot;)&quot;
}
________
```
-Make sure to always enclose the JSON output in triple backticks (```). Please do not add anything other than valid JSON output!
-Use double quotes for the keys and string values.
-DO NOT mistaken the &quot;properties&quot; and &quot;type&quot; in the schema as the actual fields in the JSON output.
-Follow the JSON formatting conventions.
&lt;/OUTPUT_FORMAT&gt;
</pre></div>
</div>
<p><strong>Subclass ReActAgent</strong></p>
<p>If you want to customize the agent further, you can subclass the <code class="xref py py-class docutils literal notranslate"><span class="pre">ReActAgent</span></code> and override the methods you want to change.</p>
<div class="highlight admonition">
<p class="admonition-title">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id3" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>A survey on large language model based autonomous agents: <a class="github reference external" href="https://github.com/Paitesanshi/LLM-Agent-Survey">Paitesanshi/LLM-Agent-Survey</a></p>
</aside>
<aside class="footnote brackets" id="id4" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>ReAct: <a class="reference external" href="https://arxiv.org/abs/2210.03629">https://arxiv.org/abs/2210.03629</a></p>
</aside>
</aside>
</div>
<div class="highlight admonition">
<p class="admonition-title">API References</p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">components.agent.react.ReActAgent</span></code></p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">core.types.StepOutput</span></code></p></li>
<li><p><code class="xref py py-const docutils literal notranslate"><span class="pre">components.agent.react.DEFAULT_REACT_AGENT_SYSTEM_PROMPT</span></code></p></li>
</ul>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="tool_helper.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Function calls</p>
      </div>
    </a>
    <a class="right-next"
       href="evaluation.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">LLM Evaluation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#design">Design</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prompt-and-data-models">Prompt and Data Models</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tools">Tools</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#react-agent">React Agent</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#agent-in-action">Agent In Action</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#customization">Customization</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, SylphAI, Inc.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>