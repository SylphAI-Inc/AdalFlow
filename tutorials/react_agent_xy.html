
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>ReAct Agent &#8212; AdalFlow: The Library to Build and Auto-Optimize LLM Task Pipelines</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=5422b685" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=87e54e7c" />
    <link rel="stylesheet" type="text/css" href="../_static/css/rtd_sphinx_search.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../_static/js/rtd_search_config.js"></script>
    <script src="../_static/js/rtd_sphinx_search.min.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorials/react_agent_xy';</script>
    <link rel="icon" href="../_static/LightRAG-logo-circle.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/adalflow-logo.png" class="logo__image only-light" alt="AdalFlow: The Library to Build and Auto-Optimize LLM Task Pipelines - Home"/>
    <script>document.write(`<img src="../_static/adalflow-logo.png" class="logo__image only-dark" alt="AdalFlow: The Library to Build and Auto-Optimize LLM Task Pipelines - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../get_started/index.html">
    Get Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="index.html">
    Developer Notes
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../use_cases/index.html">
    Use Cases
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../apis/index.html">
    API Reference
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/SylphAI-Inc/LightRAG" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://discord.gg/ezzszrRZvT" title="Discord" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-discord fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Discord</span></a>
        </li>
</ul></div>
      
        <div class="navbar-item">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../get_started/index.html">
    Get Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="index.html">
    Developer Notes
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../use_cases/index.html">
    Use Cases
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../apis/index.html">
    API Reference
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/SylphAI-Inc/LightRAG" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://discord.gg/ezzszrRZvT" title="Discord" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-discord fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Discord</span></a>
        </li>
</ul></div>
        
          <div class="navbar-item">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">ReAct Agent</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="react-agent">
<span id="react-agent-xy"></span><h1>ReAct Agent<a class="headerlink" href="#react-agent" title="Link to this heading">#</a></h1>
<p>Check out <a class="reference external" href="../notebooks/react_agent.ipynb">react agent notebook</a></p>
<p>The goal of this tutorial is to:</p>
<ol class="arabic simple">
<li><p>Demonstrate how <code class="docutils literal notranslate"><span class="pre">LightRAG</span></code> implements the ReAct agent</p></li>
<li><p>Provide a Deep Dive on ReAct Agent(Reference)</p></li>
</ol>
<section id="what-is-an-agent-and-why-you-need-it">
<h2>What is an agent and why you need it?<a class="headerlink" href="#what-is-an-agent-and-why-you-need-it" title="Link to this heading">#</a></h2>
<p>An agent, is better defined as a system that strategically uses LLM models and various tools to plan and execute steps.
Although LLMs and RAGs can generate text response with conversation history and internal knowledge,
they are unable to plan sequentially and decide which resource to use.</p>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>Before explaining <code class="docutils literal notranslate"><span class="pre">LightRAG</span> <span class="pre">Agent</span></code> implementation, here is a quick introduction of ReAct Agent.</p>
<p>To solve a query, the <a class="reference external" href="https://arxiv.org/pdf/2210.03629">ReAct Agent</a>, like its name(<code class="docutils literal notranslate"><span class="pre">Re</span></code>- Reason; <code class="docutils literal notranslate"><span class="pre">Act</span></code> - Act),
first uses LLM to analyze the context and plan actions to answer the query(reasoning).
Then it takes actions to utilize external resources(action). For more details, please see the <a class="reference internal" href="#deep-dive"><span class="std std-ref">ReAct Agent Deep Dive</span></a>.</p>
</section>
<section id="lightrag-s-implementation">
<h2>LightRAG’s Implementation<a class="headerlink" href="#lightrag-s-implementation" title="Link to this heading">#</a></h2>
<p>Next, let’s look at how <code class="docutils literal notranslate"><span class="pre">LightRAG</span></code> makes the implementation convenient. In <code class="docutils literal notranslate"><span class="pre">LightRAG</span></code>, the ReAct agent is a type of <span class="xref std std-ref">generator</span> that runs multiple sequential steps to generate the final response, with designed prompt, external functions(named as <code class="docutils literal notranslate"><span class="pre">tools</span></code>) and <code class="docutils literal notranslate"><span class="pre">JsonParser</span> <span class="pre">output_processors</span></code>.</p>
<p>1. <strong>Prompt:</strong> We have a easy-to-customizable prompt template designed for ReAct agent that takes in
<code class="docutils literal notranslate"><span class="pre">tools</span></code>, few shot <code class="docutils literal notranslate"><span class="pre">examples</span></code>, <code class="docutils literal notranslate"><span class="pre">history</span></code>, and <code class="docutils literal notranslate"><span class="pre">user</span> <span class="pre">query</span></code>.
The <code class="docutils literal notranslate"><span class="pre">history</span></code> will be automatically managed by the agent. <code class="docutils literal notranslate"><span class="pre">user</span> <span class="pre">query</span></code> will be handled in each single turn.
Hence when initializing an agent, we only need to set up the <code class="docutils literal notranslate"><span class="pre">tools</span></code> and the <code class="docutils literal notranslate"><span class="pre">examples</span></code> in the <code class="docutils literal notranslate"><span class="pre">preset_prompt_kwargs</span></code> for the system prompt and
use <code class="docutils literal notranslate"><span class="pre">user</span> <span class="pre">query</span></code> in each agent call. <span class="xref std std-ref">Prompt</span>.</p>
<p>2. <strong>Tools:</strong> ReAct Agent needs to plan the tool to use, which means it needs to access the tools’ descriptions.
<code class="docutils literal notranslate"><span class="pre">LightRAG</span></code> provides dynamic tool handling, using <code class="docutils literal notranslate"><span class="pre">FunctionTool</span></code> to encapsulate tool functionalities. The metadata(function name, description, and parameters) will be extracted and passed to the prompt automatically. This process not only makes tool integration more seamless but also enhances developer efficiency by allowing straightforward definition and management of tools.</p>
<p>Here is the example to illustrate the usage of <code class="docutils literal notranslate"><span class="pre">FunctionTool</span></code>. It’s easy to set up using <code class="docutils literal notranslate"><span class="pre">from_defaults</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lightrag.core.tool_helper</span> <span class="kn">import</span> <span class="n">FunctionTool</span>

<span class="c1"># define the tools</span>
<span class="k">def</span> <span class="nf">multiply</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Multiply two numbers.&#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Add two numbers.&#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>

<span class="n">tools</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">FunctionTool</span><span class="o">.</span><span class="n">from_defaults</span><span class="p">(</span><span class="n">fn</span><span class="o">=</span><span class="n">multiply</span><span class="p">),</span>
            <span class="n">FunctionTool</span><span class="o">.</span><span class="n">from_defaults</span><span class="p">(</span><span class="n">fn</span><span class="o">=</span><span class="n">add</span><span class="p">),</span>
        <span class="p">]</span>

<span class="k">for</span> <span class="n">tool</span> <span class="ow">in</span> <span class="n">tools</span><span class="p">:</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">tool</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">name</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">tool</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">description</span>
    <span class="n">parameter</span> <span class="o">=</span> <span class="n">tool</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">fn_schema_str</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Function name: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Function description: </span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Function parameter: </span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Function name: multiply</span>
<span class="c1"># Function description: multiply(a: int, b: int) -&gt; int</span>
<span class="c1"># Multiply two numbers.</span>
<span class="c1"># Function parameter: {&quot;type&quot;: &quot;object&quot;, &quot;properties&quot;: {&quot;a&quot;: {&quot;type&quot;: &quot;int&quot;}, &quot;b&quot;: {&quot;type&quot;: &quot;int&quot;}}, &quot;required&quot;: [&quot;a&quot;, &quot;b&quot;]}</span>
<span class="c1"># Function name: add</span>
<span class="c1"># Function description: add(a: int, b: int) -&gt; int</span>
<span class="c1"># Add two numbers.</span>
<span class="c1"># Function parameter: {&quot;type&quot;: &quot;object&quot;, &quot;properties&quot;: {&quot;a&quot;: {&quot;type&quot;: &quot;int&quot;}, &quot;b&quot;: {&quot;type&quot;: &quot;int&quot;}}, &quot;required&quot;: [&quot;a&quot;, &quot;b&quot;]}</span>
</pre></div>
</div>
<p>The agent will then call these external functions based on the function descriptions.
In addition to user-defined tools, the <code class="xref py py-class docutils literal notranslate"><span class="pre">ReActAgent</span></code> built-in <code class="docutils literal notranslate"><span class="pre">llm_tool</span></code>
for leveraging LLM’s internal knowledge, and <code class="docutils literal notranslate"><span class="pre">finish</span></code> for completing processes. <code class="docutils literal notranslate"><span class="pre">llm_tool</span></code> uses the same model with the agent. Developers have the flexibility to enable or disable these as needed.</p>
<ol class="arabic simple" start="3">
<li><p><strong>Output Parser:</strong> <code class="docutils literal notranslate"><span class="pre">LightRAG</span></code> requests the model to output intermediate Thought and Action as JSON, which facilitates better error handling and easier data manipulation than strings. For example,</p></li>
</ol>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;thought&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;Why you are taking this action&gt;&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;action&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ToolName(&lt;args&gt;, &lt;kwargs&gt;)&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This format allows the <code class="docutils literal notranslate"><span class="pre">LightRAG</span></code> JSON parser to efficiently decode the model’s output and extract arguments.
The parsed data is then utilized by the <code class="docutils literal notranslate"><span class="pre">StepOutput</span></code> class to manage the flow of thought, action and observation.</p>
<ol class="arabic simple" start="4">
<li><p><strong>Example:</strong> Let’s see a Q&amp;A agent example:</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lightrag.core.tool_helper</span> <span class="kn">import</span> <span class="n">FunctionTool</span>
<span class="kn">from</span> <span class="nn">lightrag.components.agent.react</span> <span class="kn">import</span> <span class="n">ReActAgent</span>
<span class="kn">from</span> <span class="nn">lightrag.components.model_client</span> <span class="kn">import</span> <span class="n">OpenAIClient</span>
<span class="kn">from</span> <span class="nn">lightrag.components.model_client</span> <span class="kn">import</span> <span class="n">GroqAPIClient</span>

<span class="kn">import</span> <span class="nn">dotenv</span>
<span class="c1"># load evironment</span>
<span class="n">dotenv</span><span class="o">.</span><span class="n">load_dotenv</span><span class="p">(</span><span class="n">dotenv_path</span><span class="o">=</span><span class="s2">&quot;.env&quot;</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># define the tools</span>
<span class="k">def</span> <span class="nf">multiply</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Multiply two numbers.&#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Add two numbers.&#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>

<span class="n">tools</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">FunctionTool</span><span class="o">.</span><span class="n">from_defaults</span><span class="p">(</span><span class="n">fn</span><span class="o">=</span><span class="n">multiply</span><span class="p">),</span>
        <span class="n">FunctionTool</span><span class="o">.</span><span class="n">from_defaults</span><span class="p">(</span><span class="n">fn</span><span class="o">=</span><span class="n">add</span><span class="p">),</span>
    <span class="p">]</span>

<span class="c1"># for tool in tools:</span>
<span class="c1">#    name = tool.metadata.name</span>
<span class="c1">#    description = tool.metadata.description</span>
<span class="c1">#    parameter = tool.metadata.fn_schema_str</span>
<span class="c1">#    print(f&quot;Function name: {name}&quot;)</span>
<span class="c1">#    print(f&quot;Function description: {description}&quot;)</span>
<span class="c1">#    print(f&quot;Function parameter: {parameter}&quot;)</span>


<span class="n">examples</span> <span class="o">=</span> <span class="p">[</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        User: What is 9 - 3?</span>
<span class="sd">        You: {</span>
<span class="sd">            &quot;thought&quot;: &quot;I need to subtract 3 from 9, but there is no subtraction tool, so I ask llm_tool to answer the query.&quot;,</span>
<span class="sd">            &quot;action&quot;: &quot;llm_tool(&#39;What is 9 - 3?&#39;)&quot;</span>
<span class="sd">        }</span>
<span class="sd">        &quot;&quot;&quot;</span>
<span class="p">]</span>

<span class="n">preset_prompt_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;example&quot;</span><span class="p">:</span> <span class="n">examples</span><span class="p">}</span>
<span class="n">llm_model_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="s2">&quot;llama3-70b-8192&quot;</span><span class="p">,</span>
    <span class="s2">&quot;temperature&quot;</span><span class="p">:</span> <span class="mf">0.0</span>
<span class="p">}</span>

<span class="n">agent</span> <span class="o">=</span> <span class="n">ReActAgent</span><span class="p">(</span>
    <span class="n">tools</span><span class="o">=</span><span class="n">tools</span><span class="p">,</span>
    <span class="n">model_client</span><span class="o">=</span><span class="n">GroqAPIClient</span><span class="p">(),</span>
    <span class="n">model_kwargs</span><span class="o">=</span><span class="n">llm_model_kwargs</span><span class="p">,</span>
    <span class="n">max_steps</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">preset_prompt_kwargs</span><span class="o">=</span><span class="n">preset_prompt_kwargs</span>
    <span class="p">)</span>

<span class="kn">import</span> <span class="nn">time</span>
<span class="n">queries</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;What is 3 add 4?&quot;</span><span class="p">,</span> <span class="s2">&quot;3*9=?&quot;</span><span class="p">]</span>
<span class="n">average_time</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">query</span> <span class="ow">in</span> <span class="n">queries</span><span class="p">:</span>
    <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">answer</span> <span class="o">=</span> <span class="n">agent</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

<span class="c1"># Answer: The answer is 7.</span>
<span class="c1"># Answer: The answer is 27.</span>
</pre></div>
</div>
<p>5. <strong>Subquery and History:</strong> Moreover, in our design, the agent will potentially divide a query into subqueries, join all subqueries answers and finish the task. Developers can customize the prompt depending on the use cases.
The intermediate step history is managed. The agent will visit its previous reasoning, action and observations before making decisions.</p>
</section>
<section id="react-agent-deep-dive">
<span id="deep-dive"></span><h2>ReAct Agent Deep Dive<a class="headerlink" href="#react-agent-deep-dive" title="Link to this heading">#</a></h2>
<p>Please read this section if you need more information on ReAct agent.</p>
<p><a class="reference external" href="https://arxiv.org/pdf/2210.03629">ReAct Agent</a>, like its name(<code class="docutils literal notranslate"><span class="pre">Re</span></code>- Reason; <code class="docutils literal notranslate"><span class="pre">Act</span></code> - Act), is a framework generating reasoning and taking actions in an interleaved manner. The reasoning step guides the model to action plans and the action step allows the agent to interact with external sources such as knowledge bases.</p>
<p>The paper shows:
1. ReAct with few-shot prompt and Wikipedia API interaction outperforms chain-of-thought on <a class="reference external" href="https://arxiv.org/pdf/1809.09600">HotpotQA</a> (Question and Answering) and <a class="reference external" href="https://arxiv.org/pdf/1803.05355v3">Fever</a> (Fact Verification).
2. ReAct performs well on two interactive decision making benchmarks.</p>
<p><strong>1. Overall Workflow</strong></p>
<p>Unlike the reasoning only and acting only approaches, given a query, the ReAct agent will go through a sequence of steps to solve the problem. (<a class="reference external" href="https://react-lm.github.io/">Source</a>)</p>
<p>Here is an example from the paper that demonstrates the workflow.</p>
<img alt="../_images/ReAct.jpg" src="../_images/ReAct.jpg" />
<p>The environment contains user query, step histories, observations, and external sources.</p>
<p>At each step, the agent:</p>
<ul class="simple">
<li><p><strong>[Thought]</strong> In response to the environment and user query, the agent uses its LLM to generate a strategic thought that outlines a plan or hypothesis guiding the subsequent action.</p></li>
<li><p><strong>[Action]</strong> The agent executes the action.</p></li>
</ul>
<p>The environment will be updated:</p>
<ul class="simple">
<li><p><strong>[Observation]</strong> The observation is created after the action is done.</p></li>
</ul>
<p>Then the agent iteratively generates thoughts based on latest observation and context(previous steps), takes actions and gets new observations.</p>
<p>The termination condition is:</p>
<ul class="simple">
<li><p>The agent finds the answer and takes “finish” action.</p></li>
<li><p>The agent fails to get the answer when the defined max steps is reached. Return nothing.</p></li>
</ul>
<p><strong>2. Action Space</strong></p>
<p>Now we understand the 3 different stages: Thought, Action, Observation. Let’s focus on Action, one of agents’ uniqueness.</p>
<p>Actions refer to the tools the agent uses to interact with the environment and creates observations.
Note: the paper defines Thought(or reasoning trace) as a <em>language level action</em> but it is not included in the action space because it doesn’t impact the environment.</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">HotpotQA</span></code> dataset as an example, what external source do we need to answer questions?</p>
<p><a class="reference external" href="https://arxiv.org/pdf/1809.09600">HotpotQA</a> contains Wikipedia-based questions that require multi-hop reasoning. Therefore, the agent will need to query the Wikipedia API.</p>
<p>In the <a class="reference external" href="https://arxiv.org/pdf/2210.03629">ReAct paper</a>, researchers include 3 actions in the “action space” (simplified version here):</p>
<ul class="simple">
<li><p>search[entity], returns the first 5 sentences from the corresponding entity wiki page if it exists, or else suggests top-5 similar entities.</p></li>
<li><p>lookup[string], simulating Ctrl+F functionality on the browser.</p></li>
<li><p>finish[answer], which would finish the current task with answer.</p></li>
</ul>
<p><strong>3. Components</strong></p>
<p>With the workflow and action space, next, let’s focus on the components needed to implement the agent.</p>
<ul class="simple">
<li><p><strong>prompt:</strong> Besides the role and task-specific description, the key in ReAct prompting is to define the tools to use in the prompt.</p></li>
<li><p><strong>function call:</strong> In the implementation, each action is essentially a function to call. Clear functionality definition is important for the agent to determine which action to take next.</p></li>
<li><p><strong>parser:</strong> The agent is built on LLMs. It takes in the prompt with context, generates thought and determine the action to take in text response.</p></li>
</ul>
<p>To really call functions, we need to parse the text response to get the parameters for the determined function.</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-an-agent-and-why-you-need-it">What is an agent and why you need it?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lightrag-s-implementation">LightRAG’s Implementation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#react-agent-deep-dive">ReAct Agent Deep Dive</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, SylphAI, Inc.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>